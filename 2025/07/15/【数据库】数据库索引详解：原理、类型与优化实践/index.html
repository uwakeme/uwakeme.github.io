

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">

  <link rel="apple-touch-icon" sizes="76x76" href="/img/fluid.png">
  <link rel="icon" href="https://cdn.jsdelivr.net/gh/uwakeme/cdn@main/img/favicon.png">
  

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
    <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="Wake">
  <meta name="keywords" content="技术博客, Web开发, 后端开发, Java, Python, 人工智能, 编程学习, 技术分享">
  
    <meta name="description" content="前言索引是数据库系统中最重要的性能优化工具之一，它就像书籍的目录一样，能够帮助我们快速定位到所需的数据。在现代数据库应用中，合理的索引设计往往能够将查询性能提升几个数量级。然而，索引并非万能的，不当的索引使用反而可能降低系统性能。本文将深入探讨数据库索引的原理、类型、创建方法以及优化策略，帮助读者全面掌握索引技术。 一、索引基础概念（一）什么是索引索引（Index）是数据库管理系统中一种数据结构，">
<meta property="og:type" content="article">
<meta property="og:title" content="【数据库】数据库索引详解：原理、类型与优化实践">
<meta property="og:url" content="https://uwakeme.top/2025/07/15/%E3%80%90%E6%95%B0%E6%8D%AE%E5%BA%93%E3%80%91%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B4%A2%E5%BC%95%E8%AF%A6%E8%A7%A3%EF%BC%9A%E5%8E%9F%E7%90%86%E3%80%81%E7%B1%BB%E5%9E%8B%E4%B8%8E%E4%BC%98%E5%8C%96%E5%AE%9E%E8%B7%B5/index.html">
<meta property="og:site_name" content="Uwakeme">
<meta property="og:description" content="前言索引是数据库系统中最重要的性能优化工具之一，它就像书籍的目录一样，能够帮助我们快速定位到所需的数据。在现代数据库应用中，合理的索引设计往往能够将查询性能提升几个数量级。然而，索引并非万能的，不当的索引使用反而可能降低系统性能。本文将深入探讨数据库索引的原理、类型、创建方法以及优化策略，帮助读者全面掌握索引技术。 一、索引基础概念（一）什么是索引索引（Index）是数据库管理系统中一种数据结构，">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2025-07-15T02:03:44.233Z">
<meta property="article:modified_time" content="2025-07-17T08:29:05.499Z">
<meta property="article:author" content="Wake">
<meta property="article:tag" content="数据库">
<meta property="article:tag" content="MySQL">
<meta property="article:tag" content="性能优化">
<meta property="article:tag" content="索引">
<meta property="article:tag" content="SQL">
<meta name="twitter:card" content="summary_large_image">
  
  
    <meta name="referrer" content="no-referrer-when-downgrade">
  
  
  <title>【数据库】数据库索引详解：原理、类型与优化实践 - Uwakeme</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/prism/1.29.0/plugins/line-numbers/prism-line-numbers.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1749284_5i9bdhy70f8.css">



<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1736178_k526ubmyhba.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  



  
<link rel="stylesheet" href="//at.alicdn.com/t/c/font_3846514_kabxni94auf.css">
<link rel="stylesheet" href="/css/custom.css">
<link rel="stylesheet" href="/css/ai-assistant.css">



  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"uwakeme.top","root":"/","version":"1.9.8","typing":{"enable":true,"typeSpeed":70,"cursorChar":"|","loop":false,"scope":[],"backSpeed":40,"showCursor":true},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"right","visible":"hover","icon":"#"},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100},"position_indicator":{"enable":true,"color":"#33a3dc"}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""],"img_max_width":"80%","img_max_height":"80%"},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0,"level":3,"collapse":false,"follow":true,"number":true,"heading_list":true,"expand_all":true},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2,"element_loading_img":true},"web_analytics":{"enable":true,"follow_dnt":true,"baidu":"41fc030db57d5570dd22f78997dc4a7e","google":{"measurement_id":null},"tencent":{"sid":null,"cid":null},"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false},"umami":{"src":null,"website_id":null,"domains":null,"start_time":"2024-01-01T00:00:00.000Z","token":null,"api_server":null},"busuanzi":{"enable":true,"script_url":"//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js","site_uv":true,"site_pv":true,"page_pv":true}},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  

  
    <!-- Baidu Analytics -->
    <script async>
      if (!Fluid.ctx.dnt) {
        var _hmt = _hmt || [];
        (function() {
          var hm = document.createElement("script");
          hm.src = "https://hm.baidu.com/hm.js?41fc030db57d5570dd22f78997dc4a7e";
          var s = document.getElementsByTagName("script")[0];
          s.parentNode.insertBefore(hm, s);
        })();
      }
    </script>
  

  

  

  

  



  
<meta name="generator" content="Hexo 7.3.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>Wake 的博客</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/" target="_self">
                <i class="iconfont icon-home-fill"></i>
                <span>首页</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives" target="_self">
                <i class="iconfont icon-books"></i>
                <span>归档</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories" target="_self">
                <i class="iconfont icon-th-large"></i>
                <span>分类</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/" target="_self">
                <i class="iconfont icon-tags-fill"></i>
                <span>标签</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/" target="_self">
                <i class="iconfont icon-user-fill"></i>
                <span>关于</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/links/" target="_self">
                <i class="iconfont icon-link-fill"></i>
                <span>友链</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" target="_self" href="javascript:;" role="button"
                 data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                <i class="iconfont icon-book"></i>
                <span>文档</span>
              </a>
              <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                
                  
                  
                  
                  <a class="dropdown-item" href="https://hexo.fluid-dev.com/" target="_self">
                    
                    <span>主题博客</span>
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="https://hexo.fluid-dev.com/docs/guide/" target="_self">
                    
                    <span>配置指南</span>
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="https://hexo.fluid-dev.com/docs/icon/" target="_self">
                    
                    <span>图标用法</span>
                  </a>
                
              </div>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/default.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="【数据库】数据库索引详解：原理、类型与优化实践"></span>
          
        </div>

        
          
  <div class="mt-3">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-author" aria-hidden="true"></i>
        Wake
      </span>
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2025-07-15 10:03" pubdate>
          2025-07-15 10:03
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          <!-- compatible with older versions-->
          5.1k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          <!-- compatible with older versions-->
          43 分钟
        
      </span>
    

    
    
      
        <span id="busuanzi_container_page_pv" style="display: none">
          <i class="iconfont icon-eye" aria-hidden="true"></i>
          <span id="busuanzi_value_page_pv"></span> 次
        </span>
        

      
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">【数据库】数据库索引详解：原理、类型与优化实践</h1>
            
            
              <div class="markdown-body">
                
                <h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>索引是数据库系统中最重要的性能优化工具之一，它就像书籍的目录一样，能够帮助我们快速定位到所需的数据。在现代数据库应用中，合理的索引设计往往能够将查询性能提升几个数量级。然而，索引并非万能的，不当的索引使用反而可能降低系统性能。本文将深入探讨数据库索引的原理、类型、创建方法以及优化策略，帮助读者全面掌握索引技术。</p>
<h1 id="一、索引基础概念"><a href="#一、索引基础概念" class="headerlink" title="一、索引基础概念"></a>一、索引基础概念</h1><h2 id="（一）什么是索引"><a href="#（一）什么是索引" class="headerlink" title="（一）什么是索引"></a>（一）什么是索引</h2><p>索引（Index）是数据库管理系统中一种数据结构，它提供了快速访问数据表中数据的路径。索引是对数据库表中一列或多列的值进行排序的一种结构，使用索引可快速访问数据库表中的特定信息。</p>
<h3 id="1-索引的作用"><a href="#1-索引的作用" class="headerlink" title="1. 索引的作用"></a>1. 索引的作用</h3><ul>
<li><strong>提高查询速度</strong>：通过索引可以快速定位数据，避免全表扫描</li>
<li><strong>加速排序和分组</strong>：ORDER BY和GROUP BY操作可以利用索引的有序性</li>
<li><strong>加速表连接</strong>：JOIN操作中的关联字段如果有索引，可以显著提高连接效率</li>
<li><strong>保证数据唯一性</strong>：唯一索引可以确保数据的唯一性约束</li>
</ul>
<h3 id="2-索引的代价"><a href="#2-索引的代价" class="headerlink" title="2. 索引的代价"></a>2. 索引的代价</h3><ul>
<li><strong>存储空间开销</strong>：索引需要额外的存储空间</li>
<li><strong>维护成本</strong>：INSERT、UPDATE、DELETE操作需要同时维护索引</li>
<li><strong>内存消耗</strong>：索引数据需要加载到内存中</li>
</ul>
<h2 id="（二）索引的工作原理"><a href="#（二）索引的工作原理" class="headerlink" title="（二）索引的工作原理"></a>（二）索引的工作原理</h2><h3 id="1-无索引的查询过程"><a href="#1-无索引的查询过程" class="headerlink" title="1. 无索引的查询过程"></a>1. 无索引的查询过程</h3><figure><div class="code-wrapper"><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">-- 假设有一个用户表，包含100万条记录</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> users <span class="token keyword">WHERE</span> age <span class="token operator">=</span> <span class="token number">25</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></div></figure>

<p>没有索引时，数据库需要进行全表扫描：</p>
<ol>
<li>从第一条记录开始</li>
<li>逐行检查age字段是否等于25</li>
<li>直到扫描完所有记录</li>
<li>时间复杂度：O(n)</li>
</ol>
<h3 id="2-有索引的查询过程"><a href="#2-有索引的查询过程" class="headerlink" title="2. 有索引的查询过程"></a>2. 有索引的查询过程</h3><figure><div class="code-wrapper"><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">-- 在age字段上创建索引后</span>
<span class="token keyword">CREATE</span> <span class="token keyword">INDEX</span> idx_age <span class="token keyword">ON</span> users<span class="token punctuation">(</span>age<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> users <span class="token keyword">WHERE</span> age <span class="token operator">=</span> <span class="token number">25</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></div></figure>

<p>有索引时，查询过程：</p>
<ol>
<li>在索引中快速定位age&#x3D;25的位置</li>
<li>通过索引获取对应的行指针</li>
<li>直接访问数据页获取完整记录</li>
<li>时间复杂度：O(log n)</li>
</ol>
<h3 id="3-索引结构示意"><a href="#3-索引结构示意" class="headerlink" title="3. 索引结构示意"></a>3. 索引结构示意</h3><figure><div class="code-wrapper"><pre class="line-numbers language-none"><code class="language-none">索引页（按age排序）        数据页
┌─────────────────┐      ┌─────────────────┐
│ age&#x3D;18 → 行指针1 │ ──→  │ 完整用户记录1    │
│ age&#x3D;22 → 行指针2 │ ──→  │ 完整用户记录2    │
│ age&#x3D;25 → 行指针3 │ ──→  │ 完整用户记录3    │
│ age&#x3D;28 → 行指针4 │ ──→  │ 完整用户记录4    │
└─────────────────┘      └─────────────────┘<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h1 id="二、索引的数据结构"><a href="#二、索引的数据结构" class="headerlink" title="二、索引的数据结构"></a>二、索引的数据结构</h1><h2 id="（一）B-树索引"><a href="#（一）B-树索引" class="headerlink" title="（一）B+树索引"></a>（一）B+树索引</h2><h3 id="1-B-树的特点"><a href="#1-B-树的特点" class="headerlink" title="1. B+树的特点"></a>1. B+树的特点</h3><p>B+树是数据库索引最常用的数据结构，具有以下特点：</p>
<ul>
<li><strong>平衡树</strong>：所有叶子节点都在同一层</li>
<li><strong>有序性</strong>：节点内的键值有序排列</li>
<li><strong>范围查询友好</strong>：叶子节点通过指针连接，支持高效的范围查询</li>
<li><strong>高扇出</strong>：每个节点可以存储多个键值，减少树的高度</li>
</ul>
<h3 id="2-B-树结构示例"><a href="#2-B-树结构示例" class="headerlink" title="2. B+树结构示例"></a>2. B+树结构示例</h3><figure><div class="code-wrapper"><pre class="line-numbers language-none"><code class="language-none">                根节点
               [10, 20]
              &#x2F;    |    \
           &#x2F;      |      \
      [5, 8]   [12, 15]  [25, 30]
     &#x2F;  |  \   &#x2F;  |  \   &#x2F;  |  \
  [1,3] [6,7] [9] [11] [13,14] [16,18] [21,23] [26,28] [31,35]
   ↓     ↓     ↓    ↓     ↓      ↓      ↓      ↓      ↓
数据页 数据页 数据页 数据页 数据页  数据页  数据页  数据页  数据页<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h3 id="3-B-树的优势"><a href="#3-B-树的优势" class="headerlink" title="3. B+树的优势"></a>3. B+树的优势</h3><figure><div class="code-wrapper"><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">-- 范围查询示例</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> users <span class="token keyword">WHERE</span> age <span class="token operator">BETWEEN</span> <span class="token number">20</span> <span class="token operator">AND</span> <span class="token number">30</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></div></figure>

<p>在B+树中执行范围查询：</p>
<ol>
<li>定位到age&#x3D;20的叶子节点</li>
<li>沿着叶子节点的链表顺序扫描</li>
<li>直到age&gt;30停止</li>
<li>效率远高于全表扫描</li>
</ol>
<h2 id="（二）哈希索引"><a href="#（二）哈希索引" class="headerlink" title="（二）哈希索引"></a>（二）哈希索引</h2><h3 id="1-哈希索引特点"><a href="#1-哈希索引特点" class="headerlink" title="1. 哈希索引特点"></a>1. 哈希索引特点</h3><ul>
<li><strong>等值查询极快</strong>：O(1)时间复杂度</li>
<li><strong>不支持范围查询</strong>：无法进行BETWEEN、&gt;、&lt;等操作</li>
<li><strong>不支持排序</strong>：哈希值是无序的</li>
<li><strong>不支持模糊查询</strong>：无法使用LIKE操作</li>
</ul>
<h3 id="2-哈希索引适用场景"><a href="#2-哈希索引适用场景" class="headerlink" title="2. 哈希索引适用场景"></a>2. 哈希索引适用场景</h3><figure><div class="code-wrapper"><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">-- 适合哈希索引的查询</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> users <span class="token keyword">WHERE</span> user_id <span class="token operator">=</span> <span class="token number">12345</span><span class="token punctuation">;</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> products <span class="token keyword">WHERE</span> product_code <span class="token operator">=</span> <span class="token string">'ABC123'</span><span class="token punctuation">;</span>

<span class="token comment">-- 不适合哈希索引的查询</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> users <span class="token keyword">WHERE</span> age <span class="token operator">></span> <span class="token number">25</span><span class="token punctuation">;</span>           <span class="token comment">-- 范围查询</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> users <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> age<span class="token punctuation">;</span>            <span class="token comment">-- 排序</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> users <span class="token keyword">WHERE</span> name <span class="token operator">LIKE</span> <span class="token string">'John%'</span><span class="token punctuation">;</span> <span class="token comment">-- 模糊查询</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h2 id="（三）位图索引"><a href="#（三）位图索引" class="headerlink" title="（三）位图索引"></a>（三）位图索引</h2><h3 id="1-位图索引原理"><a href="#1-位图索引原理" class="headerlink" title="1. 位图索引原理"></a>1. 位图索引原理</h3><p>位图索引使用位图（bitmap）来表示数据的存在性，特别适合低基数（distinct values较少）的列。</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-none"><code class="language-none">性别字段的位图索引：
行号    性别    男性位图    女性位图
1       男      1          0
2       女      0          1
3       男      1          0
4       女      0          1
5       男      1          0<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h3 id="2-位图索引优势"><a href="#2-位图索引优势" class="headerlink" title="2. 位图索引优势"></a>2. 位图索引优势</h3><ul>
<li><strong>空间效率高</strong>：对于低基数列，存储空间很小</li>
<li><strong>逻辑运算快</strong>：支持高效的AND、OR、NOT操作</li>
<li><strong>统计查询优化</strong>：COUNT等聚合操作非常快</li>
</ul>
<figure><div class="code-wrapper"><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">-- 位图索引擅长的查询</span>
<span class="token keyword">SELECT</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">FROM</span> employees <span class="token keyword">WHERE</span> gender <span class="token operator">=</span> <span class="token string">'男'</span> <span class="token operator">AND</span> department <span class="token operator">=</span> <span class="token string">'IT'</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></div></figure>

<h1 id="三、索引的类型分类"><a href="#三、索引的类型分类" class="headerlink" title="三、索引的类型分类"></a>三、索引的类型分类</h1><h2 id="（一）按数据结构分类"><a href="#（一）按数据结构分类" class="headerlink" title="（一）按数据结构分类"></a>（一）按数据结构分类</h2><h3 id="1-B-树索引（最常用）"><a href="#1-B-树索引（最常用）" class="headerlink" title="1. B+树索引（最常用）"></a>1. B+树索引（最常用）</h3><figure><div class="code-wrapper"><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">-- 创建B+树索引（默认类型）</span>
<span class="token keyword">CREATE</span> <span class="token keyword">INDEX</span> idx_user_age <span class="token keyword">ON</span> users<span class="token punctuation">(</span>age<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">CREATE</span> <span class="token keyword">INDEX</span> idx_user_name <span class="token keyword">ON</span> users<span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></div></figure>

<h3 id="2-哈希索引"><a href="#2-哈希索引" class="headerlink" title="2. 哈希索引"></a>2. 哈希索引</h3><figure><div class="code-wrapper"><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">-- MySQL中创建哈希索引（MEMORY引擎）</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> temp_users <span class="token punctuation">(</span>
    id <span class="token keyword">INT</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span><span class="token punctuation">,</span>
    user_code <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword">INDEX</span> <span class="token keyword">USING</span> <span class="token keyword">HASH</span> <span class="token punctuation">(</span>user_code<span class="token punctuation">)</span>
<span class="token punctuation">)</span> <span class="token keyword">ENGINE</span><span class="token operator">=</span>MEMORY<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h3 id="3-全文索引"><a href="#3-全文索引" class="headerlink" title="3. 全文索引"></a>3. 全文索引</h3><figure><div class="code-wrapper"><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">-- 创建全文索引</span>
<span class="token keyword">CREATE</span> FULLTEXT <span class="token keyword">INDEX</span> idx_content <span class="token keyword">ON</span> articles<span class="token punctuation">(</span>title<span class="token punctuation">,</span> content<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 使用全文索引查询</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> articles 
<span class="token keyword">WHERE</span> <span class="token keyword">MATCH</span><span class="token punctuation">(</span>title<span class="token punctuation">,</span> content<span class="token punctuation">)</span> AGAINST<span class="token punctuation">(</span><span class="token string">'数据库 索引'</span> <span class="token operator">IN</span> <span class="token keyword">NATURAL</span> <span class="token keyword">LANGUAGE</span> <span class="token keyword">MODE</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h2 id="（二）按字段数量分类"><a href="#（二）按字段数量分类" class="headerlink" title="（二）按字段数量分类"></a>（二）按字段数量分类</h2><h3 id="1-单列索引"><a href="#1-单列索引" class="headerlink" title="1. 单列索引"></a>1. 单列索引</h3><figure><div class="code-wrapper"><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">-- 单列索引示例</span>
<span class="token keyword">CREATE</span> <span class="token keyword">INDEX</span> idx_user_email <span class="token keyword">ON</span> users<span class="token punctuation">(</span>email<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">CREATE</span> <span class="token keyword">INDEX</span> idx_order_date <span class="token keyword">ON</span> orders<span class="token punctuation">(</span>order_date<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">CREATE</span> <span class="token keyword">INDEX</span> idx_product_price <span class="token keyword">ON</span> products<span class="token punctuation">(</span>price<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h3 id="2-复合索引（多列索引）"><a href="#2-复合索引（多列索引）" class="headerlink" title="2. 复合索引（多列索引）"></a>2. 复合索引（多列索引）</h3><figure><div class="code-wrapper"><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">-- 复合索引示例</span>
<span class="token keyword">CREATE</span> <span class="token keyword">INDEX</span> idx_user_age_city <span class="token keyword">ON</span> users<span class="token punctuation">(</span>age<span class="token punctuation">,</span> city<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">CREATE</span> <span class="token keyword">INDEX</span> idx_order_user_date <span class="token keyword">ON</span> orders<span class="token punctuation">(</span>user_id<span class="token punctuation">,</span> order_date<span class="token punctuation">,</span> <span class="token keyword">status</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></div></figure>

<h4 id="复合索引的最左前缀原则"><a href="#复合索引的最左前缀原则" class="headerlink" title="复合索引的最左前缀原则"></a>复合索引的最左前缀原则</h4><figure><div class="code-wrapper"><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">-- 假设有复合索引：idx_abc(a, b, c)</span>

<span class="token comment">-- 可以使用索引的查询</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> <span class="token keyword">table</span> <span class="token keyword">WHERE</span> a <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>                    <span class="token comment">-- 使用索引</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> <span class="token keyword">table</span> <span class="token keyword">WHERE</span> a <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">AND</span> b <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>         <span class="token comment">-- 使用索引</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> <span class="token keyword">table</span> <span class="token keyword">WHERE</span> a <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">AND</span> b <span class="token operator">=</span> <span class="token number">2</span> <span class="token operator">AND</span> c <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span> <span class="token comment">-- 使用索引</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> <span class="token keyword">table</span> <span class="token keyword">WHERE</span> a <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">AND</span> c <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>         <span class="token comment">-- 部分使用索引（只用a）</span>

<span class="token comment">-- 无法使用索引的查询</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> <span class="token keyword">table</span> <span class="token keyword">WHERE</span> b <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>                    <span class="token comment">-- 不使用索引</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> <span class="token keyword">table</span> <span class="token keyword">WHERE</span> c <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>                    <span class="token comment">-- 不使用索引</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> <span class="token keyword">table</span> <span class="token keyword">WHERE</span> b <span class="token operator">=</span> <span class="token number">2</span> <span class="token operator">AND</span> c <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>         <span class="token comment">-- 不使用索引</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h2 id="（三）按功能特性分类"><a href="#（三）按功能特性分类" class="headerlink" title="（三）按功能特性分类"></a>（三）按功能特性分类</h2><h3 id="1-普通索引"><a href="#1-普通索引" class="headerlink" title="1. 普通索引"></a>1. 普通索引</h3><figure><div class="code-wrapper"><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">-- 普通索引：没有任何限制</span>
<span class="token keyword">CREATE</span> <span class="token keyword">INDEX</span> idx_user_name <span class="token keyword">ON</span> users<span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></div></figure>

<h3 id="2-唯一索引"><a href="#2-唯一索引" class="headerlink" title="2. 唯一索引"></a>2. 唯一索引</h3><figure><div class="code-wrapper"><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">-- 唯一索引：保证列值的唯一性</span>
<span class="token keyword">CREATE</span> <span class="token keyword">UNIQUE</span> <span class="token keyword">INDEX</span> idx_user_email <span class="token keyword">ON</span> users<span class="token punctuation">(</span>email<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">CREATE</span> <span class="token keyword">UNIQUE</span> <span class="token keyword">INDEX</span> idx_user_phone <span class="token keyword">ON</span> users<span class="token punctuation">(</span>phone<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></div></figure>

<h3 id="3-主键索引"><a href="#3-主键索引" class="headerlink" title="3. 主键索引"></a>3. 主键索引</h3><figure><div class="code-wrapper"><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">-- 主键索引：自动创建，唯一且非空</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> users <span class="token punctuation">(</span>
    id <span class="token keyword">INT</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token punctuation">,</span>
    name <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    email <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h3 id="4-外键索引"><a href="#4-外键索引" class="headerlink" title="4. 外键索引"></a>4. 外键索引</h3><figure><div class="code-wrapper"><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">-- 外键索引：维护引用完整性</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> orders <span class="token punctuation">(</span>
    id <span class="token keyword">INT</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span><span class="token punctuation">,</span>
    user_id <span class="token keyword">INT</span><span class="token punctuation">,</span>
    order_date <span class="token keyword">DATE</span><span class="token punctuation">,</span>
    <span class="token keyword">FOREIGN</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span>user_id<span class="token punctuation">)</span> <span class="token keyword">REFERENCES</span> users<span class="token punctuation">(</span>id<span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h2 id="（四）按存储方式分类"><a href="#（四）按存储方式分类" class="headerlink" title="（四）按存储方式分类"></a>（四）按存储方式分类</h2><h3 id="1-聚簇索引（Clustered-Index）"><a href="#1-聚簇索引（Clustered-Index）" class="headerlink" title="1. 聚簇索引（Clustered Index）"></a>1. 聚簇索引（Clustered Index）</h3><ul>
<li><strong>数据和索引存储在一起</strong></li>
<li><strong>表数据按索引键值物理排序</strong></li>
<li><strong>一个表只能有一个聚簇索引</strong></li>
<li><strong>通常是主键索引</strong></li>
</ul>
<figure><div class="code-wrapper"><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">-- InnoDB中，主键就是聚簇索引</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> users <span class="token punctuation">(</span>
    id <span class="token keyword">INT</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span><span class="token punctuation">,</span>      <span class="token comment">-- 聚簇索引</span>
    name <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    age <span class="token keyword">INT</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h3 id="2-非聚簇索引（Non-Clustered-Index）"><a href="#2-非聚簇索引（Non-Clustered-Index）" class="headerlink" title="2. 非聚簇索引（Non-Clustered Index）"></a>2. 非聚簇索引（Non-Clustered Index）</h3><ul>
<li><strong>索引和数据分开存储</strong></li>
<li><strong>索引指向数据行的物理位置</strong></li>
<li><strong>一个表可以有多个非聚簇索引</strong></li>
</ul>
<figure><div class="code-wrapper"><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">-- 普通索引都是非聚簇索引</span>
<span class="token keyword">CREATE</span> <span class="token keyword">INDEX</span> idx_user_name <span class="token keyword">ON</span> users<span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">-- 非聚簇索引</span>
<span class="token keyword">CREATE</span> <span class="token keyword">INDEX</span> idx_user_age <span class="token keyword">ON</span> users<span class="token punctuation">(</span>age<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">-- 非聚簇索引</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></div></figure>

<h1 id="四、索引的创建与管理"><a href="#四、索引的创建与管理" class="headerlink" title="四、索引的创建与管理"></a>四、索引的创建与管理</h1><h2 id="（一）创建索引的语法"><a href="#（一）创建索引的语法" class="headerlink" title="（一）创建索引的语法"></a>（一）创建索引的语法</h2><h3 id="1-基本创建语法"><a href="#1-基本创建语法" class="headerlink" title="1. 基本创建语法"></a>1. 基本创建语法</h3><figure><div class="code-wrapper"><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">-- 基本语法</span>
<span class="token keyword">CREATE</span> <span class="token punctuation">[</span><span class="token keyword">UNIQUE</span><span class="token punctuation">]</span> <span class="token keyword">INDEX</span> index_name <span class="token keyword">ON</span> table_name<span class="token punctuation">(</span>column_name<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 创建普通索引</span>
<span class="token keyword">CREATE</span> <span class="token keyword">INDEX</span> idx_user_age <span class="token keyword">ON</span> users<span class="token punctuation">(</span>age<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 创建唯一索引</span>
<span class="token keyword">CREATE</span> <span class="token keyword">UNIQUE</span> <span class="token keyword">INDEX</span> idx_user_email <span class="token keyword">ON</span> users<span class="token punctuation">(</span>email<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 创建复合索引</span>
<span class="token keyword">CREATE</span> <span class="token keyword">INDEX</span> idx_user_age_city <span class="token keyword">ON</span> users<span class="token punctuation">(</span>age<span class="token punctuation">,</span> city<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h3 id="2-在表创建时定义索引"><a href="#2-在表创建时定义索引" class="headerlink" title="2. 在表创建时定义索引"></a>2. 在表创建时定义索引</h3><figure><div class="code-wrapper"><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> users <span class="token punctuation">(</span>
    id <span class="token keyword">INT</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token punctuation">,</span>
    name <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    email <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    age <span class="token keyword">INT</span><span class="token punctuation">,</span>
    city <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    created_at <span class="token keyword">TIMESTAMP</span> <span class="token keyword">DEFAULT</span> <span class="token keyword">CURRENT_TIMESTAMP</span><span class="token punctuation">,</span>
    
    <span class="token comment">-- 创建索引</span>
    <span class="token keyword">INDEX</span> idx_name <span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword">UNIQUE</span> <span class="token keyword">INDEX</span> idx_email <span class="token punctuation">(</span>email<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword">INDEX</span> idx_age_city <span class="token punctuation">(</span>age<span class="token punctuation">,</span> city<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword">INDEX</span> idx_created_at <span class="token punctuation">(</span>created_at<span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h3 id="3-使用ALTER-TABLE添加索引"><a href="#3-使用ALTER-TABLE添加索引" class="headerlink" title="3. 使用ALTER TABLE添加索引"></a>3. 使用ALTER TABLE添加索引</h3><figure><div class="code-wrapper"><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">-- 添加普通索引</span>
<span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> users <span class="token keyword">ADD</span> <span class="token keyword">INDEX</span> idx_phone <span class="token punctuation">(</span>phone<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 添加唯一索引</span>
<span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> users <span class="token keyword">ADD</span> <span class="token keyword">UNIQUE</span> <span class="token keyword">INDEX</span> idx_id_card <span class="token punctuation">(</span>id_card<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 添加复合索引</span>
<span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> users <span class="token keyword">ADD</span> <span class="token keyword">INDEX</span> idx_status_date <span class="token punctuation">(</span><span class="token keyword">status</span><span class="token punctuation">,</span> created_at<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h2 id="（二）删除索引"><a href="#（二）删除索引" class="headerlink" title="（二）删除索引"></a>（二）删除索引</h2><h3 id="1-删除索引的语法"><a href="#1-删除索引的语法" class="headerlink" title="1. 删除索引的语法"></a>1. 删除索引的语法</h3><figure><div class="code-wrapper"><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">-- 删除索引</span>
<span class="token keyword">DROP</span> <span class="token keyword">INDEX</span> index_name <span class="token keyword">ON</span> table_name<span class="token punctuation">;</span>

<span class="token comment">-- 示例</span>
<span class="token keyword">DROP</span> <span class="token keyword">INDEX</span> idx_user_age <span class="token keyword">ON</span> users<span class="token punctuation">;</span>
<span class="token keyword">DROP</span> <span class="token keyword">INDEX</span> idx_user_email <span class="token keyword">ON</span> users<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h3 id="2-使用ALTER-TABLE删除索引"><a href="#2-使用ALTER-TABLE删除索引" class="headerlink" title="2. 使用ALTER TABLE删除索引"></a>2. 使用ALTER TABLE删除索引</h3><figure><div class="code-wrapper"><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">-- 使用ALTER TABLE删除索引</span>
<span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> users <span class="token keyword">DROP</span> <span class="token keyword">INDEX</span> idx_user_age<span class="token punctuation">;</span>
<span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> users <span class="token keyword">DROP</span> <span class="token keyword">INDEX</span> idx_user_email<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></div></figure>

<h2 id="（三）查看索引信息"><a href="#（三）查看索引信息" class="headerlink" title="（三）查看索引信息"></a>（三）查看索引信息</h2><h3 id="1-查看表的索引"><a href="#1-查看表的索引" class="headerlink" title="1. 查看表的索引"></a>1. 查看表的索引</h3><figure><div class="code-wrapper"><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">-- 查看表的所有索引</span>
<span class="token keyword">SHOW</span> <span class="token keyword">INDEX</span> <span class="token keyword">FROM</span> users<span class="token punctuation">;</span>

<span class="token comment">-- 查看索引详细信息</span>
<span class="token keyword">SHOW</span> <span class="token keyword">INDEX</span> <span class="token keyword">FROM</span> users\G

<span class="token comment">-- 查看表结构（包含索引）</span>
<span class="token keyword">DESC</span> users<span class="token punctuation">;</span>
<span class="token keyword">SHOW</span> <span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> users<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h3 id="2-查看索引使用情况"><a href="#2-查看索引使用情况" class="headerlink" title="2. 查看索引使用情况"></a>2. 查看索引使用情况</h3><figure><div class="code-wrapper"><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">-- 查看索引统计信息</span>
<span class="token keyword">SELECT</span> 
    TABLE_SCHEMA<span class="token punctuation">,</span>
    TABLE_NAME<span class="token punctuation">,</span>
    INDEX_NAME<span class="token punctuation">,</span>
    COLUMN_NAME<span class="token punctuation">,</span>
    CARDINALITY<span class="token punctuation">,</span>
    INDEX_TYPE
<span class="token keyword">FROM</span> information_schema<span class="token punctuation">.</span><span class="token keyword">STATISTICS</span> 
<span class="token keyword">WHERE</span> TABLE_SCHEMA <span class="token operator">=</span> <span class="token string">'your_database'</span> 
<span class="token operator">AND</span> TABLE_NAME <span class="token operator">=</span> <span class="token string">'users'</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h3 id="3-分析查询是否使用索引"><a href="#3-分析查询是否使用索引" class="headerlink" title="3. 分析查询是否使用索引"></a>3. 分析查询是否使用索引</h3><figure><div class="code-wrapper"><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">-- 使用EXPLAIN分析查询计划</span>
<span class="token keyword">EXPLAIN</span> <span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> users <span class="token keyword">WHERE</span> age <span class="token operator">=</span> <span class="token number">25</span><span class="token punctuation">;</span>
<span class="token keyword">EXPLAIN</span> <span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> users <span class="token keyword">WHERE</span> age <span class="token operator">></span> <span class="token number">20</span> <span class="token operator">AND</span> city <span class="token operator">=</span> <span class="token string">'Beijing'</span><span class="token punctuation">;</span>

<span class="token comment">-- 详细的执行计划</span>
<span class="token keyword">EXPLAIN</span> FORMAT<span class="token operator">=</span>JSON <span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> users <span class="token keyword">WHERE</span> age <span class="token operator">=</span> <span class="token number">25</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h1 id="五、索引优化策略"><a href="#五、索引优化策略" class="headerlink" title="五、索引优化策略"></a>五、索引优化策略</h1><h2 id="（一）索引设计原则"><a href="#（一）索引设计原则" class="headerlink" title="（一）索引设计原则"></a>（一）索引设计原则</h2><h3 id="1-选择合适的列创建索引"><a href="#1-选择合适的列创建索引" class="headerlink" title="1. 选择合适的列创建索引"></a>1. 选择合适的列创建索引</h3><figure><div class="code-wrapper"><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">-- 适合创建索引的列</span>
<span class="token comment">-- 1. 经常出现在WHERE子句中的列</span>
<span class="token keyword">CREATE</span> <span class="token keyword">INDEX</span> idx_user_status <span class="token keyword">ON</span> users<span class="token punctuation">(</span><span class="token keyword">status</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 2. 经常用于JOIN的列</span>
<span class="token keyword">CREATE</span> <span class="token keyword">INDEX</span> idx_order_user_id <span class="token keyword">ON</span> orders<span class="token punctuation">(</span>user_id<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 3. 经常用于ORDER BY的列</span>
<span class="token keyword">CREATE</span> <span class="token keyword">INDEX</span> idx_order_date <span class="token keyword">ON</span> orders<span class="token punctuation">(</span>order_date<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 4. 经常用于GROUP BY的列</span>
<span class="token keyword">CREATE</span> <span class="token keyword">INDEX</span> idx_product_category <span class="token keyword">ON</span> products<span class="token punctuation">(</span>category_id<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h3 id="2-避免过度索引"><a href="#2-避免过度索引" class="headerlink" title="2. 避免过度索引"></a>2. 避免过度索引</h3><figure><div class="code-wrapper"><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">-- 不好的做法：为每个列都创建索引</span>
<span class="token keyword">CREATE</span> <span class="token keyword">INDEX</span> idx_user_name <span class="token keyword">ON</span> users<span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">CREATE</span> <span class="token keyword">INDEX</span> idx_user_age <span class="token keyword">ON</span> users<span class="token punctuation">(</span>age<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">CREATE</span> <span class="token keyword">INDEX</span> idx_user_city <span class="token keyword">ON</span> users<span class="token punctuation">(</span>city<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">CREATE</span> <span class="token keyword">INDEX</span> idx_user_phone <span class="token keyword">ON</span> users<span class="token punctuation">(</span>phone<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">CREATE</span> <span class="token keyword">INDEX</span> idx_user_email <span class="token keyword">ON</span> users<span class="token punctuation">(</span>email<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 更好的做法：根据查询模式创建复合索引</span>
<span class="token keyword">CREATE</span> <span class="token keyword">INDEX</span> idx_user_age_city <span class="token keyword">ON</span> users<span class="token punctuation">(</span>age<span class="token punctuation">,</span> city<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">CREATE</span> <span class="token keyword">UNIQUE</span> <span class="token keyword">INDEX</span> idx_user_email <span class="token keyword">ON</span> users<span class="token punctuation">(</span>email<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h3 id="3-复合索引的列顺序优化"><a href="#3-复合索引的列顺序优化" class="headerlink" title="3. 复合索引的列顺序优化"></a>3. 复合索引的列顺序优化</h3><figure><div class="code-wrapper"><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">-- 根据选择性排序（选择性高的列放前面）</span>
<span class="token comment">-- 假设：city有100个不同值，age有50个不同值，gender只有2个值</span>

<span class="token comment">-- 好的顺序：选择性从高到低</span>
<span class="token keyword">CREATE</span> <span class="token keyword">INDEX</span> idx_user_city_age_gender <span class="token keyword">ON</span> users<span class="token punctuation">(</span>city<span class="token punctuation">,</span> age<span class="token punctuation">,</span> gender<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 不好的顺序：选择性低的列在前面</span>
<span class="token keyword">CREATE</span> <span class="token keyword">INDEX</span> idx_user_gender_age_city <span class="token keyword">ON</span> users<span class="token punctuation">(</span>gender<span class="token punctuation">,</span> age<span class="token punctuation">,</span> city<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h2 id="（二）查询优化技巧"><a href="#（二）查询优化技巧" class="headerlink" title="（二）查询优化技巧"></a>（二）查询优化技巧</h2><h3 id="1-利用索引覆盖"><a href="#1-利用索引覆盖" class="headerlink" title="1. 利用索引覆盖"></a>1. 利用索引覆盖</h3><figure><div class="code-wrapper"><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">-- 创建覆盖索引</span>
<span class="token keyword">CREATE</span> <span class="token keyword">INDEX</span> idx_user_age_name <span class="token keyword">ON</span> users<span class="token punctuation">(</span>age<span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 这个查询可以完全通过索引满足，不需要回表</span>
<span class="token keyword">SELECT</span> name <span class="token keyword">FROM</span> users <span class="token keyword">WHERE</span> age <span class="token operator">=</span> <span class="token number">25</span><span class="token punctuation">;</span>

<span class="token comment">-- 查看执行计划，Extra列会显示"Using index"</span>
<span class="token keyword">EXPLAIN</span> <span class="token keyword">SELECT</span> name <span class="token keyword">FROM</span> users <span class="token keyword">WHERE</span> age <span class="token operator">=</span> <span class="token number">25</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h3 id="2-避免索引失效"><a href="#2-避免索引失效" class="headerlink" title="2. 避免索引失效"></a>2. 避免索引失效</h3><figure><div class="code-wrapper"><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">-- 索引失效的情况</span>

<span class="token comment">-- 1. 在索引列上使用函数</span>
<span class="token comment">-- 不好：</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> users <span class="token keyword">WHERE</span> <span class="token keyword">YEAR</span><span class="token punctuation">(</span>created_at<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">2023</span><span class="token punctuation">;</span>
<span class="token comment">-- 好：</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> users <span class="token keyword">WHERE</span> created_at <span class="token operator">>=</span> <span class="token string">'2023-01-01'</span> <span class="token operator">AND</span> created_at <span class="token operator">&lt;</span> <span class="token string">'2024-01-01'</span><span class="token punctuation">;</span>

<span class="token comment">-- 2. 使用不等于操作符</span>
<span class="token comment">-- 不好：</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> users <span class="token keyword">WHERE</span> <span class="token keyword">status</span> <span class="token operator">!=</span> <span class="token string">'active'</span><span class="token punctuation">;</span>
<span class="token comment">-- 好：</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> users <span class="token keyword">WHERE</span> <span class="token keyword">status</span> <span class="token operator">IN</span> <span class="token punctuation">(</span><span class="token string">'inactive'</span><span class="token punctuation">,</span> <span class="token string">'pending'</span><span class="token punctuation">,</span> <span class="token string">'suspended'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 3. 使用OR连接不同列</span>
<span class="token comment">-- 不好：</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> users <span class="token keyword">WHERE</span> name <span class="token operator">=</span> <span class="token string">'John'</span> <span class="token operator">OR</span> age <span class="token operator">=</span> <span class="token number">25</span><span class="token punctuation">;</span>
<span class="token comment">-- 好：使用UNION</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> users <span class="token keyword">WHERE</span> name <span class="token operator">=</span> <span class="token string">'John'</span>
<span class="token keyword">UNION</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> users <span class="token keyword">WHERE</span> age <span class="token operator">=</span> <span class="token number">25</span><span class="token punctuation">;</span>

<span class="token comment">-- 4. 模糊查询以通配符开头</span>
<span class="token comment">-- 不好：</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> users <span class="token keyword">WHERE</span> name <span class="token operator">LIKE</span> <span class="token string">'%John'</span><span class="token punctuation">;</span>
<span class="token comment">-- 好：</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> users <span class="token keyword">WHERE</span> name <span class="token operator">LIKE</span> <span class="token string">'John%'</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h3 id="3-范围查询优化"><a href="#3-范围查询优化" class="headerlink" title="3. 范围查询优化"></a>3. 范围查询优化</h3><figure><div class="code-wrapper"><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">-- 复合索引中范围查询的影响</span>
<span class="token keyword">CREATE</span> <span class="token keyword">INDEX</span> idx_user_age_city_status <span class="token keyword">ON</span> users<span class="token punctuation">(</span>age<span class="token punctuation">,</span> city<span class="token punctuation">,</span> <span class="token keyword">status</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 这个查询只能使用索引的age部分</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> users <span class="token keyword">WHERE</span> age <span class="token operator">></span> <span class="token number">20</span> <span class="token operator">AND</span> city <span class="token operator">=</span> <span class="token string">'Beijing'</span> <span class="token operator">AND</span> <span class="token keyword">status</span> <span class="token operator">=</span> <span class="token string">'active'</span><span class="token punctuation">;</span>

<span class="token comment">-- 优化：调整索引列顺序</span>
<span class="token keyword">CREATE</span> <span class="token keyword">INDEX</span> idx_user_city_status_age <span class="token keyword">ON</span> users<span class="token punctuation">(</span>city<span class="token punctuation">,</span> <span class="token keyword">status</span><span class="token punctuation">,</span> age<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">-- 现在可以充分利用索引</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> users <span class="token keyword">WHERE</span> city <span class="token operator">=</span> <span class="token string">'Beijing'</span> <span class="token operator">AND</span> <span class="token keyword">status</span> <span class="token operator">=</span> <span class="token string">'active'</span> <span class="token operator">AND</span> age <span class="token operator">></span> <span class="token number">20</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h2 id="（三）索引监控与维护"><a href="#（三）索引监控与维护" class="headerlink" title="（三）索引监控与维护"></a>（三）索引监控与维护</h2><h3 id="1-监控索引使用情况"><a href="#1-监控索引使用情况" class="headerlink" title="1. 监控索引使用情况"></a>1. 监控索引使用情况</h3><figure><div class="code-wrapper"><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">-- 查看索引使用统计</span>
<span class="token keyword">SELECT</span> 
    OBJECT_SCHEMA<span class="token punctuation">,</span>
    OBJECT_NAME<span class="token punctuation">,</span>
    INDEX_NAME<span class="token punctuation">,</span>
    COUNT_FETCH<span class="token punctuation">,</span>
    COUNT_INSERT<span class="token punctuation">,</span>
    COUNT_UPDATE<span class="token punctuation">,</span>
    COUNT_DELETE
<span class="token keyword">FROM</span> performance_schema<span class="token punctuation">.</span>table_io_waits_summary_by_index_usage
<span class="token keyword">WHERE</span> OBJECT_SCHEMA <span class="token operator">=</span> <span class="token string">'your_database'</span>
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> COUNT_FETCH <span class="token keyword">DESC</span><span class="token punctuation">;</span>

<span class="token comment">-- 查找未使用的索引</span>
<span class="token keyword">SELECT</span> 
    OBJECT_SCHEMA<span class="token punctuation">,</span>
    OBJECT_NAME<span class="token punctuation">,</span>
    INDEX_NAME
<span class="token keyword">FROM</span> performance_schema<span class="token punctuation">.</span>table_io_waits_summary_by_index_usage
<span class="token keyword">WHERE</span> OBJECT_SCHEMA <span class="token operator">=</span> <span class="token string">'your_database'</span>
<span class="token operator">AND</span> INDEX_NAME <span class="token operator">IS</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span>
<span class="token operator">AND</span> COUNT_FETCH <span class="token operator">=</span> <span class="token number">0</span>
<span class="token operator">AND</span> COUNT_INSERT <span class="token operator">=</span> <span class="token number">0</span>
<span class="token operator">AND</span> COUNT_UPDATE <span class="token operator">=</span> <span class="token number">0</span>
<span class="token operator">AND</span> COUNT_DELETE <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h3 id="2-索引碎片整理"><a href="#2-索引碎片整理" class="headerlink" title="2. 索引碎片整理"></a>2. 索引碎片整理</h3><figure><div class="code-wrapper"><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">-- 查看索引碎片情况</span>
<span class="token keyword">SHOW</span> <span class="token keyword">TABLE</span> <span class="token keyword">STATUS</span> <span class="token operator">LIKE</span> <span class="token string">'users'</span><span class="token punctuation">;</span>

<span class="token comment">-- 重建索引（消除碎片）</span>
<span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> users <span class="token keyword">ENGINE</span><span class="token operator">=</span><span class="token keyword">InnoDB</span><span class="token punctuation">;</span>

<span class="token comment">-- 或者使用OPTIMIZE TABLE</span>
<span class="token keyword">OPTIMIZE</span> <span class="token keyword">TABLE</span> users<span class="token punctuation">;</span>

<span class="token comment">-- 重建特定索引</span>
<span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> users <span class="token keyword">DROP</span> <span class="token keyword">INDEX</span> idx_user_age<span class="token punctuation">,</span> <span class="token keyword">ADD</span> <span class="token keyword">INDEX</span> idx_user_age <span class="token punctuation">(</span>age<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h3 id="3-索引统计信息更新"><a href="#3-索引统计信息更新" class="headerlink" title="3. 索引统计信息更新"></a>3. 索引统计信息更新</h3><figure><div class="code-wrapper"><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">-- 更新表的统计信息</span>
<span class="token keyword">ANALYZE</span> <span class="token keyword">TABLE</span> users<span class="token punctuation">;</span>

<span class="token comment">-- 查看索引基数（不同值的数量）</span>
<span class="token keyword">SHOW</span> <span class="token keyword">INDEX</span> <span class="token keyword">FROM</span> users<span class="token punctuation">;</span>

<span class="token comment">-- 手动更新统计信息</span>
<span class="token keyword">SET</span> <span class="token keyword">SESSION</span> optimizer_switch<span class="token operator">=</span><span class="token string">'use_index_extensions=off'</span><span class="token punctuation">;</span>
<span class="token keyword">ANALYZE</span> <span class="token keyword">TABLE</span> users<span class="token punctuation">;</span>
<span class="token keyword">SET</span> <span class="token keyword">SESSION</span> optimizer_switch<span class="token operator">=</span><span class="token string">'use_index_extensions=on'</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h1 id="六、实际应用案例"><a href="#六、实际应用案例" class="headerlink" title="六、实际应用案例"></a>六、实际应用案例</h1><h2 id="（一）电商系统索引设计"><a href="#（一）电商系统索引设计" class="headerlink" title="（一）电商系统索引设计"></a>（一）电商系统索引设计</h2><h3 id="1-用户表索引设计"><a href="#1-用户表索引设计" class="headerlink" title="1. 用户表索引设计"></a>1. 用户表索引设计</h3><figure><div class="code-wrapper"><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> users <span class="token punctuation">(</span>
    id <span class="token keyword">BIGINT</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token punctuation">,</span>
    username <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
    email <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
    phone <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword">status</span> <span class="token keyword">TINYINT</span> <span class="token keyword">DEFAULT</span> <span class="token number">1</span><span class="token punctuation">,</span>
    created_at <span class="token keyword">TIMESTAMP</span> <span class="token keyword">DEFAULT</span> <span class="token keyword">CURRENT_TIMESTAMP</span><span class="token punctuation">,</span>
    updated_at <span class="token keyword">TIMESTAMP</span> <span class="token keyword">DEFAULT</span> <span class="token keyword">CURRENT_TIMESTAMP</span> <span class="token keyword">ON</span> <span class="token keyword">UPDATE</span> <span class="token keyword">CURRENT_TIMESTAMP</span><span class="token punctuation">,</span>
    
    <span class="token comment">-- 索引设计</span>
    <span class="token keyword">UNIQUE</span> <span class="token keyword">INDEX</span> idx_username <span class="token punctuation">(</span>username<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword">UNIQUE</span> <span class="token keyword">INDEX</span> idx_email <span class="token punctuation">(</span>email<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword">INDEX</span> idx_phone <span class="token punctuation">(</span>phone<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword">INDEX</span> idx_status_created <span class="token punctuation">(</span><span class="token keyword">status</span><span class="token punctuation">,</span> created_at<span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h3 id="2-订单表索引设计"><a href="#2-订单表索引设计" class="headerlink" title="2. 订单表索引设计"></a>2. 订单表索引设计</h3><figure><div class="code-wrapper"><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> orders <span class="token punctuation">(</span>
    id <span class="token keyword">BIGINT</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token punctuation">,</span>
    user_id <span class="token keyword">BIGINT</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
    order_no <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
    <span class="token keyword">status</span> <span class="token keyword">TINYINT</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
    total_amount <span class="token keyword">DECIMAL</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
    created_at <span class="token keyword">TIMESTAMP</span> <span class="token keyword">DEFAULT</span> <span class="token keyword">CURRENT_TIMESTAMP</span><span class="token punctuation">,</span>
    updated_at <span class="token keyword">TIMESTAMP</span> <span class="token keyword">DEFAULT</span> <span class="token keyword">CURRENT_TIMESTAMP</span> <span class="token keyword">ON</span> <span class="token keyword">UPDATE</span> <span class="token keyword">CURRENT_TIMESTAMP</span><span class="token punctuation">,</span>
    
    <span class="token comment">-- 索引设计</span>
    <span class="token keyword">UNIQUE</span> <span class="token keyword">INDEX</span> idx_order_no <span class="token punctuation">(</span>order_no<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword">INDEX</span> idx_user_id <span class="token punctuation">(</span>user_id<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword">INDEX</span> idx_status_created <span class="token punctuation">(</span><span class="token keyword">status</span><span class="token punctuation">,</span> created_at<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword">INDEX</span> idx_user_status_created <span class="token punctuation">(</span>user_id<span class="token punctuation">,</span> <span class="token keyword">status</span><span class="token punctuation">,</span> created_at<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword">INDEX</span> idx_created_at <span class="token punctuation">(</span>created_at<span class="token punctuation">)</span><span class="token punctuation">,</span>
    
    <span class="token keyword">FOREIGN</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span>user_id<span class="token punctuation">)</span> <span class="token keyword">REFERENCES</span> users<span class="token punctuation">(</span>id<span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h3 id="3-商品表索引设计"><a href="#3-商品表索引设计" class="headerlink" title="3. 商品表索引设计"></a>3. 商品表索引设计</h3><figure><div class="code-wrapper"><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> products <span class="token punctuation">(</span>
    id <span class="token keyword">BIGINT</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token punctuation">,</span>
    name <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
    category_id <span class="token keyword">INT</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
    brand_id <span class="token keyword">INT</span><span class="token punctuation">,</span>
    price <span class="token keyword">DECIMAL</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
    stock <span class="token keyword">INT</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token keyword">status</span> <span class="token keyword">TINYINT</span> <span class="token keyword">DEFAULT</span> <span class="token number">1</span><span class="token punctuation">,</span>
    created_at <span class="token keyword">TIMESTAMP</span> <span class="token keyword">DEFAULT</span> <span class="token keyword">CURRENT_TIMESTAMP</span><span class="token punctuation">,</span>
    
    <span class="token comment">-- 索引设计</span>
    <span class="token keyword">INDEX</span> idx_category_price <span class="token punctuation">(</span>category_id<span class="token punctuation">,</span> price<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword">INDEX</span> idx_brand_price <span class="token punctuation">(</span>brand_id<span class="token punctuation">,</span> price<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword">INDEX</span> idx_status_stock <span class="token punctuation">(</span><span class="token keyword">status</span><span class="token punctuation">,</span> stock<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword">INDEX</span> idx_name <span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">,</span>
    FULLTEXT <span class="token keyword">INDEX</span> idx_name_fulltext <span class="token punctuation">(</span>name<span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h2 id="（二）日志系统索引优化"><a href="#（二）日志系统索引优化" class="headerlink" title="（二）日志系统索引优化"></a>（二）日志系统索引优化</h2><h3 id="1-访问日志表"><a href="#1-访问日志表" class="headerlink" title="1. 访问日志表"></a>1. 访问日志表</h3><figure><div class="code-wrapper"><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> access_logs <span class="token punctuation">(</span>
    id <span class="token keyword">BIGINT</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token punctuation">,</span>
    user_id <span class="token keyword">BIGINT</span><span class="token punctuation">,</span>
    ip_address <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">45</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    user_agent <span class="token keyword">TEXT</span><span class="token punctuation">,</span>
    request_url <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    response_code <span class="token keyword">INT</span><span class="token punctuation">,</span>
    response_time <span class="token keyword">INT</span><span class="token punctuation">,</span>
    created_at <span class="token keyword">TIMESTAMP</span> <span class="token keyword">DEFAULT</span> <span class="token keyword">CURRENT_TIMESTAMP</span><span class="token punctuation">,</span>
    
    <span class="token comment">-- 时间分区索引</span>
    <span class="token keyword">INDEX</span> idx_created_at <span class="token punctuation">(</span>created_at<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword">INDEX</span> idx_user_created <span class="token punctuation">(</span>user_id<span class="token punctuation">,</span> created_at<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword">INDEX</span> idx_ip_created <span class="token punctuation">(</span>ip_address<span class="token punctuation">,</span> created_at<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword">INDEX</span> idx_response_code <span class="token punctuation">(</span>response_code<span class="token punctuation">)</span>
<span class="token punctuation">)</span> <span class="token keyword">PARTITION</span> <span class="token keyword">BY</span> RANGE <span class="token punctuation">(</span>UNIX_TIMESTAMP<span class="token punctuation">(</span>created_at<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>
    <span class="token keyword">PARTITION</span> p202301 <span class="token keyword">VALUES</span> LESS THAN <span class="token punctuation">(</span>UNIX_TIMESTAMP<span class="token punctuation">(</span><span class="token string">'2023-02-01'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword">PARTITION</span> p202302 <span class="token keyword">VALUES</span> LESS THAN <span class="token punctuation">(</span>UNIX_TIMESTAMP<span class="token punctuation">(</span><span class="token string">'2023-03-01'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword">PARTITION</span> p202303 <span class="token keyword">VALUES</span> LESS THAN <span class="token punctuation">(</span>UNIX_TIMESTAMP<span class="token punctuation">(</span><span class="token string">'2023-04-01'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token comment">-- 继续添加分区...</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h3 id="2-常用查询优化"><a href="#2-常用查询优化" class="headerlink" title="2. 常用查询优化"></a>2. 常用查询优化</h3><figure><div class="code-wrapper"><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">-- 查询某用户的访问记录</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> access_logs 
<span class="token keyword">WHERE</span> user_id <span class="token operator">=</span> <span class="token number">12345</span> 
<span class="token operator">AND</span> created_at <span class="token operator">>=</span> <span class="token string">'2023-01-01'</span> 
<span class="token operator">AND</span> created_at <span class="token operator">&lt;</span> <span class="token string">'2023-02-01'</span>
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> created_at <span class="token keyword">DESC</span> 
<span class="token keyword">LIMIT</span> <span class="token number">100</span><span class="token punctuation">;</span>

<span class="token comment">-- 统计每小时的访问量</span>
<span class="token keyword">SELECT</span> 
    DATE_FORMAT<span class="token punctuation">(</span>created_at<span class="token punctuation">,</span> <span class="token string">'%Y-%m-%d %H:00:00'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token keyword">hour</span><span class="token punctuation">,</span>
    <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">as</span> access_count
<span class="token keyword">FROM</span> access_logs 
<span class="token keyword">WHERE</span> created_at <span class="token operator">>=</span> <span class="token string">'2023-01-01'</span> 
<span class="token operator">AND</span> created_at <span class="token operator">&lt;</span> <span class="token string">'2023-01-02'</span>
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> <span class="token keyword">hour</span>
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> <span class="token keyword">hour</span><span class="token punctuation">;</span>

<span class="token comment">-- 查找异常响应</span>
<span class="token keyword">SELECT</span> ip_address<span class="token punctuation">,</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">as</span> error_count
<span class="token keyword">FROM</span> access_logs 
<span class="token keyword">WHERE</span> response_code <span class="token operator">>=</span> <span class="token number">400</span> 
<span class="token operator">AND</span> created_at <span class="token operator">>=</span> DATE_SUB<span class="token punctuation">(</span><span class="token function">NOW</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">INTERVAL</span> <span class="token number">1</span> <span class="token keyword">HOUR</span><span class="token punctuation">)</span>
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> ip_address
<span class="token keyword">HAVING</span> error_count <span class="token operator">></span> <span class="token number">10</span>
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> error_count <span class="token keyword">DESC</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h2 id="（三）性能测试与对比"><a href="#（三）性能测试与对比" class="headerlink" title="（三）性能测试与对比"></a>（三）性能测试与对比</h2><h3 id="1-创建测试数据"><a href="#1-创建测试数据" class="headerlink" title="1. 创建测试数据"></a>1. 创建测试数据</h3><figure><div class="code-wrapper"><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">-- 创建测试表</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> test_users <span class="token punctuation">(</span>
    id <span class="token keyword">INT</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token punctuation">,</span>
    name <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    age <span class="token keyword">INT</span><span class="token punctuation">,</span>
    city <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    email <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    created_at <span class="token keyword">TIMESTAMP</span> <span class="token keyword">DEFAULT</span> <span class="token keyword">CURRENT_TIMESTAMP</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 插入测试数据（100万条）</span>
<span class="token keyword">DELIMITER</span> <span class="token comment">//</span>
<span class="token keyword">CREATE</span> <span class="token keyword">PROCEDURE</span> insert_test_data<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">BEGIN</span>
    <span class="token keyword">DECLARE</span> i <span class="token keyword">INT</span> <span class="token keyword">DEFAULT</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">WHILE</span> i <span class="token operator">&lt;=</span> <span class="token number">1000000</span> <span class="token keyword">DO</span>
        <span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> test_users <span class="token punctuation">(</span>name<span class="token punctuation">,</span> age<span class="token punctuation">,</span> city<span class="token punctuation">,</span> email<span class="token punctuation">)</span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span>
            CONCAT<span class="token punctuation">(</span><span class="token string">'User'</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">,</span>
            FLOOR<span class="token punctuation">(</span><span class="token number">18</span> <span class="token operator">+</span> RAND<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token keyword">CASE</span> FLOOR<span class="token punctuation">(</span>RAND<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">5</span><span class="token punctuation">)</span>
                <span class="token keyword">WHEN</span> <span class="token number">0</span> <span class="token keyword">THEN</span> <span class="token string">'Beijing'</span>
                <span class="token keyword">WHEN</span> <span class="token number">1</span> <span class="token keyword">THEN</span> <span class="token string">'Shanghai'</span>
                <span class="token keyword">WHEN</span> <span class="token number">2</span> <span class="token keyword">THEN</span> <span class="token string">'Guangzhou'</span>
                <span class="token keyword">WHEN</span> <span class="token number">3</span> <span class="token keyword">THEN</span> <span class="token string">'Shenzhen'</span>
                <span class="token keyword">ELSE</span> <span class="token string">'Hangzhou'</span>
            <span class="token keyword">END</span><span class="token punctuation">,</span>
            CONCAT<span class="token punctuation">(</span><span class="token string">'user'</span><span class="token punctuation">,</span> i<span class="token punctuation">,</span> <span class="token string">'@example.com'</span><span class="token punctuation">)</span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">SET</span> i <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">END</span> <span class="token keyword">WHILE</span><span class="token punctuation">;</span>
<span class="token keyword">END</span> <span class="token comment">//</span>
<span class="token keyword">DELIMITER</span> <span class="token punctuation">;</span>

<span class="token keyword">CALL</span> insert_test_data<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h3 id="2-性能对比测试"><a href="#2-性能对比测试" class="headerlink" title="2. 性能对比测试"></a>2. 性能对比测试</h3><figure><div class="code-wrapper"><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">-- 测试1：无索引查询</span>
<span class="token keyword">SET</span> profiling <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> test_users <span class="token keyword">WHERE</span> age <span class="token operator">=</span> <span class="token number">25</span><span class="token punctuation">;</span>
<span class="token keyword">SHOW</span> PROFILES<span class="token punctuation">;</span>

<span class="token comment">-- 创建索引</span>
<span class="token keyword">CREATE</span> <span class="token keyword">INDEX</span> idx_age <span class="token keyword">ON</span> test_users<span class="token punctuation">(</span>age<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 测试2：有索引查询</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> test_users <span class="token keyword">WHERE</span> age <span class="token operator">=</span> <span class="token number">25</span><span class="token punctuation">;</span>
<span class="token keyword">SHOW</span> PROFILES<span class="token punctuation">;</span>

<span class="token comment">-- 复合查询测试</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> test_users <span class="token keyword">WHERE</span> age <span class="token operator">=</span> <span class="token number">25</span> <span class="token operator">AND</span> city <span class="token operator">=</span> <span class="token string">'Beijing'</span><span class="token punctuation">;</span>

<span class="token comment">-- 创建复合索引</span>
<span class="token keyword">CREATE</span> <span class="token keyword">INDEX</span> idx_age_city <span class="token keyword">ON</span> test_users<span class="token punctuation">(</span>age<span class="token punctuation">,</span> city<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 再次测试</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> test_users <span class="token keyword">WHERE</span> age <span class="token operator">=</span> <span class="token number">25</span> <span class="token operator">AND</span> city <span class="token operator">=</span> <span class="token string">'Beijing'</span><span class="token punctuation">;</span>
<span class="token keyword">SHOW</span> PROFILES<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h3 id="3-索引效果分析"><a href="#3-索引效果分析" class="headerlink" title="3. 索引效果分析"></a>3. 索引效果分析</h3><figure><div class="code-wrapper"><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">-- 分析查询执行计划</span>
<span class="token keyword">EXPLAIN</span> FORMAT<span class="token operator">=</span>JSON 
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> test_users 
<span class="token keyword">WHERE</span> age <span class="token operator">BETWEEN</span> <span class="token number">25</span> <span class="token operator">AND</span> <span class="token number">35</span> 
<span class="token operator">AND</span> city <span class="token operator">=</span> <span class="token string">'Beijing'</span>
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> created_at <span class="token keyword">DESC</span>
<span class="token keyword">LIMIT</span> <span class="token number">10</span><span class="token punctuation">;</span>

<span class="token comment">-- 查看索引使用情况</span>
<span class="token keyword">SHOW</span> <span class="token keyword">STATUS</span> <span class="token operator">LIKE</span> <span class="token string">'Handler_read%'</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h1 id="七、常见问题与解决方案"><a href="#七、常见问题与解决方案" class="headerlink" title="七、常见问题与解决方案"></a>七、常见问题与解决方案</h1><h2 id="（一）索引失效问题"><a href="#（一）索引失效问题" class="headerlink" title="（一）索引失效问题"></a>（一）索引失效问题</h2><h3 id="1-隐式类型转换"><a href="#1-隐式类型转换" class="headerlink" title="1. 隐式类型转换"></a>1. 隐式类型转换</h3><figure><div class="code-wrapper"><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">-- 问题：字符串列与数字比较</span>
<span class="token keyword">CREATE</span> <span class="token keyword">INDEX</span> idx_user_code <span class="token keyword">ON</span> users<span class="token punctuation">(</span>user_code<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">-- user_code是VARCHAR类型</span>

<span class="token comment">-- 错误用法：导致索引失效</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> users <span class="token keyword">WHERE</span> user_code <span class="token operator">=</span> <span class="token number">123</span><span class="token punctuation">;</span>

<span class="token comment">-- 正确用法：</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> users <span class="token keyword">WHERE</span> user_code <span class="token operator">=</span> <span class="token string">'123'</span><span class="token punctuation">;</span>

<span class="token comment">-- 验证是否使用索引</span>
<span class="token keyword">EXPLAIN</span> <span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> users <span class="token keyword">WHERE</span> user_code <span class="token operator">=</span> <span class="token number">123</span><span class="token punctuation">;</span>     <span class="token comment">-- type: ALL（全表扫描）</span>
<span class="token keyword">EXPLAIN</span> <span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> users <span class="token keyword">WHERE</span> user_code <span class="token operator">=</span> <span class="token string">'123'</span><span class="token punctuation">;</span>   <span class="token comment">-- type: ref（使用索引）</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h3 id="2-函数操作导致索引失效"><a href="#2-函数操作导致索引失效" class="headerlink" title="2. 函数操作导致索引失效"></a>2. 函数操作导致索引失效</h3><figure><div class="code-wrapper"><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">-- 问题：在索引列上使用函数</span>
<span class="token keyword">CREATE</span> <span class="token keyword">INDEX</span> idx_created_at <span class="token keyword">ON</span> orders<span class="token punctuation">(</span>created_at<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 错误用法：索引失效</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> orders <span class="token keyword">WHERE</span> <span class="token keyword">DATE</span><span class="token punctuation">(</span>created_at<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token string">'2023-01-01'</span><span class="token punctuation">;</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> orders <span class="token keyword">WHERE</span> <span class="token keyword">YEAR</span><span class="token punctuation">(</span>created_at<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">2023</span><span class="token punctuation">;</span>

<span class="token comment">-- 正确用法：</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> orders <span class="token keyword">WHERE</span> created_at <span class="token operator">>=</span> <span class="token string">'2023-01-01'</span> <span class="token operator">AND</span> created_at <span class="token operator">&lt;</span> <span class="token string">'2023-01-02'</span><span class="token punctuation">;</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> orders <span class="token keyword">WHERE</span> created_at <span class="token operator">>=</span> <span class="token string">'2023-01-01'</span> <span class="token operator">AND</span> created_at <span class="token operator">&lt;</span> <span class="token string">'2024-01-01'</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h3 id="3-复合索引使用不当"><a href="#3-复合索引使用不当" class="headerlink" title="3. 复合索引使用不当"></a>3. 复合索引使用不当</h3><figure><div class="code-wrapper"><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">-- 复合索引：idx_user_age_city(user_id, age, city)</span>
<span class="token keyword">CREATE</span> <span class="token keyword">INDEX</span> idx_user_age_city <span class="token keyword">ON</span> orders<span class="token punctuation">(</span>user_id<span class="token punctuation">,</span> age<span class="token punctuation">,</span> city<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 可以使用索引的查询</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> orders <span class="token keyword">WHERE</span> user_id <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>                           <span class="token comment">-- ✓</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> orders <span class="token keyword">WHERE</span> user_id <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">AND</span> age <span class="token operator">=</span> <span class="token number">25</span><span class="token punctuation">;</span>             <span class="token comment">-- ✓</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> orders <span class="token keyword">WHERE</span> user_id <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">AND</span> age <span class="token operator">=</span> <span class="token number">25</span> <span class="token operator">AND</span> city <span class="token operator">=</span> <span class="token string">'Beijing'</span><span class="token punctuation">;</span> <span class="token comment">-- ✓</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> orders <span class="token keyword">WHERE</span> user_id <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">AND</span> city <span class="token operator">=</span> <span class="token string">'Beijing'</span><span class="token punctuation">;</span>     <span class="token comment">-- ✓（部分使用）</span>

<span class="token comment">-- 无法使用索引的查询</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> orders <span class="token keyword">WHERE</span> age <span class="token operator">=</span> <span class="token number">25</span><span class="token punctuation">;</span>                             <span class="token comment">-- ✗</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> orders <span class="token keyword">WHERE</span> city <span class="token operator">=</span> <span class="token string">'Beijing'</span><span class="token punctuation">;</span>                     <span class="token comment">-- ✗</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> orders <span class="token keyword">WHERE</span> age <span class="token operator">=</span> <span class="token number">25</span> <span class="token operator">AND</span> city <span class="token operator">=</span> <span class="token string">'Beijing'</span><span class="token punctuation">;</span>        <span class="token comment">-- ✗</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h2 id="（二）性能问题诊断"><a href="#（二）性能问题诊断" class="headerlink" title="（二）性能问题诊断"></a>（二）性能问题诊断</h2><h3 id="1-慢查询分析"><a href="#1-慢查询分析" class="headerlink" title="1. 慢查询分析"></a>1. 慢查询分析</h3><figure><div class="code-wrapper"><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">-- 开启慢查询日志</span>
<span class="token keyword">SET</span> <span class="token keyword">GLOBAL</span> slow_query_log <span class="token operator">=</span> <span class="token string">'ON'</span><span class="token punctuation">;</span>
<span class="token keyword">SET</span> <span class="token keyword">GLOBAL</span> long_query_time <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">-- 超过1秒的查询记录到慢查询日志</span>

<span class="token comment">-- 查看慢查询配置</span>
<span class="token keyword">SHOW</span> VARIABLES <span class="token operator">LIKE</span> <span class="token string">'slow_query%'</span><span class="token punctuation">;</span>
<span class="token keyword">SHOW</span> VARIABLES <span class="token operator">LIKE</span> <span class="token string">'long_query_time'</span><span class="token punctuation">;</span>

<span class="token comment">-- 分析慢查询</span>
<span class="token comment">-- 使用mysqldumpslow工具分析慢查询日志</span>
<span class="token comment">-- mysqldumpslow -s c -t 10 /var/log/mysql/slow.log</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h3 id="2-索引选择性分析"><a href="#2-索引选择性分析" class="headerlink" title="2. 索引选择性分析"></a>2. 索引选择性分析</h3><figure><div class="code-wrapper"><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">-- 计算列的选择性（不同值的比例）</span>
<span class="token keyword">SELECT</span> 
    <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token keyword">DISTINCT</span> age<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">as</span> age_selectivity<span class="token punctuation">,</span>
    <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token keyword">DISTINCT</span> city<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">as</span> city_selectivity<span class="token punctuation">,</span>
    <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token keyword">DISTINCT</span> gender<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">as</span> gender_selectivity
<span class="token keyword">FROM</span> users<span class="token punctuation">;</span>

<span class="token comment">-- 选择性高的列更适合作为索引</span>
<span class="token comment">-- 一般来说，选择性 > 0.1 的列适合创建索引</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h3 id="3-索引大小分析"><a href="#3-索引大小分析" class="headerlink" title="3. 索引大小分析"></a>3. 索引大小分析</h3><figure><div class="code-wrapper"><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">-- 查看表和索引的大小</span>
<span class="token keyword">SELECT</span> 
    TABLE_NAME<span class="token punctuation">,</span>
    <span class="token function">ROUND</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>DATA_LENGTH <span class="token operator">+</span> INDEX_LENGTH<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">1024</span> <span class="token operator">/</span> <span class="token number">1024</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> <span class="token string">'Total Size (MB)'</span><span class="token punctuation">,</span>
    <span class="token function">ROUND</span><span class="token punctuation">(</span><span class="token punctuation">(</span>DATA_LENGTH <span class="token operator">/</span> <span class="token number">1024</span> <span class="token operator">/</span> <span class="token number">1024</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> <span class="token string">'Data Size (MB)'</span><span class="token punctuation">,</span>
    <span class="token function">ROUND</span><span class="token punctuation">(</span><span class="token punctuation">(</span>INDEX_LENGTH <span class="token operator">/</span> <span class="token number">1024</span> <span class="token operator">/</span> <span class="token number">1024</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> <span class="token string">'Index Size (MB)'</span>
<span class="token keyword">FROM</span> information_schema<span class="token punctuation">.</span><span class="token keyword">TABLES</span> 
<span class="token keyword">WHERE</span> TABLE_SCHEMA <span class="token operator">=</span> <span class="token string">'your_database'</span>
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> <span class="token punctuation">(</span>DATA_LENGTH <span class="token operator">+</span> INDEX_LENGTH<span class="token punctuation">)</span> <span class="token keyword">DESC</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h2 id="（三）索引维护问题"><a href="#（三）索引维护问题" class="headerlink" title="（三）索引维护问题"></a>（三）索引维护问题</h2><h3 id="1-索引碎片问题"><a href="#1-索引碎片问题" class="headerlink" title="1. 索引碎片问题"></a>1. 索引碎片问题</h3><figure><div class="code-wrapper"><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">-- 检查表的碎片情况</span>
<span class="token keyword">SELECT</span> 
    TABLE_NAME<span class="token punctuation">,</span>
    DATA_LENGTH<span class="token punctuation">,</span>
    INDEX_LENGTH<span class="token punctuation">,</span>
    DATA_FREE<span class="token punctuation">,</span>
    <span class="token function">ROUND</span><span class="token punctuation">(</span>DATA_FREE <span class="token operator">/</span> <span class="token punctuation">(</span>DATA_LENGTH <span class="token operator">+</span> INDEX_LENGTH<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> <span class="token string">'Fragmentation %'</span>
<span class="token keyword">FROM</span> information_schema<span class="token punctuation">.</span><span class="token keyword">TABLES</span> 
<span class="token keyword">WHERE</span> TABLE_SCHEMA <span class="token operator">=</span> <span class="token string">'your_database'</span>
<span class="token operator">AND</span> DATA_FREE <span class="token operator">></span> <span class="token number">0</span>
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> DATA_FREE <span class="token keyword">DESC</span><span class="token punctuation">;</span>

<span class="token comment">-- 整理碎片</span>
<span class="token keyword">OPTIMIZE</span> <span class="token keyword">TABLE</span> users<span class="token punctuation">;</span>
<span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> users <span class="token keyword">ENGINE</span><span class="token operator">=</span><span class="token keyword">InnoDB</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h3 id="2-索引统计信息过期"><a href="#2-索引统计信息过期" class="headerlink" title="2. 索引统计信息过期"></a>2. 索引统计信息过期</h3><figure><div class="code-wrapper"><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">-- 更新统计信息</span>
<span class="token keyword">ANALYZE</span> <span class="token keyword">TABLE</span> users<span class="token punctuation">;</span>

<span class="token comment">-- 查看统计信息更新时间</span>
<span class="token keyword">SELECT</span> 
    TABLE_NAME<span class="token punctuation">,</span>
    UPDATE_TIME<span class="token punctuation">,</span>
    TABLE_ROWS<span class="token punctuation">,</span>
    AVG_ROW_LENGTH
<span class="token keyword">FROM</span> information_schema<span class="token punctuation">.</span><span class="token keyword">TABLES</span> 
<span class="token keyword">WHERE</span> TABLE_SCHEMA <span class="token operator">=</span> <span class="token string">'your_database'</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h1 id="八、不同数据库的索引特性"><a href="#八、不同数据库的索引特性" class="headerlink" title="八、不同数据库的索引特性"></a>八、不同数据库的索引特性</h1><h2 id="（一）MySQL索引特性"><a href="#（一）MySQL索引特性" class="headerlink" title="（一）MySQL索引特性"></a>（一）MySQL索引特性</h2><h3 id="1-InnoDB存储引擎"><a href="#1-InnoDB存储引擎" class="headerlink" title="1. InnoDB存储引擎"></a>1. InnoDB存储引擎</h3><figure><div class="code-wrapper"><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">-- InnoDB特性</span>
<span class="token comment">-- 1. 聚簇索引：主键索引包含完整行数据</span>
<span class="token comment">-- 2. 二级索引：包含主键值，需要回表查询</span>
<span class="token comment">-- 3. 支持外键约束</span>
<span class="token comment">-- 4. 支持事务</span>

<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> innodb_test <span class="token punctuation">(</span>
    id <span class="token keyword">INT</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span><span class="token punctuation">,</span>
    name <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    age <span class="token keyword">INT</span><span class="token punctuation">,</span>
    <span class="token keyword">INDEX</span> idx_name <span class="token punctuation">(</span>name<span class="token punctuation">)</span>
<span class="token punctuation">)</span> <span class="token keyword">ENGINE</span><span class="token operator">=</span><span class="token keyword">InnoDB</span><span class="token punctuation">;</span>

<span class="token comment">-- 查看InnoDB索引信息</span>
<span class="token keyword">SHOW</span> <span class="token keyword">TABLE</span> <span class="token keyword">STATUS</span> <span class="token operator">LIKE</span> <span class="token string">'innodb_test'</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h3 id="2-MyISAM存储引擎"><a href="#2-MyISAM存储引擎" class="headerlink" title="2. MyISAM存储引擎"></a>2. MyISAM存储引擎</h3><figure><div class="code-wrapper"><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">-- MyISAM特性</span>
<span class="token comment">-- 1. 非聚簇索引：所有索引都指向数据行的物理位置</span>
<span class="token comment">-- 2. 不支持事务</span>
<span class="token comment">-- 3. 表级锁</span>
<span class="token comment">-- 4. 压缩表支持</span>

<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> myisam_test <span class="token punctuation">(</span>
    id <span class="token keyword">INT</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span><span class="token punctuation">,</span>
    name <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    age <span class="token keyword">INT</span><span class="token punctuation">,</span>
    <span class="token keyword">INDEX</span> idx_name <span class="token punctuation">(</span>name<span class="token punctuation">)</span>
<span class="token punctuation">)</span> <span class="token keyword">ENGINE</span><span class="token operator">=</span>MyISAM<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h3 id="3-Memory存储引擎"><a href="#3-Memory存储引擎" class="headerlink" title="3. Memory存储引擎"></a>3. Memory存储引擎</h3><figure><div class="code-wrapper"><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">-- Memory引擎特性</span>
<span class="token comment">-- 1. 数据存储在内存中</span>
<span class="token comment">-- 2. 支持哈希索引和B+树索引</span>
<span class="token comment">-- 3. 重启后数据丢失</span>

<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> memory_test <span class="token punctuation">(</span>
    id <span class="token keyword">INT</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span><span class="token punctuation">,</span>
    code <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword">INDEX</span> <span class="token keyword">USING</span> <span class="token keyword">HASH</span> <span class="token punctuation">(</span>code<span class="token punctuation">)</span>
<span class="token punctuation">)</span> <span class="token keyword">ENGINE</span><span class="token operator">=</span>MEMORY<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h2 id="（二）PostgreSQL索引特性"><a href="#（二）PostgreSQL索引特性" class="headerlink" title="（二）PostgreSQL索引特性"></a>（二）PostgreSQL索引特性</h2><h3 id="1-多种索引类型"><a href="#1-多种索引类型" class="headerlink" title="1. 多种索引类型"></a>1. 多种索引类型</h3><figure><div class="code-wrapper"><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">-- B-tree索引（默认）</span>
<span class="token keyword">CREATE</span> <span class="token keyword">INDEX</span> idx_user_age <span class="token keyword">ON</span> users<span class="token punctuation">(</span>age<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 哈希索引</span>
<span class="token keyword">CREATE</span> <span class="token keyword">INDEX</span> idx_user_code <span class="token keyword">ON</span> users<span class="token punctuation">(</span>code<span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token keyword">HASH</span><span class="token punctuation">;</span>

<span class="token comment">-- GIN索引（用于数组、全文搜索）</span>
<span class="token keyword">CREATE</span> <span class="token keyword">INDEX</span> idx_user_tags <span class="token keyword">ON</span> users <span class="token keyword">USING</span> GIN<span class="token punctuation">(</span>tags<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- GiST索引（用于几何数据）</span>
<span class="token keyword">CREATE</span> <span class="token keyword">INDEX</span> idx_location <span class="token keyword">ON</span> places <span class="token keyword">USING</span> GIST<span class="token punctuation">(</span>location<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 部分索引</span>
<span class="token keyword">CREATE</span> <span class="token keyword">INDEX</span> idx_active_users <span class="token keyword">ON</span> users<span class="token punctuation">(</span>name<span class="token punctuation">)</span> <span class="token keyword">WHERE</span> <span class="token keyword">status</span> <span class="token operator">=</span> <span class="token string">'active'</span><span class="token punctuation">;</span>

<span class="token comment">-- 表达式索引</span>
<span class="token keyword">CREATE</span> <span class="token keyword">INDEX</span> idx_lower_email <span class="token keyword">ON</span> users<span class="token punctuation">(</span>lower<span class="token punctuation">(</span>email<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h3 id="2-高级索引功能"><a href="#2-高级索引功能" class="headerlink" title="2. 高级索引功能"></a>2. 高级索引功能</h3><figure><div class="code-wrapper"><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">-- 并发创建索引</span>
<span class="token keyword">CREATE</span> <span class="token keyword">INDEX</span> CONCURRENTLY idx_user_email <span class="token keyword">ON</span> users<span class="token punctuation">(</span>email<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 条件索引</span>
<span class="token keyword">CREATE</span> <span class="token keyword">INDEX</span> idx_recent_orders <span class="token keyword">ON</span> orders<span class="token punctuation">(</span>created_at<span class="token punctuation">)</span> 
<span class="token keyword">WHERE</span> created_at <span class="token operator">></span> <span class="token string">'2023-01-01'</span><span class="token punctuation">;</span>

<span class="token comment">-- 多列部分索引</span>
<span class="token keyword">CREATE</span> <span class="token keyword">INDEX</span> idx_active_user_city <span class="token keyword">ON</span> users<span class="token punctuation">(</span>city<span class="token punctuation">)</span> 
<span class="token keyword">WHERE</span> <span class="token keyword">status</span> <span class="token operator">=</span> <span class="token string">'active'</span> <span class="token operator">AND</span> age <span class="token operator">></span> <span class="token number">18</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h2 id="（三）Oracle索引特性"><a href="#（三）Oracle索引特性" class="headerlink" title="（三）Oracle索引特性"></a>（三）Oracle索引特性</h2><h3 id="1-索引类型"><a href="#1-索引类型" class="headerlink" title="1. 索引类型"></a>1. 索引类型</h3><figure><div class="code-wrapper"><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">-- B-tree索引</span>
<span class="token keyword">CREATE</span> <span class="token keyword">INDEX</span> idx_emp_salary <span class="token keyword">ON</span> employees<span class="token punctuation">(</span>salary<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 位图索引</span>
<span class="token keyword">CREATE</span> BITMAP <span class="token keyword">INDEX</span> idx_emp_dept <span class="token keyword">ON</span> employees<span class="token punctuation">(</span>department_id<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 函数索引</span>
<span class="token keyword">CREATE</span> <span class="token keyword">INDEX</span> idx_emp_upper_name <span class="token keyword">ON</span> employees<span class="token punctuation">(</span>UPPER<span class="token punctuation">(</span>last_name<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 反向键索引</span>
<span class="token keyword">CREATE</span> <span class="token keyword">INDEX</span> idx_emp_id <span class="token keyword">ON</span> employees<span class="token punctuation">(</span>employee_id<span class="token punctuation">)</span> REVERSE<span class="token punctuation">;</span>

<span class="token comment">-- 分区索引</span>
<span class="token keyword">CREATE</span> <span class="token keyword">INDEX</span> idx_sales_date <span class="token keyword">ON</span> sales<span class="token punctuation">(</span>sale_date<span class="token punctuation">)</span> <span class="token keyword">LOCAL</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h3 id="2-索引组织表"><a href="#2-索引组织表" class="headerlink" title="2. 索引组织表"></a>2. 索引组织表</h3><figure><div class="code-wrapper"><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">-- 索引组织表（IOT）</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> iot_table <span class="token punctuation">(</span>
    id NUMBER <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span><span class="token punctuation">,</span>
    name VARCHAR2<span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword">data</span> VARCHAR2<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span> ORGANIZATION <span class="token keyword">INDEX</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h1 id="九、索引的未来发展"><a href="#九、索引的未来发展" class="headerlink" title="九、索引的未来发展"></a>九、索引的未来发展</h1><h2 id="（一）新兴索引技术"><a href="#（一）新兴索引技术" class="headerlink" title="（一）新兴索引技术"></a>（一）新兴索引技术</h2><h3 id="1-列式存储索引"><a href="#1-列式存储索引" class="headerlink" title="1. 列式存储索引"></a>1. 列式存储索引</h3><p>列式存储数据库（如ClickHouse、Apache Parquet）中的索引技术：</p>
<ul>
<li><strong>稀疏索引</strong>：只为部分数据块创建索引</li>
<li><strong>跳跃索引</strong>：基于数据分布的轻量级索引</li>
<li><strong>布隆过滤器</strong>：快速判断数据是否存在</li>
</ul>
<h3 id="2-机器学习索引"><a href="#2-机器学习索引" class="headerlink" title="2. 机器学习索引"></a>2. 机器学习索引</h3><ul>
<li><strong>学习型索引</strong>：使用机器学习模型预测数据位置</li>
<li><strong>自适应索引</strong>：根据查询模式自动调整索引结构</li>
<li><strong>智能索引推荐</strong>：基于工作负载自动推荐索引</li>
</ul>
<h3 id="3-内存计算索引"><a href="#3-内存计算索引" class="headerlink" title="3. 内存计算索引"></a>3. 内存计算索引</h3><ul>
<li><strong>内存原生索引</strong>：专为内存数据库设计的索引结构</li>
<li><strong>NUMA感知索引</strong>：考虑NUMA架构的索引设计</li>
<li><strong>并行索引</strong>：支持高并发的无锁索引结构</li>
</ul>
<h2 id="（二）云原生索引"><a href="#（二）云原生索引" class="headerlink" title="（二）云原生索引"></a>（二）云原生索引</h2><h3 id="1-分布式索引"><a href="#1-分布式索引" class="headerlink" title="1. 分布式索引"></a>1. 分布式索引</h3><figure><div class="code-wrapper"><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">-- 分片索引示例（概念性）</span>
<span class="token comment">-- 数据按用户ID分片</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> users_shard_1 <span class="token punctuation">(</span>
    id <span class="token keyword">BIGINT</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span><span class="token punctuation">,</span>
    name <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword">INDEX</span> idx_name <span class="token punctuation">(</span>name<span class="token punctuation">)</span>
<span class="token punctuation">)</span> <span class="token comment">-- 存储在节点1</span>

<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> users_shard_2 <span class="token punctuation">(</span>
    id <span class="token keyword">BIGINT</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span><span class="token punctuation">,</span>
    name <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword">INDEX</span> idx_name <span class="token punctuation">(</span>name<span class="token punctuation">)</span>
<span class="token punctuation">)</span> <span class="token comment">-- 存储在节点2</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h3 id="2-弹性索引"><a href="#2-弹性索引" class="headerlink" title="2. 弹性索引"></a>2. 弹性索引</h3><ul>
<li><strong>动态扩缩容</strong>：根据负载自动调整索引资源</li>
<li><strong>热点数据识别</strong>：自动识别并优化热点数据的索引</li>
<li><strong>跨区域复制</strong>：索引的地理分布和一致性</li>
</ul>
<h2 id="（三）性能优化趋势"><a href="#（三）性能优化趋势" class="headerlink" title="（三）性能优化趋势"></a>（三）性能优化趋势</h2><h3 id="1-硬件加速"><a href="#1-硬件加速" class="headerlink" title="1. 硬件加速"></a>1. 硬件加速</h3><ul>
<li><strong>GPU加速索引</strong>：利用GPU并行计算能力</li>
<li><strong>FPGA索引</strong>：专用硬件加速索引操作</li>
<li><strong>NVMe优化</strong>：针对高速存储的索引优化</li>
</ul>
<h3 id="2-智能化管理"><a href="#2-智能化管理" class="headerlink" title="2. 智能化管理"></a>2. 智能化管理</h3><ul>
<li><strong>自动索引调优</strong>：AI驱动的索引优化</li>
<li><strong>预测性维护</strong>：提前预测索引性能问题</li>
<li><strong>智能监控</strong>：实时监控索引健康状态</li>
</ul>
<h1 id="十、学习建议与总结"><a href="#十、学习建议与总结" class="headerlink" title="十、学习建议与总结"></a>十、学习建议与总结</h1><h2 id="（一）学习路径建议"><a href="#（一）学习路径建议" class="headerlink" title="（一）学习路径建议"></a>（一）学习路径建议</h2><h3 id="1-基础阶段"><a href="#1-基础阶段" class="headerlink" title="1. 基础阶段"></a>1. 基础阶段</h3><ol>
<li><p><strong>理解数据结构基础</strong></p>
<ul>
<li>B+树、哈希表、位图等数据结构</li>
<li>时间复杂度和空间复杂度分析</li>
<li>数据库存储原理</li>
</ul>
</li>
<li><p><strong>掌握索引基本概念</strong></p>
<ul>
<li>索引的作用和原理</li>
<li>不同类型索引的特点</li>
<li>索引的创建和删除</li>
</ul>
</li>
<li><p><strong>实践基本操作</strong></p>
<ul>
<li>创建各种类型的索引</li>
<li>使用EXPLAIN分析查询计划</li>
<li>监控索引使用情况</li>
</ul>
</li>
</ol>
<h3 id="2-进阶阶段"><a href="#2-进阶阶段" class="headerlink" title="2. 进阶阶段"></a>2. 进阶阶段</h3><ol>
<li><p><strong>索引设计优化</strong></p>
<ul>
<li>复合索引的设计原则</li>
<li>索引覆盖和回表优化</li>
<li>索引选择性分析</li>
</ul>
</li>
<li><p><strong>性能调优实践</strong></p>
<ul>
<li>慢查询分析和优化</li>
<li>索引失效问题排查</li>
<li>索引维护和碎片整理</li>
</ul>
</li>
<li><p><strong>高级特性应用</strong></p>
<ul>
<li>分区表索引</li>
<li>函数索引和条件索引</li>
<li>全文索引应用</li>
</ul>
</li>
</ol>
<h3 id="3-专家阶段"><a href="#3-专家阶段" class="headerlink" title="3. 专家阶段"></a>3. 专家阶段</h3><ol>
<li><p><strong>企业级应用</strong></p>
<ul>
<li>大规模数据库索引设计</li>
<li>分布式索引架构</li>
<li>索引监控和自动化管理</li>
</ul>
</li>
<li><p><strong>新技术探索</strong></p>
<ul>
<li>列式存储索引</li>
<li>机器学习索引</li>
<li>云原生索引技术</li>
</ul>
</li>
</ol>
<h2 id="（二）实践项目建议"><a href="#（二）实践项目建议" class="headerlink" title="（二）实践项目建议"></a>（二）实践项目建议</h2><h3 id="1-个人博客系统"><a href="#1-个人博客系统" class="headerlink" title="1. 个人博客系统"></a>1. 个人博客系统</h3><p><strong>项目目标：</strong></p>
<ul>
<li>设计博客文章的索引策略</li>
<li>实现全文搜索功能</li>
<li>优化标签和分类查询</li>
</ul>
<p><strong>技术要点：</strong></p>
<ul>
<li>文章表索引设计</li>
<li>全文索引应用</li>
<li>复合索引优化</li>
</ul>
<h3 id="2-电商商品搜索系统"><a href="#2-电商商品搜索系统" class="headerlink" title="2. 电商商品搜索系统"></a>2. 电商商品搜索系统</h3><p><strong>项目目标：</strong></p>
<ul>
<li>实现商品多维度搜索</li>
<li>优化价格区间查询</li>
<li>支持商品推荐功能</li>
</ul>
<p><strong>技术要点：</strong></p>
<ul>
<li>多列索引设计</li>
<li>范围查询优化</li>
<li>索引覆盖应用</li>
</ul>
<h3 id="3-日志分析系统"><a href="#3-日志分析系统" class="headerlink" title="3. 日志分析系统"></a>3. 日志分析系统</h3><p><strong>项目目标：</strong></p>
<ul>
<li>处理大量日志数据</li>
<li>实现实时查询分析</li>
<li>优化时间序列查询</li>
</ul>
<p><strong>技术要点：</strong></p>
<ul>
<li>分区表索引</li>
<li>时间序列优化</li>
<li>索引维护策略</li>
</ul>
<h2 id="（三）常用工具推荐"><a href="#（三）常用工具推荐" class="headerlink" title="（三）常用工具推荐"></a>（三）常用工具推荐</h2><h3 id="1-性能分析工具"><a href="#1-性能分析工具" class="headerlink" title="1. 性能分析工具"></a>1. 性能分析工具</h3><ul>
<li><strong>MySQL Workbench</strong>：图形化数据库管理</li>
<li><strong>pt-query-digest</strong>：慢查询分析工具</li>
<li><strong>MySQLTuner</strong>：MySQL性能调优建议</li>
<li><strong>Percona Toolkit</strong>：MySQL性能工具集</li>
</ul>
<h3 id="2-监控工具"><a href="#2-监控工具" class="headerlink" title="2. 监控工具"></a>2. 监控工具</h3><ul>
<li><strong>Prometheus + Grafana</strong>：监控和可视化</li>
<li><strong>MySQL Enterprise Monitor</strong>：官方监控工具</li>
<li>**PMM (Percona Monitoring)**：开源监控解决方案</li>
</ul>
<h3 id="3-开发工具"><a href="#3-开发工具" class="headerlink" title="3. 开发工具"></a>3. 开发工具</h3><ul>
<li><strong>DataGrip</strong>：专业数据库IDE</li>
<li><strong>Sequel Pro</strong>：Mac平台数据库工具</li>
<li><strong>phpMyAdmin</strong>：Web界面管理工具</li>
</ul>
<h2 id="（四）总结"><a href="#（四）总结" class="headerlink" title="（四）总结"></a>（四）总结</h2><p>索引是数据库性能优化的核心技术，通过本文的学习，我们了解了：</p>
<ol>
<li><strong>索引的基本原理和数据结构</strong></li>
<li><strong>不同类型索引的特点和适用场景</strong></li>
<li><strong>索引的创建、管理和维护方法</strong></li>
<li><strong>索引优化的策略和最佳实践</strong></li>
<li><strong>常见问题的诊断和解决方案</strong></li>
<li><strong>不同数据库系统的索引特性</strong></li>
<li><strong>索引技术的发展趋势</strong></li>
</ol>
<p>在实际应用中，索引优化需要结合具体的业务场景和数据特点：</p>
<ul>
<li><strong>OLTP系统</strong>：注重事务处理性能，索引设计要平衡查询和更新性能</li>
<li><strong>OLAP系统</strong>：注重查询分析性能，可以创建更多的索引来优化复杂查询</li>
<li><strong>混合负载</strong>：需要综合考虑各种操作的性能影响</li>
</ul>
<p>索引优化是一个持续的过程，需要根据业务发展和数据增长不断调整。掌握索引技术不仅能够显著提升数据库性能，还能为系统架构设计提供重要支撑。随着大数据和云计算技术的发展，索引技术也在不断演进，学习和掌握这些新技术将有助于应对未来的挑战。</p>
<h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><ol>
<li><a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/optimization-indexes.html">MySQL官方文档 - 索引</a></li>
<li><a target="_blank" rel="noopener" href="https://www.postgresql.org/docs/current/indexes.html">PostgreSQL官方文档 - 索引</a></li>
<li><a target="_blank" rel="noopener" href="https://docs.oracle.com/en/database/oracle/oracle-database/">Oracle数据库索引指南</a></li>
<li><a target="_blank" rel="noopener" href="https://www.oreilly.com/library/view/high-performance-mysql/9781449332471/">《高性能MySQL》- Baron Schwartz</a></li>
<li><a target="_blank" rel="noopener" href="https://www.db-book.com/">《数据库系统概念》- Abraham Silberschatz</a></li>
<li><a target="_blank" rel="noopener" href="https://www.percona.com/blog/">MySQL性能调优最佳实践</a></li>
<li><a target="_blank" rel="noopener" href="https://use-the-index-luke.com/">数据库索引设计与优化</a></li>
<li><a target="_blank" rel="noopener" href="https://www.vldb.org/">现代数据库系统架构</a></li>
</ol>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/" class="category-chain-item">数据库</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/" class="print-no-link">#数据库</a>
      
        <a href="/tags/MySQL/" class="print-no-link">#MySQL</a>
      
        <a href="/tags/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/" class="print-no-link">#性能优化</a>
      
        <a href="/tags/%E7%B4%A2%E5%BC%95/" class="print-no-link">#索引</a>
      
        <a href="/tags/SQL/" class="print-no-link">#SQL</a>
      
    </div>
  
</div>


              

              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2025/07/15/%E3%80%90%E5%8D%9A%E5%AE%A2%E3%80%91%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BAHexo%E5%8D%9A%E5%AE%A2%E7%BD%91%E7%AB%99/" title="【博客】搭建个人Hexo博客网站">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">【博客】搭建个人Hexo博客网站</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2025/07/15/%E3%80%90%E5%AD%A6%E4%B9%A0%E3%80%91%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E5%BC%80%E5%8F%91%E6%8C%87%E5%8D%97%EF%BC%9A%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84%E5%AE%8C%E6%95%B4%E5%AE%9E%E8%B7%B5/" title="【学习】微信小程序开发指南：从零开始的完整实践">
                        <span class="hidden-mobile">【学习】微信小程序开发指南：从零开始的完整实践</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>目录</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
    <div class="statistics">
  
  

  
    
      <span id="busuanzi_container_site_pv" style="display: none">
        总访问量 
        <span id="busuanzi_value_site_pv"></span>
         次
      </span>
    
    
      <span id="busuanzi_container_site_uv" style="display: none">
        总访客数 
        <span id="busuanzi_value_site_uv"></span>
         人
      </span>
    
    

  

</div>

  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script  src="https://lib.baomitu.com/prism/1.29.0/plugins/line-numbers/prism-line-numbers.min.js" ></script>

  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/5.0.0/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>

  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>




  
<script src="/js/custom.js"></script>
<script src="/js/ai-assistant.js"></script>
<script src="https://cdn.jsdelivr.net/npm/mermaid@9.4.0/dist/mermaid.min.js"></script>



<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
</body>
</html>
