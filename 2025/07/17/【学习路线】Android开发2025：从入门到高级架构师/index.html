

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">

  <link rel="apple-touch-icon" sizes="76x76" href="/img/fluid.png">
  <link rel="icon" href="https://cdn.jsdelivr.net/gh/uwakeme/cdn@main/img/favicon.png">
  

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
    <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="Wake">
  <meta name="keywords" content="技术博客, Web开发, 后端开发, Java, Python, 人工智能, 编程学习, 技术分享">
  
    <meta name="description" content="前言Android开发作为移动应用开发的核心领域，经历了从Java到Kotlin、从XML布局到Jetpack Compose的巨大变革。2025年的Android开发已经进入了全新的时代，本学习路线将带你从入门到高级架构师，掌握最新的技术栈和最佳实践。 一、Android开发基础阶段（一）开发环境搭建1.1 开发工具安装# Android Studio安装 # 1. 下载地址：https:&#x2F;&#x2F;d">
<meta property="og:type" content="article">
<meta property="og:title" content="【学习路线】Android开发2025：从入门到高级架构师">
<meta property="og:url" content="https://uwakeme.top/2025/07/17/%E3%80%90%E5%AD%A6%E4%B9%A0%E8%B7%AF%E7%BA%BF%E3%80%91Android%E5%BC%80%E5%8F%912025%EF%BC%9A%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E9%AB%98%E7%BA%A7%E6%9E%B6%E6%9E%84%E5%B8%88/index.html">
<meta property="og:site_name" content="Uwakeme">
<meta property="og:description" content="前言Android开发作为移动应用开发的核心领域，经历了从Java到Kotlin、从XML布局到Jetpack Compose的巨大变革。2025年的Android开发已经进入了全新的时代，本学习路线将带你从入门到高级架构师，掌握最新的技术栈和最佳实践。 一、Android开发基础阶段（一）开发环境搭建1.1 开发工具安装# Android Studio安装 # 1. 下载地址：https:&#x2F;&#x2F;d">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2025-07-16T16:00:00.000Z">
<meta property="article:modified_time" content="2025-07-17T10:15:21.985Z">
<meta property="article:author" content="Wake">
<meta property="article:tag" content="移动开发">
<meta property="article:tag" content="Android">
<meta property="article:tag" content="学习路线">
<meta property="article:tag" content="Kotlin">
<meta property="article:tag" content="Jetpack Compose">
<meta property="article:tag" content="架构师">
<meta name="twitter:card" content="summary_large_image">
  
  
    <meta name="referrer" content="no-referrer-when-downgrade">
  
  
  <title>【学习路线】Android开发2025：从入门到高级架构师 - Uwakeme</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/prism/1.29.0/plugins/line-numbers/prism-line-numbers.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1749284_5i9bdhy70f8.css">



<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1736178_k526ubmyhba.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  



  
<link rel="stylesheet" href="//at.alicdn.com/t/c/font_3846514_kabxni94auf.css">
<link rel="stylesheet" href="/css/custom.css">
<link rel="stylesheet" href="/css/ai-assistant.css">



  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"uwakeme.top","root":"/","version":"1.9.8","typing":{"enable":true,"typeSpeed":70,"cursorChar":"|","loop":false,"scope":[],"backSpeed":40,"showCursor":true},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"right","visible":"hover","icon":"#"},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100},"position_indicator":{"enable":true,"color":"#33a3dc"}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""],"img_max_width":"80%","img_max_height":"80%"},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0,"level":3,"collapse":false,"follow":true,"number":true,"heading_list":true,"expand_all":true},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2,"element_loading_img":true},"web_analytics":{"enable":true,"follow_dnt":true,"baidu":"41fc030db57d5570dd22f78997dc4a7e","google":{"measurement_id":null},"tencent":{"sid":null,"cid":null},"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false},"umami":{"src":null,"website_id":null,"domains":null,"start_time":"2024-01-01T00:00:00.000Z","token":null,"api_server":null},"busuanzi":{"enable":true,"script_url":"//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js","site_uv":true,"site_pv":true,"page_pv":true}},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  

  
    <!-- Baidu Analytics -->
    <script async>
      if (!Fluid.ctx.dnt) {
        var _hmt = _hmt || [];
        (function() {
          var hm = document.createElement("script");
          hm.src = "https://hm.baidu.com/hm.js?41fc030db57d5570dd22f78997dc4a7e";
          var s = document.getElementsByTagName("script")[0];
          s.parentNode.insertBefore(hm, s);
        })();
      }
    </script>
  

  

  

  

  



  
<meta name="generator" content="Hexo 7.3.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>Wake 的博客</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/" target="_self">
                <i class="iconfont icon-home-fill"></i>
                <span>首页</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives" target="_self">
                <i class="iconfont icon-books"></i>
                <span>归档</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories" target="_self">
                <i class="iconfont icon-th-large"></i>
                <span>分类</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/" target="_self">
                <i class="iconfont icon-tags-fill"></i>
                <span>标签</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/" target="_self">
                <i class="iconfont icon-user-fill"></i>
                <span>关于</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/links/" target="_self">
                <i class="iconfont icon-link-fill"></i>
                <span>友链</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" target="_self" href="javascript:;" role="button"
                 data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                <i class="iconfont icon-book"></i>
                <span>文档</span>
              </a>
              <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                
                  
                  
                  
                  <a class="dropdown-item" href="https://hexo.fluid-dev.com/" target="_self">
                    
                    <span>主题博客</span>
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="https://hexo.fluid-dev.com/docs/guide/" target="_self">
                    
                    <span>配置指南</span>
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="https://hexo.fluid-dev.com/docs/icon/" target="_self">
                    
                    <span>图标用法</span>
                  </a>
                
              </div>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/default.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="【学习路线】Android开发2025：从入门到高级架构师"></span>
          
        </div>

        
          
  <div class="mt-3">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-author" aria-hidden="true"></i>
        Wake
      </span>
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2025-07-17 00:00" pubdate>
          2025-07-17 00:00
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          <!-- compatible with older versions-->
          3.2k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          <!-- compatible with older versions-->
          27 分钟
        
      </span>
    

    
    
      
        <span id="busuanzi_container_page_pv" style="display: none">
          <i class="iconfont icon-eye" aria-hidden="true"></i>
          <span id="busuanzi_value_page_pv"></span> 次
        </span>
        

      
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">【学习路线】Android开发2025：从入门到高级架构师</h1>
            
            
              <div class="markdown-body">
                
                <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>Android开发作为移动应用开发的核心领域，经历了从Java到Kotlin、从XML布局到Jetpack Compose的巨大变革。2025年的Android开发已经进入了全新的时代，本学习路线将带你从入门到高级架构师，掌握最新的技术栈和最佳实践。</p>
<h2 id="一、Android开发基础阶段"><a href="#一、Android开发基础阶段" class="headerlink" title="一、Android开发基础阶段"></a>一、Android开发基础阶段</h2><h3 id="（一）开发环境搭建"><a href="#（一）开发环境搭建" class="headerlink" title="（一）开发环境搭建"></a>（一）开发环境搭建</h3><h4 id="1-1-开发工具安装"><a href="#1-1-开发工具安装" class="headerlink" title="1.1 开发工具安装"></a>1.1 开发工具安装</h4><figure><div class="code-wrapper"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># Android Studio安装</span>
<span class="token comment"># 1. 下载地址：https://developer.android.com/studio</span>
<span class="token comment"># 2. 推荐版本：Android Studio Hedgehog | 2023.1.1</span>
<span class="token comment"># 3. 系统要求：</span>
<span class="token comment">#    - Windows 10/11 64位</span>
<span class="token comment">#    - macOS 10.14 (Mojave) 或更高</span>
<span class="token comment">#    - Ubuntu 14.04 LTS 或更高</span>

<span class="token comment"># SDK配置</span>
<span class="token comment"># 1. Android SDK Platform 34</span>
<span class="token comment"># 2. Android SDK Build-Tools 34.0.0</span>
<span class="token comment"># 3. Android Emulator</span>
<span class="token comment"># 4. Android SDK Platform-Tools</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h4 id="1-2-第一个Android应用"><a href="#1-2-第一个Android应用" class="headerlink" title="1.2 第一个Android应用"></a>1.2 第一个Android应用</h4><figure><div class="code-wrapper"><pre class="line-numbers language-kotlin" data-language="kotlin"><code class="language-kotlin"><span class="token comment">// MainActivity.kt</span>
<span class="token keyword">class</span> MainActivity <span class="token operator">:</span> <span class="token function">ComponentActivity</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">override</span> <span class="token keyword">fun</span> <span class="token function">onCreate</span><span class="token punctuation">(</span>savedInstanceState<span class="token operator">:</span> Bundle<span class="token operator">?</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">onCreate</span><span class="token punctuation">(</span>savedInstanceState<span class="token punctuation">)</span>
        setContent <span class="token punctuation">&#123;</span>
            MyApplicationTheme <span class="token punctuation">&#123;</span>
                <span class="token function">Surface</span><span class="token punctuation">(</span>
                    modifier <span class="token operator">=</span> Modifier<span class="token punctuation">.</span><span class="token function">fillMaxSize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                    color <span class="token operator">=</span> MaterialTheme<span class="token punctuation">.</span>colorScheme<span class="token punctuation">.</span>background
                <span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                    <span class="token function">Greeting</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"Android"</span></span><span class="token punctuation">)</span>
                <span class="token punctuation">&#125;</span>
            <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token annotation builtin">@Composable</span>
<span class="token keyword">fun</span> <span class="token function">Greeting</span><span class="token punctuation">(</span>name<span class="token operator">:</span> String<span class="token punctuation">,</span> modifier<span class="token operator">:</span> Modifier <span class="token operator">=</span> Modifier<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token function">Text</span><span class="token punctuation">(</span>
        text <span class="token operator">=</span> <span class="token string-literal singleline"><span class="token string">"Hello </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$</span><span class="token expression">name</span></span><span class="token string">!"</span></span><span class="token punctuation">,</span>
        modifier <span class="token operator">=</span> modifier
    <span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h3 id="（二）Kotlin语言基础"><a href="#（二）Kotlin语言基础" class="headerlink" title="（二）Kotlin语言基础"></a>（二）Kotlin语言基础</h3><h4 id="2-1-Kotlin核心语法"><a href="#2-1-Kotlin核心语法" class="headerlink" title="2.1 Kotlin核心语法"></a>2.1 Kotlin核心语法</h4><figure><div class="code-wrapper"><pre class="line-numbers language-kotlin" data-language="kotlin"><code class="language-kotlin"><span class="token comment">// 数据类</span>
<span class="token keyword">data</span> <span class="token keyword">class</span> <span class="token function">User</span><span class="token punctuation">(</span>
    <span class="token keyword">val</span> id<span class="token operator">:</span> Int<span class="token punctuation">,</span>
    <span class="token keyword">val</span> name<span class="token operator">:</span> String<span class="token punctuation">,</span>
    <span class="token keyword">val</span> email<span class="token operator">:</span> String
<span class="token punctuation">)</span>

<span class="token comment">// 扩展函数</span>
<span class="token keyword">fun</span> String<span class="token punctuation">.</span><span class="token function">isEmailValid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> Boolean <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> android<span class="token punctuation">.</span>util<span class="token punctuation">.</span>Patterns<span class="token punctuation">.</span>EMAIL_ADDRESS<span class="token punctuation">.</span><span class="token function">matcher</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">matches</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// 协程基础</span>
<span class="token keyword">suspend</span> <span class="token keyword">fun</span> <span class="token function">fetchUserData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> List<span class="token operator">&lt;</span>User<span class="token operator">></span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token function">withContext</span><span class="token punctuation">(</span>Dispatchers<span class="token punctuation">.</span>IO<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token comment">// 模拟网络请求</span>
        <span class="token function">delay</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span>
        <span class="token function">listOf</span><span class="token punctuation">(</span>
            <span class="token function">User</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string-literal singleline"><span class="token string">"张三"</span></span><span class="token punctuation">,</span> <span class="token string-literal singleline"><span class="token string">"zhangsan@example.com"</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token function">User</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string-literal singleline"><span class="token string">"李四"</span></span><span class="token punctuation">,</span> <span class="token string-literal singleline"><span class="token string">"lisi@example.com"</span></span><span class="token punctuation">)</span>
        <span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h4 id="2-2-Kotlin高阶函数"><a href="#2-2-Kotlin高阶函数" class="headerlink" title="2.2 Kotlin高阶函数"></a>2.2 Kotlin高阶函数</h4><figure><div class="code-wrapper"><pre class="line-numbers language-kotlin" data-language="kotlin"><code class="language-kotlin"><span class="token comment">// 函数式编程</span>
<span class="token keyword">val</span> numbers <span class="token operator">=</span> <span class="token function">listOf</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span>
<span class="token keyword">val</span> doubled <span class="token operator">=</span> numbers<span class="token punctuation">.</span><span class="token function">map</span> <span class="token punctuation">&#123;</span> it <span class="token operator">*</span> <span class="token number">2</span> <span class="token punctuation">&#125;</span>
<span class="token keyword">val</span> sum <span class="token operator">=</span> numbers<span class="token punctuation">.</span><span class="token function">reduce</span> <span class="token punctuation">&#123;</span> acc<span class="token punctuation">,</span> i <span class="token operator">-></span> acc <span class="token operator">+</span> i <span class="token punctuation">&#125;</span>

<span class="token comment">// DSL构建器</span>
<span class="token keyword">class</span> AlertDialogBuilder <span class="token punctuation">&#123;</span>
    <span class="token keyword">var</span> title<span class="token operator">:</span> String <span class="token operator">=</span> <span class="token string-literal singleline"><span class="token string">""</span></span>
    <span class="token keyword">var</span> message<span class="token operator">:</span> String <span class="token operator">=</span> <span class="token string-literal singleline"><span class="token string">""</span></span>
    <span class="token keyword">var</span> positiveButton<span class="token operator">:</span> String <span class="token operator">=</span> <span class="token string-literal singleline"><span class="token string">""</span></span>
    <span class="token keyword">var</span> onPositiveClick<span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-></span> Unit <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>
    
    <span class="token keyword">fun</span> <span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> AlertDialog <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> AlertDialog<span class="token punctuation">.</span><span class="token function">Builder</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">setTitle</span><span class="token punctuation">(</span>title<span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">setMessage</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">setPositiveButton</span><span class="token punctuation">(</span>positiveButton<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> _<span class="token punctuation">,</span> _ <span class="token operator">-></span> <span class="token function">onPositiveClick</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#125;</span>
            <span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h3 id="（三）Android核心组件"><a href="#（三）Android核心组件" class="headerlink" title="（三）Android核心组件"></a>（三）Android核心组件</h3><h4 id="3-1-Activity与Fragment"><a href="#3-1-Activity与Fragment" class="headerlink" title="3.1 Activity与Fragment"></a>3.1 Activity与Fragment</h4><figure><div class="code-wrapper"><pre class="line-numbers language-kotlin" data-language="kotlin"><code class="language-kotlin"><span class="token comment">// 现代Activity实现</span>
<span class="token keyword">class</span> MainActivity <span class="token operator">:</span> <span class="token function">ComponentActivity</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">private</span> <span class="token keyword">val</span> viewModel<span class="token operator">:</span> MainViewModel <span class="token keyword">by</span> <span class="token function">viewModels</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    
    <span class="token keyword">override</span> <span class="token keyword">fun</span> <span class="token function">onCreate</span><span class="token punctuation">(</span>savedInstanceState<span class="token operator">:</span> Bundle<span class="token operator">?</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">onCreate</span><span class="token punctuation">(</span>savedInstanceState<span class="token punctuation">)</span>
        
        setContent <span class="token punctuation">&#123;</span>
            MyAppTheme <span class="token punctuation">&#123;</span>
                <span class="token keyword">val</span> navController <span class="token operator">=</span> <span class="token function">rememberNavController</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token function">NavHost</span><span class="token punctuation">(</span>
                    navController <span class="token operator">=</span> navController<span class="token punctuation">,</span>
                    startDestination <span class="token operator">=</span> <span class="token string-literal singleline"><span class="token string">"home"</span></span>
                <span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                    <span class="token function">composable</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"home"</span></span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token function">HomeScreen</span><span class="token punctuation">(</span>navController<span class="token punctuation">)</span> <span class="token punctuation">&#125;</span>
                    <span class="token function">composable</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"detail/&#123;id&#125;"</span></span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> backStackEntry <span class="token operator">-></span>
                        <span class="token keyword">val</span> id <span class="token operator">=</span> backStackEntry<span class="token punctuation">.</span>arguments<span class="token operator">?</span><span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"id"</span></span><span class="token punctuation">)</span>
                        <span class="token function">DetailScreen</span><span class="token punctuation">(</span>id<span class="token punctuation">,</span> navController<span class="token punctuation">)</span>
                    <span class="token punctuation">&#125;</span>
                <span class="token punctuation">&#125;</span>
            <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// Fragment与ViewModel</span>
<span class="token keyword">class</span> UserFragment <span class="token operator">:</span> <span class="token function">Fragment</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">private</span> <span class="token keyword">val</span> viewModel<span class="token operator">:</span> UserViewModel <span class="token keyword">by</span> <span class="token function">viewModels</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    
    <span class="token keyword">override</span> <span class="token keyword">fun</span> <span class="token function">onCreateView</span><span class="token punctuation">(</span>
        inflater<span class="token operator">:</span> LayoutInflater<span class="token punctuation">,</span>
        container<span class="token operator">:</span> ViewGroup<span class="token operator">?</span><span class="token punctuation">,</span>
        savedInstanceState<span class="token operator">:</span> Bundle<span class="token operator">?</span>
    <span class="token punctuation">)</span><span class="token operator">:</span> View <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> <span class="token function">ComposeView</span><span class="token punctuation">(</span><span class="token function">requireContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">apply</span> <span class="token punctuation">&#123;</span>
            setContent <span class="token punctuation">&#123;</span>
                <span class="token function">UserScreen</span><span class="token punctuation">(</span>viewModel<span class="token punctuation">)</span>
            <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h4 id="3-2-数据存储"><a href="#3-2-数据存储" class="headerlink" title="3.2 数据存储"></a>3.2 数据存储</h4><figure><div class="code-wrapper"><pre class="line-numbers language-kotlin" data-language="kotlin"><code class="language-kotlin"><span class="token comment">// Room数据库</span>
<span class="token annotation builtin">@Entity</span><span class="token punctuation">(</span>tableName <span class="token operator">=</span> <span class="token string-literal singleline"><span class="token string">"users"</span></span><span class="token punctuation">)</span>
<span class="token keyword">data</span> <span class="token keyword">class</span> <span class="token function">UserEntity</span><span class="token punctuation">(</span>
    <span class="token annotation builtin">@PrimaryKey</span> <span class="token keyword">val</span> id<span class="token operator">:</span> Int<span class="token punctuation">,</span>
    <span class="token keyword">val</span> name<span class="token operator">:</span> String<span class="token punctuation">,</span>
    <span class="token keyword">val</span> email<span class="token operator">:</span> String<span class="token punctuation">,</span>
    <span class="token keyword">val</span> createdAt<span class="token operator">:</span> Long <span class="token operator">=</span> System<span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>

<span class="token annotation builtin">@Dao</span>
<span class="token keyword">interface</span> UserDao <span class="token punctuation">&#123;</span>
    <span class="token annotation builtin">@Query</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"SELECT * FROM users WHERE id = :id"</span></span><span class="token punctuation">)</span>
    <span class="token keyword">suspend</span> <span class="token keyword">fun</span> <span class="token function">getUserById</span><span class="token punctuation">(</span>id<span class="token operator">:</span> Int<span class="token punctuation">)</span><span class="token operator">:</span> UserEntity<span class="token operator">?</span>
    
    <span class="token annotation builtin">@Insert</span><span class="token punctuation">(</span>onConflict <span class="token operator">=</span> OnConflictStrategy<span class="token punctuation">.</span>REPLACE<span class="token punctuation">)</span>
    <span class="token keyword">suspend</span> <span class="token keyword">fun</span> <span class="token function">insertUser</span><span class="token punctuation">(</span>user<span class="token operator">:</span> UserEntity<span class="token punctuation">)</span>
    
    <span class="token annotation builtin">@Query</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"SELECT * FROM users ORDER BY createdAt DESC"</span></span><span class="token punctuation">)</span>
    <span class="token keyword">fun</span> <span class="token function">getAllUsers</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> Flow<span class="token operator">&lt;</span>List<span class="token operator">&lt;</span>UserEntity<span class="token operator">></span><span class="token operator">></span>
<span class="token punctuation">&#125;</span>

<span class="token annotation builtin">@Database</span><span class="token punctuation">(</span>entities <span class="token operator">=</span> <span class="token punctuation">[</span>UserEntity<span class="token operator">::</span><span class="token keyword">class</span><span class="token punctuation">]</span><span class="token punctuation">,</span> version <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span>
<span class="token keyword">abstract</span> <span class="token keyword">class</span> AppDatabase <span class="token operator">:</span> <span class="token function">RoomDatabase</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">abstract</span> <span class="token keyword">fun</span> <span class="token function">userDao</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> UserDao
<span class="token punctuation">&#125;</span>

<span class="token comment">// DataStore偏好存储</span>
<span class="token keyword">class</span> <span class="token function">UserPreferences</span><span class="token punctuation">(</span><span class="token keyword">private</span> <span class="token keyword">val</span> dataStore<span class="token operator">:</span> DataStore<span class="token operator">&lt;</span>Preferences<span class="token operator">></span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">private</span> <span class="token keyword">val</span> USER_NAME <span class="token operator">=</span> <span class="token function">stringPreferencesKey</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"user_name"</span></span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token keyword">val</span> IS_FIRST_LAUNCH <span class="token operator">=</span> <span class="token function">booleanPreferencesKey</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"is_first_launch"</span></span><span class="token punctuation">)</span>
    
    <span class="token keyword">val</span> userName<span class="token operator">:</span> Flow<span class="token operator">&lt;</span>String<span class="token operator">></span> <span class="token operator">=</span> dataStore<span class="token punctuation">.</span>data
        <span class="token punctuation">.</span><span class="token function">map</span> <span class="token punctuation">&#123;</span> preferences <span class="token operator">-></span> preferences<span class="token punctuation">[</span>USER_NAME<span class="token punctuation">]</span> <span class="token operator">?:</span> <span class="token string-literal singleline"><span class="token string">""</span></span> <span class="token punctuation">&#125;</span>
    
    <span class="token keyword">suspend</span> <span class="token keyword">fun</span> <span class="token function">saveUserName</span><span class="token punctuation">(</span>name<span class="token operator">:</span> String<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        dataStore<span class="token punctuation">.</span><span class="token function">edit</span> <span class="token punctuation">&#123;</span> preferences <span class="token operator">-></span>
            preferences<span class="token punctuation">[</span>USER_NAME<span class="token punctuation">]</span> <span class="token operator">=</span> name
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h2 id="二、UI开发进阶"><a href="#二、UI开发进阶" class="headerlink" title="二、UI开发进阶"></a>二、UI开发进阶</h2><h3 id="（一）Jetpack-Compose全面掌握"><a href="#（一）Jetpack-Compose全面掌握" class="headerlink" title="（一）Jetpack Compose全面掌握"></a>（一）Jetpack Compose全面掌握</h3><h4 id="1-1-Compose基础组件"><a href="#1-1-Compose基础组件" class="headerlink" title="1.1 Compose基础组件"></a>1.1 Compose基础组件</h4><figure><div class="code-wrapper"><pre class="line-numbers language-kotlin" data-language="kotlin"><code class="language-kotlin"><span class="token comment">// 状态管理</span>
<span class="token annotation builtin">@Composable</span>
<span class="token keyword">fun</span> <span class="token function">CounterScreen</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">var</span> count <span class="token keyword">by</span> remember <span class="token punctuation">&#123;</span> <span class="token function">mutableStateOf</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#125;</span>
    
    <span class="token function">Column</span><span class="token punctuation">(</span>
        modifier <span class="token operator">=</span> Modifier
            <span class="token punctuation">.</span><span class="token function">fillMaxSize</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">padding</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">.</span>dp<span class="token punctuation">)</span><span class="token punctuation">,</span>
        horizontalAlignment <span class="token operator">=</span> Alignment<span class="token punctuation">.</span>CenterHorizontally<span class="token punctuation">,</span>
        verticalArrangement <span class="token operator">=</span> Arrangement<span class="token punctuation">.</span>Center
    <span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token function">Text</span><span class="token punctuation">(</span>
            text <span class="token operator">=</span> <span class="token string-literal singleline"><span class="token string">"Count: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$</span><span class="token expression">count</span></span><span class="token string">"</span></span><span class="token punctuation">,</span>
            style <span class="token operator">=</span> MaterialTheme<span class="token punctuation">.</span>typography<span class="token punctuation">.</span>headlineMedium
        <span class="token punctuation">)</span>
        
        <span class="token function">Spacer</span><span class="token punctuation">(</span>modifier <span class="token operator">=</span> Modifier<span class="token punctuation">.</span><span class="token function">height</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">.</span>dp<span class="token punctuation">)</span><span class="token punctuation">)</span>
        
        <span class="token function">Button</span><span class="token punctuation">(</span>onClick <span class="token operator">=</span> <span class="token punctuation">&#123;</span> count<span class="token operator">++</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token function">Text</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"Increment"</span></span><span class="token punctuation">)</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// 列表和网格</span>
<span class="token annotation builtin">@Composable</span>
<span class="token keyword">fun</span> <span class="token function">UserList</span><span class="token punctuation">(</span>users<span class="token operator">:</span> List<span class="token operator">&lt;</span>User<span class="token operator">></span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token function">LazyColumn</span><span class="token punctuation">(</span>
        modifier <span class="token operator">=</span> Modifier<span class="token punctuation">.</span><span class="token function">fillMaxSize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        contentPadding <span class="token operator">=</span> <span class="token function">PaddingValues</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">.</span>dp<span class="token punctuation">)</span><span class="token punctuation">,</span>
        verticalArrangement <span class="token operator">=</span> Arrangement<span class="token punctuation">.</span><span class="token function">spacedBy</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">.</span>dp<span class="token punctuation">)</span>
    <span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token function">items</span><span class="token punctuation">(</span>users<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> user <span class="token operator">-></span>
            <span class="token function">UserCard</span><span class="token punctuation">(</span>user <span class="token operator">=</span> user<span class="token punctuation">)</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token annotation builtin">@Composable</span>
<span class="token keyword">fun</span> <span class="token function">UserCard</span><span class="token punctuation">(</span>user<span class="token operator">:</span> User<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token function">Card</span><span class="token punctuation">(</span>
        modifier <span class="token operator">=</span> Modifier<span class="token punctuation">.</span><span class="token function">fillMaxWidth</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        elevation <span class="token operator">=</span> CardDefaults<span class="token punctuation">.</span><span class="token function">cardElevation</span><span class="token punctuation">(</span>defaultElevation <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">.</span>dp<span class="token punctuation">)</span>
    <span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token function">Row</span><span class="token punctuation">(</span>
            modifier <span class="token operator">=</span> Modifier
                <span class="token punctuation">.</span><span class="token function">fillMaxWidth</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">padding</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">.</span>dp<span class="token punctuation">)</span><span class="token punctuation">,</span>
            verticalAlignment <span class="token operator">=</span> Alignment<span class="token punctuation">.</span>CenterVertically
        <span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token function">AsyncImage</span><span class="token punctuation">(</span>
                model <span class="token operator">=</span> user<span class="token punctuation">.</span>avatarUrl<span class="token punctuation">,</span>
                contentDescription <span class="token operator">=</span> <span class="token string-literal singleline"><span class="token string">"User avatar"</span></span><span class="token punctuation">,</span>
                modifier <span class="token operator">=</span> Modifier
                    <span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token number">48</span><span class="token punctuation">.</span>dp<span class="token punctuation">)</span>
                    <span class="token punctuation">.</span><span class="token function">clip</span><span class="token punctuation">(</span>CircleShape<span class="token punctuation">)</span>
            <span class="token punctuation">)</span>
            
            <span class="token function">Spacer</span><span class="token punctuation">(</span>modifier <span class="token operator">=</span> Modifier<span class="token punctuation">.</span><span class="token function">width</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">.</span>dp<span class="token punctuation">)</span><span class="token punctuation">)</span>
            
            Column <span class="token punctuation">&#123;</span>
                <span class="token function">Text</span><span class="token punctuation">(</span>
                    text <span class="token operator">=</span> user<span class="token punctuation">.</span>name<span class="token punctuation">,</span>
                    style <span class="token operator">=</span> MaterialTheme<span class="token punctuation">.</span>typography<span class="token punctuation">.</span>titleMedium
                <span class="token punctuation">)</span>
                <span class="token function">Text</span><span class="token punctuation">(</span>
                    text <span class="token operator">=</span> user<span class="token punctuation">.</span>email<span class="token punctuation">,</span>
                    style <span class="token operator">=</span> MaterialTheme<span class="token punctuation">.</span>typography<span class="token punctuation">.</span>bodyMedium<span class="token punctuation">,</span>
                    color <span class="token operator">=</span> MaterialTheme<span class="token punctuation">.</span>colorScheme<span class="token punctuation">.</span>onSurfaceVariant
                <span class="token punctuation">)</span>
            <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h4 id="1-2-Compose动画与过渡"><a href="#1-2-Compose动画与过渡" class="headerlink" title="1.2 Compose动画与过渡"></a>1.2 Compose动画与过渡</h4><figure><div class="code-wrapper"><pre class="line-numbers language-kotlin" data-language="kotlin"><code class="language-kotlin"><span class="token comment">// 动画效果</span>
<span class="token annotation builtin">@Composable</span>
<span class="token keyword">fun</span> <span class="token function">AnimatedVisibilityExample</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">var</span> visible <span class="token keyword">by</span> remember <span class="token punctuation">&#123;</span> <span class="token function">mutableStateOf</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">&#125;</span>
    
    Column <span class="token punctuation">&#123;</span>
        <span class="token function">Button</span><span class="token punctuation">(</span>onClick <span class="token operator">=</span> <span class="token punctuation">&#123;</span> visible <span class="token operator">=</span> <span class="token operator">!</span>visible <span class="token punctuation">&#125;</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token function">Text</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"Toggle Visibility"</span></span><span class="token punctuation">)</span>
        <span class="token punctuation">&#125;</span>
        
        <span class="token function">AnimatedVisibility</span><span class="token punctuation">(</span>
            visible <span class="token operator">=</span> visible<span class="token punctuation">,</span>
            enter <span class="token operator">=</span> <span class="token function">fadeIn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token function">slideInVertically</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            exit <span class="token operator">=</span> <span class="token function">fadeOut</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token function">slideOutVertically</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token function">Card</span><span class="token punctuation">(</span>
                modifier <span class="token operator">=</span> Modifier
                    <span class="token punctuation">.</span><span class="token function">fillMaxWidth</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                    <span class="token punctuation">.</span><span class="token function">padding</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">.</span>dp<span class="token punctuation">)</span>
            <span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                <span class="token function">Text</span><span class="token punctuation">(</span>
                    <span class="token string-literal singleline"><span class="token string">"Animated Content"</span></span><span class="token punctuation">,</span>
                    modifier <span class="token operator">=</span> Modifier<span class="token punctuation">.</span><span class="token function">padding</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">.</span>dp<span class="token punctuation">)</span>
                <span class="token punctuation">)</span>
            <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// 自定义动画</span>
<span class="token annotation builtin">@Composable</span>
<span class="token keyword">fun</span> <span class="token function">LoadingAnimation</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">val</span> infiniteTransition <span class="token operator">=</span> <span class="token function">rememberInfiniteTransition</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">val</span> rotation <span class="token keyword">by</span> infiniteTransition<span class="token punctuation">.</span><span class="token function">animateFloat</span><span class="token punctuation">(</span>
        initialValue <span class="token operator">=</span> <span class="token number">0f</span><span class="token punctuation">,</span>
        targetValue <span class="token operator">=</span> <span class="token number">360f</span><span class="token punctuation">,</span>
        animationSpec <span class="token operator">=</span> <span class="token function">infiniteRepeatable</span><span class="token punctuation">(</span>
            animation <span class="token operator">=</span> <span class="token function">tween</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">,</span> easing <span class="token operator">=</span> LinearEasing<span class="token punctuation">)</span><span class="token punctuation">,</span>
            repeatMode <span class="token operator">=</span> RepeatMode<span class="token punctuation">.</span>Restart
        <span class="token punctuation">)</span>
    <span class="token punctuation">)</span>
    
    <span class="token function">Box</span><span class="token punctuation">(</span>
        modifier <span class="token operator">=</span> Modifier<span class="token punctuation">.</span><span class="token function">fillMaxSize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        contentAlignment <span class="token operator">=</span> Alignment<span class="token punctuation">.</span>Center
    <span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token function">CircularProgressIndicator</span><span class="token punctuation">(</span>
            modifier <span class="token operator">=</span> Modifier<span class="token punctuation">.</span><span class="token function">rotate</span><span class="token punctuation">(</span>rotation<span class="token punctuation">)</span>
        <span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h3 id="（二）Material-Design-3"><a href="#（二）Material-Design-3" class="headerlink" title="（二）Material Design 3"></a>（二）Material Design 3</h3><h4 id="2-1-主题和样式"><a href="#2-1-主题和样式" class="headerlink" title="2.1 主题和样式"></a>2.1 主题和样式</h4><figure><div class="code-wrapper"><pre class="line-numbers language-kotlin" data-language="kotlin"><code class="language-kotlin"><span class="token comment">// Material 3主题配置</span>
<span class="token keyword">private</span> <span class="token keyword">val</span> DarkColorScheme <span class="token operator">=</span> <span class="token function">darkColorScheme</span><span class="token punctuation">(</span>
    primary <span class="token operator">=</span> Purple80<span class="token punctuation">,</span>
    secondary <span class="token operator">=</span> PurpleGrey80<span class="token punctuation">,</span>
    tertiary <span class="token operator">=</span> Pink80
<span class="token punctuation">)</span>

<span class="token keyword">private</span> <span class="token keyword">val</span> LightColorScheme <span class="token operator">=</span> <span class="token function">lightColorScheme</span><span class="token punctuation">(</span>
    primary <span class="token operator">=</span> Purple40<span class="token punctuation">,</span>
    secondary <span class="token operator">=</span> PurpleGrey40<span class="token punctuation">,</span>
    tertiary <span class="token operator">=</span> Pink40
<span class="token punctuation">)</span>

<span class="token annotation builtin">@Composable</span>
<span class="token keyword">fun</span> <span class="token function">MyAppTheme</span><span class="token punctuation">(</span>
    darkTheme<span class="token operator">:</span> Boolean <span class="token operator">=</span> <span class="token function">isSystemInDarkTheme</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    content<span class="token operator">:</span> <span class="token annotation builtin">@Composable</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-></span> Unit
<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">val</span> colorScheme <span class="token operator">=</span> <span class="token keyword">when</span> <span class="token punctuation">&#123;</span>
        darkTheme <span class="token operator">-></span> DarkColorScheme
        <span class="token keyword">else</span> <span class="token operator">-></span> LightColorScheme
    <span class="token punctuation">&#125;</span>
    
    <span class="token function">MaterialTheme</span><span class="token punctuation">(</span>
        colorScheme <span class="token operator">=</span> colorScheme<span class="token punctuation">,</span>
        typography <span class="token operator">=</span> Typography<span class="token punctuation">,</span>
        content <span class="token operator">=</span> content
    <span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// 动态颜色</span>
<span class="token annotation builtin">@Composable</span>
<span class="token keyword">fun</span> <span class="token function">DynamicTheme</span><span class="token punctuation">(</span>
    darkTheme<span class="token operator">:</span> Boolean <span class="token operator">=</span> <span class="token function">isSystemInDarkTheme</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    content<span class="token operator">:</span> <span class="token annotation builtin">@Composable</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-></span> Unit
<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">val</span> context <span class="token operator">=</span> LocalContext<span class="token punctuation">.</span>current
    <span class="token keyword">val</span> colorScheme <span class="token operator">=</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>Build<span class="token punctuation">.</span>VERSION<span class="token punctuation">.</span>SDK_INT <span class="token operator">>=</span> Build<span class="token punctuation">.</span>VERSION_CODES<span class="token punctuation">.</span>S<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>darkTheme<span class="token punctuation">)</span> <span class="token function">dynamicDarkColorScheme</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span>
        <span class="token keyword">else</span> <span class="token function">dynamicLightColorScheme</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>darkTheme<span class="token punctuation">)</span> DarkColorScheme <span class="token keyword">else</span> LightColorScheme
    <span class="token punctuation">&#125;</span>
    
    <span class="token function">MaterialTheme</span><span class="token punctuation">(</span>
        colorScheme <span class="token operator">=</span> colorScheme<span class="token punctuation">,</span>
        typography <span class="token operator">=</span> Typography<span class="token punctuation">,</span>
        content <span class="token operator">=</span> content
    <span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h2 id="三、架构设计模式"><a href="#三、架构设计模式" class="headerlink" title="三、架构设计模式"></a>三、架构设计模式</h2><h3 id="（一）MVVM架构"><a href="#（一）MVVM架构" class="headerlink" title="（一）MVVM架构"></a>（一）MVVM架构</h3><h4 id="1-1-ViewModel实现"><a href="#1-1-ViewModel实现" class="headerlink" title="1.1 ViewModel实现"></a>1.1 ViewModel实现</h4><figure><div class="code-wrapper"><pre class="line-numbers language-kotlin" data-language="kotlin"><code class="language-kotlin"><span class="token comment">// ViewModel基类</span>
<span class="token keyword">abstract</span> <span class="token keyword">class</span> BaseViewModel <span class="token operator">:</span> <span class="token function">ViewModel</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">protected</span> <span class="token keyword">val</span> _uiState <span class="token operator">=</span> <span class="token function">MutableStateFlow</span><span class="token punctuation">(</span><span class="token function">UiState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">val</span> uiState<span class="token operator">:</span> StateFlow<span class="token operator">&lt;</span>UiState<span class="token operator">></span> <span class="token operator">=</span> _uiState<span class="token punctuation">.</span><span class="token function">asStateFlow</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    
    <span class="token keyword">protected</span> <span class="token keyword">val</span> _event <span class="token operator">=</span> MutableSharedFlow<span class="token operator">&lt;</span>Event<span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">val</span> event<span class="token operator">:</span> SharedFlow<span class="token operator">&lt;</span>Event<span class="token operator">></span> <span class="token operator">=</span> _event<span class="token punctuation">.</span><span class="token function">asSharedFlow</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    
    <span class="token keyword">protected</span> <span class="token keyword">fun</span> <span class="token function">launch</span><span class="token punctuation">(</span>
        onError<span class="token operator">:</span> <span class="token punctuation">(</span>Throwable<span class="token punctuation">)</span> <span class="token operator">-></span> Unit <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
        onSuccess<span class="token operator">:</span> <span class="token keyword">suspend</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-></span> Unit
    <span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        viewModelScope<span class="token punctuation">.</span><span class="token function">launch</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>
                <span class="token function">onSuccess</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token operator">:</span> Exception<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                <span class="token function">onError</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>
                _event<span class="token punctuation">.</span><span class="token function">emit</span><span class="token punctuation">(</span>Event<span class="token punctuation">.</span><span class="token function">Error</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>message <span class="token operator">?:</span> <span class="token string-literal singleline"><span class="token string">"Unknown error"</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// 具体ViewModel</span>
<span class="token keyword">class</span> <span class="token function">UserViewModel</span><span class="token punctuation">(</span>
    <span class="token keyword">private</span> <span class="token keyword">val</span> userRepository<span class="token operator">:</span> UserRepository<span class="token punctuation">,</span>
    <span class="token keyword">private</span> <span class="token keyword">val</span> savedStateHandle<span class="token operator">:</span> SavedStateHandle
<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">BaseViewModel</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    
    <span class="token keyword">private</span> <span class="token keyword">val</span> userId<span class="token operator">:</span> String <span class="token operator">=</span> savedStateHandle<span class="token punctuation">[</span><span class="token string-literal singleline"><span class="token string">"userId"</span></span><span class="token punctuation">]</span> <span class="token operator">?:</span> <span class="token string-literal singleline"><span class="token string">""</span></span>
    
    <span class="token keyword">init</span> <span class="token punctuation">&#123;</span>
        <span class="token function">loadUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span>
    
    <span class="token keyword">private</span> <span class="token keyword">fun</span> <span class="token function">loadUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token function">launch</span><span class="token punctuation">(</span>
            onError <span class="token operator">=</span> <span class="token punctuation">&#123;</span> error <span class="token operator">-></span>
                _uiState<span class="token punctuation">.</span><span class="token function">update</span> <span class="token punctuation">&#123;</span> it<span class="token punctuation">.</span><span class="token function">copy</span><span class="token punctuation">(</span>isLoading <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">,</span> error <span class="token operator">=</span> error<span class="token punctuation">.</span>message<span class="token punctuation">)</span> <span class="token punctuation">&#125;</span>
            <span class="token punctuation">&#125;</span>
        <span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            _uiState<span class="token punctuation">.</span><span class="token function">update</span> <span class="token punctuation">&#123;</span> it<span class="token punctuation">.</span><span class="token function">copy</span><span class="token punctuation">(</span>isLoading <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">&#125;</span>
            <span class="token keyword">val</span> user <span class="token operator">=</span> userRepository<span class="token punctuation">.</span><span class="token function">getUser</span><span class="token punctuation">(</span>userId<span class="token punctuation">)</span>
            _uiState<span class="token punctuation">.</span><span class="token function">update</span> <span class="token punctuation">&#123;</span> it<span class="token punctuation">.</span><span class="token function">copy</span><span class="token punctuation">(</span>isLoading <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">,</span> user <span class="token operator">=</span> user<span class="token punctuation">)</span> <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
    
    <span class="token keyword">fun</span> <span class="token function">updateUser</span><span class="token punctuation">(</span>user<span class="token operator">:</span> User<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        launch <span class="token punctuation">&#123;</span>
            userRepository<span class="token punctuation">.</span><span class="token function">updateUser</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span>
            _event<span class="token punctuation">.</span><span class="token function">emit</span><span class="token punctuation">(</span>Event<span class="token punctuation">.</span>UserUpdated<span class="token punctuation">)</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// UI状态</span>
<span class="token keyword">data</span> <span class="token keyword">class</span> <span class="token function">UiState</span><span class="token punctuation">(</span>
    <span class="token keyword">val</span> isLoading<span class="token operator">:</span> Boolean <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token keyword">val</span> user<span class="token operator">:</span> User<span class="token operator">?</span> <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
    <span class="token keyword">val</span> error<span class="token operator">:</span> String<span class="token operator">?</span> <span class="token operator">=</span> <span class="token keyword">null</span>
<span class="token punctuation">)</span>

<span class="token keyword">sealed</span> <span class="token keyword">class</span> Event <span class="token punctuation">&#123;</span>
    <span class="token keyword">data</span> <span class="token keyword">class</span> <span class="token function">Error</span><span class="token punctuation">(</span><span class="token keyword">val</span> message<span class="token operator">:</span> String<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">Event</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">object</span> UserUpdated <span class="token operator">:</span> <span class="token function">Event</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h3 id="（二）Clean-Architecture"><a href="#（二）Clean-Architecture" class="headerlink" title="（二）Clean Architecture"></a>（二）Clean Architecture</h3><h4 id="2-1-分层架构"><a href="#2-1-分层架构" class="headerlink" title="2.1 分层架构"></a>2.1 分层架构</h4><figure><div class="code-wrapper"><pre class="line-numbers language-none"><code class="language-none">app&#x2F;
├── presentation&#x2F;
│   ├── ui&#x2F;
│   │   ├── screens&#x2F;
│   │   ├── components&#x2F;
│   │   └── theme&#x2F;
│   └── viewmodel&#x2F;
├── domain&#x2F;
│   ├── model&#x2F;
│   ├── repository&#x2F;
│   └── usecase&#x2F;
└── data&#x2F;
    ├── local&#x2F;
    ├── remote&#x2F;
    └── repository&#x2F;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h4 id="2-2-领域层"><a href="#2-2-领域层" class="headerlink" title="2.2 领域层"></a>2.2 领域层</h4><figure><div class="code-wrapper"><pre class="line-numbers language-kotlin" data-language="kotlin"><code class="language-kotlin"><span class="token comment">// 实体</span>
<span class="token keyword">data</span> <span class="token keyword">class</span> <span class="token function">User</span><span class="token punctuation">(</span>
    <span class="token keyword">val</span> id<span class="token operator">:</span> String<span class="token punctuation">,</span>
    <span class="token keyword">val</span> name<span class="token operator">:</span> String<span class="token punctuation">,</span>
    <span class="token keyword">val</span> email<span class="token operator">:</span> String<span class="token punctuation">,</span>
    <span class="token keyword">val</span> avatarUrl<span class="token operator">:</span> String<span class="token operator">?</span>
<span class="token punctuation">)</span>

<span class="token comment">// 仓库接口</span>
<span class="token keyword">interface</span> UserRepository <span class="token punctuation">&#123;</span>
    <span class="token keyword">suspend</span> <span class="token keyword">fun</span> <span class="token function">getUser</span><span class="token punctuation">(</span>id<span class="token operator">:</span> String<span class="token punctuation">)</span><span class="token operator">:</span> Result<span class="token operator">&lt;</span>User<span class="token operator">></span>
    <span class="token keyword">suspend</span> <span class="token keyword">fun</span> <span class="token function">getUsers</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> Result<span class="token operator">&lt;</span>List<span class="token operator">&lt;</span>User<span class="token operator">></span><span class="token operator">></span>
    <span class="token keyword">suspend</span> <span class="token keyword">fun</span> <span class="token function">updateUser</span><span class="token punctuation">(</span>user<span class="token operator">:</span> User<span class="token punctuation">)</span><span class="token operator">:</span> Result<span class="token operator">&lt;</span>Unit<span class="token operator">></span>
    <span class="token keyword">suspend</span> <span class="token keyword">fun</span> <span class="token function">deleteUser</span><span class="token punctuation">(</span>id<span class="token operator">:</span> String<span class="token punctuation">)</span><span class="token operator">:</span> Result<span class="token operator">&lt;</span>Unit<span class="token operator">></span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// 用例</span>
<span class="token keyword">class</span> <span class="token function">GetUserUseCase</span><span class="token punctuation">(</span>
    <span class="token keyword">private</span> <span class="token keyword">val</span> userRepository<span class="token operator">:</span> UserRepository
<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">suspend</span> <span class="token keyword">operator</span> <span class="token keyword">fun</span> <span class="token function">invoke</span><span class="token punctuation">(</span>id<span class="token operator">:</span> String<span class="token punctuation">)</span><span class="token operator">:</span> Result<span class="token operator">&lt;</span>User<span class="token operator">></span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> userRepository<span class="token punctuation">.</span><span class="token function">getUser</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">class</span> <span class="token function">GetUsersUseCase</span><span class="token punctuation">(</span>
    <span class="token keyword">private</span> <span class="token keyword">val</span> userRepository<span class="token operator">:</span> UserRepository
<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">suspend</span> <span class="token keyword">operator</span> <span class="token keyword">fun</span> <span class="token function">invoke</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> Result<span class="token operator">&lt;</span>List<span class="token operator">&lt;</span>User<span class="token operator">></span><span class="token operator">></span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> userRepository<span class="token punctuation">.</span><span class="token function">getUsers</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h4 id="2-3-数据层"><a href="#2-3-数据层" class="headerlink" title="2.3 数据层"></a>2.3 数据层</h4><figure><div class="code-wrapper"><pre class="line-numbers language-kotlin" data-language="kotlin"><code class="language-kotlin"><span class="token comment">// 远程数据源</span>
<span class="token keyword">class</span> <span class="token function">UserRemoteDataSource</span><span class="token punctuation">(</span>
    <span class="token keyword">private</span> <span class="token keyword">val</span> apiService<span class="token operator">:</span> UserApiService
<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">suspend</span> <span class="token keyword">fun</span> <span class="token function">getUser</span><span class="token punctuation">(</span>id<span class="token operator">:</span> String<span class="token punctuation">)</span><span class="token operator">:</span> UserDto <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> apiService<span class="token punctuation">.</span><span class="token function">getUser</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span>
    
    <span class="token keyword">suspend</span> <span class="token keyword">fun</span> <span class="token function">getUsers</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> List<span class="token operator">&lt;</span>UserDto<span class="token operator">></span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> apiService<span class="token punctuation">.</span><span class="token function">getUsers</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// 本地数据源</span>
<span class="token keyword">class</span> <span class="token function">UserLocalDataSource</span><span class="token punctuation">(</span>
    <span class="token keyword">private</span> <span class="token keyword">val</span> userDao<span class="token operator">:</span> UserDao
<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">suspend</span> <span class="token keyword">fun</span> <span class="token function">getUser</span><span class="token punctuation">(</span>id<span class="token operator">:</span> String<span class="token punctuation">)</span><span class="token operator">:</span> UserEntity<span class="token operator">?</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> userDao<span class="token punctuation">.</span><span class="token function">getUserById</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span>
    
    <span class="token keyword">suspend</span> <span class="token keyword">fun</span> <span class="token function">saveUsers</span><span class="token punctuation">(</span>users<span class="token operator">:</span> List<span class="token operator">&lt;</span>UserEntity<span class="token operator">></span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        userDao<span class="token punctuation">.</span><span class="token function">insertUsers</span><span class="token punctuation">(</span>users<span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// 仓库实现</span>
<span class="token keyword">class</span> <span class="token function">UserRepositoryImpl</span><span class="token punctuation">(</span>
    <span class="token keyword">private</span> <span class="token keyword">val</span> remoteDataSource<span class="token operator">:</span> UserRemoteDataSource<span class="token punctuation">,</span>
    <span class="token keyword">private</span> <span class="token keyword">val</span> localDataSource<span class="token operator">:</span> UserLocalDataSource<span class="token punctuation">,</span>
    <span class="token keyword">private</span> <span class="token keyword">val</span> networkManager<span class="token operator">:</span> NetworkManager
<span class="token punctuation">)</span> <span class="token operator">:</span> UserRepository <span class="token punctuation">&#123;</span>
    
    <span class="token keyword">override</span> <span class="token keyword">suspend</span> <span class="token keyword">fun</span> <span class="token function">getUser</span><span class="token punctuation">(</span>id<span class="token operator">:</span> String<span class="token punctuation">)</span><span class="token operator">:</span> Result<span class="token operator">&lt;</span>User<span class="token operator">></span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>networkManager<span class="token punctuation">.</span><span class="token function">isConnected</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                <span class="token keyword">val</span> userDto <span class="token operator">=</span> remoteDataSource<span class="token punctuation">.</span><span class="token function">getUser</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span>
                <span class="token keyword">val</span> user <span class="token operator">=</span> userDto<span class="token punctuation">.</span><span class="token function">toDomain</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                localDataSource<span class="token punctuation">.</span><span class="token function">saveUser</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span><span class="token function">toEntity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                Result<span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span>
            <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
                <span class="token keyword">val</span> userEntity <span class="token operator">=</span> localDataSource<span class="token punctuation">.</span><span class="token function">getUser</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span>
                userEntity<span class="token operator">?</span><span class="token punctuation">.</span><span class="token function">toDomain</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">.</span><span class="token function">let</span> <span class="token punctuation">&#123;</span> Result<span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">(</span>it<span class="token punctuation">)</span> <span class="token punctuation">&#125;</span>
                    <span class="token operator">?:</span> Result<span class="token punctuation">.</span><span class="token function">failure</span><span class="token punctuation">(</span><span class="token function">Exception</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"User not found"</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token operator">:</span> Exception<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            Result<span class="token punctuation">.</span><span class="token function">failure</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h2 id="四、网络与数据层"><a href="#四、网络与数据层" class="headerlink" title="四、网络与数据层"></a>四、网络与数据层</h2><h3 id="（一）网络通信"><a href="#（一）网络通信" class="headerlink" title="（一）网络通信"></a>（一）网络通信</h3><h4 id="1-1-Retrofit-OkHttp"><a href="#1-1-Retrofit-OkHttp" class="headerlink" title="1.1 Retrofit + OkHttp"></a>1.1 Retrofit + OkHttp</h4><figure><div class="code-wrapper"><pre class="line-numbers language-kotlin" data-language="kotlin"><code class="language-kotlin"><span class="token comment">// API接口</span>
<span class="token keyword">interface</span> UserApiService <span class="token punctuation">&#123;</span>
    <span class="token annotation builtin">@GET</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"users/&#123;id&#125;"</span></span><span class="token punctuation">)</span>
    <span class="token keyword">suspend</span> <span class="token keyword">fun</span> <span class="token function">getUser</span><span class="token punctuation">(</span><span class="token annotation builtin">@Path</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"id"</span></span><span class="token punctuation">)</span> id<span class="token operator">:</span> String<span class="token punctuation">)</span><span class="token operator">:</span> UserDto
    
    <span class="token annotation builtin">@GET</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"users"</span></span><span class="token punctuation">)</span>
    <span class="token keyword">suspend</span> <span class="token keyword">fun</span> <span class="token function">getUsers</span><span class="token punctuation">(</span>
        <span class="token annotation builtin">@Query</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"page"</span></span><span class="token punctuation">)</span> page<span class="token operator">:</span> Int<span class="token punctuation">,</span>
        <span class="token annotation builtin">@Query</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"limit"</span></span><span class="token punctuation">)</span> limit<span class="token operator">:</span> Int
    <span class="token punctuation">)</span><span class="token operator">:</span> List<span class="token operator">&lt;</span>UserDto<span class="token operator">></span>
    
    <span class="token annotation builtin">@POST</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"users"</span></span><span class="token punctuation">)</span>
    <span class="token keyword">suspend</span> <span class="token keyword">fun</span> <span class="token function">createUser</span><span class="token punctuation">(</span><span class="token annotation builtin">@Body</span> user<span class="token operator">:</span> CreateUserRequest<span class="token punctuation">)</span><span class="token operator">:</span> UserDto
    
    <span class="token annotation builtin">@PUT</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"users/&#123;id&#125;"</span></span><span class="token punctuation">)</span>
    <span class="token keyword">suspend</span> <span class="token keyword">fun</span> <span class="token function">updateUser</span><span class="token punctuation">(</span>
        <span class="token annotation builtin">@Path</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"id"</span></span><span class="token punctuation">)</span> id<span class="token operator">:</span> String<span class="token punctuation">,</span>
        <span class="token annotation builtin">@Body</span> user<span class="token operator">:</span> UpdateUserRequest
    <span class="token punctuation">)</span><span class="token operator">:</span> UserDto
    
    <span class="token annotation builtin">@DELETE</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"users/&#123;id&#125;"</span></span><span class="token punctuation">)</span>
    <span class="token keyword">suspend</span> <span class="token keyword">fun</span> <span class="token function">deleteUser</span><span class="token punctuation">(</span><span class="token annotation builtin">@Path</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"id"</span></span><span class="token punctuation">)</span> id<span class="token operator">:</span> String<span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// 网络配置</span>
<span class="token keyword">object</span> NetworkModule <span class="token punctuation">&#123;</span>
    <span class="token keyword">private</span> <span class="token keyword">const</span> <span class="token keyword">val</span> BASE_URL <span class="token operator">=</span> <span class="token string-literal singleline"><span class="token string">"https://api.example.com/"</span></span>
    
    <span class="token keyword">private</span> <span class="token keyword">val</span> okHttpClient <span class="token operator">=</span> OkHttpClient<span class="token punctuation">.</span><span class="token function">Builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">connectTimeout</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">,</span> TimeUnit<span class="token punctuation">.</span>SECONDS<span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">readTimeout</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">,</span> TimeUnit<span class="token punctuation">.</span>SECONDS<span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">writeTimeout</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">,</span> TimeUnit<span class="token punctuation">.</span>SECONDS<span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">addInterceptor</span><span class="token punctuation">(</span><span class="token function">AuthInterceptor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">addInterceptor</span><span class="token punctuation">(</span><span class="token function">LoggingInterceptor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    
    <span class="token keyword">private</span> <span class="token keyword">val</span> retrofit <span class="token operator">=</span> Retrofit<span class="token punctuation">.</span><span class="token function">Builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">baseUrl</span><span class="token punctuation">(</span>BASE_URL<span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">client</span><span class="token punctuation">(</span>okHttpClient<span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">addConverterFactory</span><span class="token punctuation">(</span>GsonConverterFactory<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    
    <span class="token keyword">val</span> userApiService<span class="token operator">:</span> UserApiService <span class="token operator">=</span> retrofit<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>UserApiService<span class="token operator">::</span><span class="token keyword">class</span><span class="token punctuation">.</span>java<span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// 认证拦截器</span>
<span class="token keyword">class</span> AuthInterceptor <span class="token operator">:</span> Interceptor <span class="token punctuation">&#123;</span>
    <span class="token keyword">override</span> <span class="token keyword">fun</span> <span class="token function">intercept</span><span class="token punctuation">(</span>chain<span class="token operator">:</span> Interceptor<span class="token punctuation">.</span>Chain<span class="token punctuation">)</span><span class="token operator">:</span> Response <span class="token punctuation">&#123;</span>
        <span class="token keyword">val</span> originalRequest <span class="token operator">=</span> chain<span class="token punctuation">.</span><span class="token function">request</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">val</span> authenticatedRequest <span class="token operator">=</span> originalRequest<span class="token punctuation">.</span><span class="token function">newBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">header</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"Authorization"</span></span><span class="token punctuation">,</span> <span class="token string-literal singleline"><span class="token string">"Bearer </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span><span class="token expression">TokenManager<span class="token punctuation">.</span><span class="token function">getToken</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span><span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> chain<span class="token punctuation">.</span><span class="token function">proceed</span><span class="token punctuation">(</span>authenticatedRequest<span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h3 id="（二）数据持久化"><a href="#（二）数据持久化" class="headerlink" title="（二）数据持久化"></a>（二）数据持久化</h3><h4 id="2-1-Room数据库高级用法"><a href="#2-1-Room数据库高级用法" class="headerlink" title="2.1 Room数据库高级用法"></a>2.1 Room数据库高级用法</h4><figure><div class="code-wrapper"><pre class="line-numbers language-kotlin" data-language="kotlin"><code class="language-kotlin"><span class="token comment">// 复杂查询</span>
<span class="token annotation builtin">@Dao</span>
<span class="token keyword">interface</span> UserDao <span class="token punctuation">&#123;</span>
    <span class="token annotation builtin">@Query</span><span class="token punctuation">(</span><span class="token string-literal multiline"><span class="token string">"""
        SELECT * FROM users 
        WHERE name LIKE '%' || :query || '%' 
        OR email LIKE '%' || :query || '%'
        ORDER BY createdAt DESC
    """</span></span><span class="token punctuation">)</span>
    <span class="token keyword">fun</span> <span class="token function">searchUsers</span><span class="token punctuation">(</span>query<span class="token operator">:</span> String<span class="token punctuation">)</span><span class="token operator">:</span> Flow<span class="token operator">&lt;</span>List<span class="token operator">&lt;</span>UserEntity<span class="token operator">></span><span class="token operator">></span>
    
    <span class="token annotation builtin">@Query</span><span class="token punctuation">(</span><span class="token string-literal multiline"><span class="token string">"""
        SELECT * FROM users 
        WHERE createdAt BETWEEN :startDate AND :endDate
        ORDER BY createdAt DESC
        LIMIT :limit OFFSET :offset
    """</span></span><span class="token punctuation">)</span>
    <span class="token keyword">suspend</span> <span class="token keyword">fun</span> <span class="token function">getUsersByDateRange</span><span class="token punctuation">(</span>
        startDate<span class="token operator">:</span> Long<span class="token punctuation">,</span>
        endDate<span class="token operator">:</span> Long<span class="token punctuation">,</span>
        limit<span class="token operator">:</span> Int<span class="token punctuation">,</span>
        offset<span class="token operator">:</span> Int
    <span class="token punctuation">)</span><span class="token operator">:</span> List<span class="token operator">&lt;</span>UserEntity<span class="token operator">></span>
    
    <span class="token annotation builtin">@Transaction</span>
    <span class="token keyword">suspend</span> <span class="token keyword">fun</span> <span class="token function">insertUserWithPosts</span><span class="token punctuation">(</span>user<span class="token operator">:</span> UserEntity<span class="token punctuation">,</span> posts<span class="token operator">:</span> List<span class="token operator">&lt;</span>PostEntity<span class="token operator">></span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token function">insertUser</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span>
        <span class="token function">insertPosts</span><span class="token punctuation">(</span>posts<span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// 数据库迁移</span>
<span class="token annotation builtin">@Database</span><span class="token punctuation">(</span>
    entities <span class="token operator">=</span> <span class="token punctuation">[</span>UserEntity<span class="token operator">::</span><span class="token keyword">class</span><span class="token punctuation">,</span> PostEntity<span class="token operator">::</span><span class="token keyword">class</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    version <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span>
    exportSchema <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    autoMigrations <span class="token operator">=</span> <span class="token punctuation">[</span>
        <span class="token function">AutoMigration</span><span class="token punctuation">(</span>from <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token keyword">to</span> <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">)</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">)</span>
<span class="token keyword">abstract</span> <span class="token keyword">class</span> AppDatabase <span class="token operator">:</span> <span class="token function">RoomDatabase</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">abstract</span> <span class="token keyword">fun</span> <span class="token function">userDao</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> UserDao
    <span class="token keyword">abstract</span> <span class="token keyword">fun</span> <span class="token function">postDao</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> PostDao
    
    <span class="token keyword">companion</span> <span class="token keyword">object</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">val</span> MIGRATION_1_2 <span class="token operator">=</span> <span class="token keyword">object</span> <span class="token operator">:</span> <span class="token function">Migration</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">override</span> <span class="token keyword">fun</span> <span class="token function">migrate</span><span class="token punctuation">(</span>database<span class="token operator">:</span> SupportSQLiteDatabase<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                database<span class="token punctuation">.</span><span class="token function">execSQL</span><span class="token punctuation">(</span><span class="token string-literal multiline"><span class="token string">"""
                    ALTER TABLE users ADD COLUMN lastLoginAt INTEGER DEFAULT 0
                """</span></span><span class="token punctuation">)</span>
            <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h2 id="五、性能优化"><a href="#五、性能优化" class="headerlink" title="五、性能优化"></a>五、性能优化</h2><h3 id="（一）内存优化"><a href="#（一）内存优化" class="headerlink" title="（一）内存优化"></a>（一）内存优化</h3><h4 id="1-1-内存泄漏检测"><a href="#1-1-内存泄漏检测" class="headerlink" title="1.1 内存泄漏检测"></a>1.1 内存泄漏检测</h4><figure><div class="code-wrapper"><pre class="line-numbers language-kotlin" data-language="kotlin"><code class="language-kotlin"><span class="token comment">// LeakCanary集成</span>
<span class="token keyword">class</span> MyApplication <span class="token operator">:</span> <span class="token function">Application</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">override</span> <span class="token keyword">fun</span> <span class="token function">onCreate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">onCreate</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>LeakCanary<span class="token punctuation">.</span><span class="token function">isInAnalyzerProcess</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">return</span>
        <span class="token punctuation">&#125;</span>
        LeakCanary<span class="token punctuation">.</span><span class="token function">install</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// 内存优化工具</span>
<span class="token keyword">object</span> MemoryProfiler <span class="token punctuation">&#123;</span>
    <span class="token keyword">fun</span> <span class="token function">logMemoryUsage</span><span class="token punctuation">(</span>tag<span class="token operator">:</span> String<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">val</span> runtime <span class="token operator">=</span> Runtime<span class="token punctuation">.</span><span class="token function">getRuntime</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">val</span> usedMemory <span class="token operator">=</span> runtime<span class="token punctuation">.</span><span class="token function">totalMemory</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> runtime<span class="token punctuation">.</span><span class="token function">freeMemory</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">val</span> maxMemory <span class="token operator">=</span> runtime<span class="token punctuation">.</span><span class="token function">maxMemory</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">val</span> availableMemory <span class="token operator">=</span> maxMemory <span class="token operator">-</span> usedMemory
        
        Log<span class="token punctuation">.</span><span class="token function">d</span><span class="token punctuation">(</span>tag<span class="token punctuation">,</span> <span class="token string-literal singleline"><span class="token string">"Used: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span><span class="token expression">usedMemory <span class="token operator">/</span> <span class="token number">1024</span> <span class="token operator">/</span> <span class="token number">1024</span></span><span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">MB"</span></span><span class="token punctuation">)</span>
        Log<span class="token punctuation">.</span><span class="token function">d</span><span class="token punctuation">(</span>tag<span class="token punctuation">,</span> <span class="token string-literal singleline"><span class="token string">"Available: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span><span class="token expression">availableMemory <span class="token operator">/</span> <span class="token number">1024</span> <span class="token operator">/</span> <span class="token number">1024</span></span><span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">MB"</span></span><span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h4 id="1-2-图片加载优化"><a href="#1-2-图片加载优化" class="headerlink" title="1.2 图片加载优化"></a>1.2 图片加载优化</h4><figure><div class="code-wrapper"><pre class="line-numbers language-kotlin" data-language="kotlin"><code class="language-kotlin"><span class="token comment">// Coil图片加载</span>
<span class="token keyword">class</span> ImageLoaderModule <span class="token punctuation">&#123;</span>
    <span class="token keyword">companion</span> <span class="token keyword">object</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">fun</span> <span class="token function">provideImageLoader</span><span class="token punctuation">(</span>context<span class="token operator">:</span> Context<span class="token punctuation">)</span><span class="token operator">:</span> ImageLoader <span class="token punctuation">&#123;</span>
            <span class="token keyword">return</span> ImageLoader<span class="token punctuation">.</span><span class="token function">Builder</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">memoryCache</span> <span class="token punctuation">&#123;</span>
                    MemoryCache<span class="token punctuation">.</span><span class="token function">Builder</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span>
                        <span class="token punctuation">.</span><span class="token function">maxSizePercent</span><span class="token punctuation">(</span><span class="token number">0.25</span><span class="token punctuation">)</span>
                        <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">&#125;</span>
                <span class="token punctuation">.</span><span class="token function">diskCache</span> <span class="token punctuation">&#123;</span>
                    DiskCache<span class="token punctuation">.</span><span class="token function">Builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                        <span class="token punctuation">.</span><span class="token function">directory</span><span class="token punctuation">(</span>context<span class="token punctuation">.</span>cacheDir<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"image_cache"</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                        <span class="token punctuation">.</span><span class="token function">maxSizeBytes</span><span class="token punctuation">(</span><span class="token number">50</span> <span class="token operator">*</span> <span class="token number">1024</span> <span class="token operator">*</span> <span class="token number">1024</span><span class="token punctuation">)</span> <span class="token comment">// 50MB</span>
                        <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">&#125;</span>
                <span class="token punctuation">.</span><span class="token function">crossfade</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// 图片压缩</span>
<span class="token keyword">object</span> ImageCompressor <span class="token punctuation">&#123;</span>
    <span class="token keyword">fun</span> <span class="token function">compressImage</span><span class="token punctuation">(</span>
        context<span class="token operator">:</span> Context<span class="token punctuation">,</span>
        uri<span class="token operator">:</span> Uri<span class="token punctuation">,</span>
        maxWidth<span class="token operator">:</span> Int <span class="token operator">=</span> <span class="token number">1080</span><span class="token punctuation">,</span>
        maxHeight<span class="token operator">:</span> Int <span class="token operator">=</span> <span class="token number">1920</span><span class="token punctuation">,</span>
        quality<span class="token operator">:</span> Int <span class="token operator">=</span> <span class="token number">80</span>
    <span class="token punctuation">)</span><span class="token operator">:</span> File <span class="token punctuation">&#123;</span>
        <span class="token keyword">val</span> bitmap <span class="token operator">=</span> BitmapFactory<span class="token punctuation">.</span><span class="token function">decodeStream</span><span class="token punctuation">(</span>
            context<span class="token punctuation">.</span>contentResolver<span class="token punctuation">.</span><span class="token function">openInputStream</span><span class="token punctuation">(</span>uri<span class="token punctuation">)</span>
        <span class="token punctuation">)</span>
        
        <span class="token keyword">val</span> scaledBitmap <span class="token operator">=</span> Bitmap<span class="token punctuation">.</span><span class="token function">createScaledBitmap</span><span class="token punctuation">(</span>
            bitmap<span class="token punctuation">,</span>
            maxWidth<span class="token punctuation">,</span>
            maxHeight<span class="token punctuation">,</span>
            <span class="token boolean">true</span>
        <span class="token punctuation">)</span>
        
        <span class="token keyword">val</span> outputFile <span class="token operator">=</span> <span class="token function">File</span><span class="token punctuation">(</span>context<span class="token punctuation">.</span>cacheDir<span class="token punctuation">,</span> <span class="token string-literal singleline"><span class="token string">"compressed_</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span><span class="token expression">System<span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span><span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">.jpg"</span></span><span class="token punctuation">)</span>
        <span class="token function">FileOutputStream</span><span class="token punctuation">(</span>outputFile<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">use</span> <span class="token punctuation">&#123;</span> <span class="token keyword">out</span> <span class="token operator">-></span>
            scaledBitmap<span class="token punctuation">.</span><span class="token function">compress</span><span class="token punctuation">(</span>Bitmap<span class="token punctuation">.</span>CompressFormat<span class="token punctuation">.</span>JPEG<span class="token punctuation">,</span> quality<span class="token punctuation">,</span> <span class="token keyword">out</span><span class="token punctuation">)</span>
        <span class="token punctuation">&#125;</span>
        
        <span class="token keyword">return</span> outputFile
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h3 id="（二）网络优化"><a href="#（二）网络优化" class="headerlink" title="（二）网络优化"></a>（二）网络优化</h3><h4 id="2-1-网络缓存策略"><a href="#2-1-网络缓存策略" class="headerlink" title="2.1 网络缓存策略"></a>2.1 网络缓存策略</h4><figure><div class="code-wrapper"><pre class="line-numbers language-kotlin" data-language="kotlin"><code class="language-kotlin"><span class="token comment">// OkHttp缓存配置</span>
<span class="token keyword">object</span> CacheConfig <span class="token punctuation">&#123;</span>
    <span class="token keyword">private</span> <span class="token keyword">const</span> <span class="token keyword">val</span> CACHE_SIZE <span class="token operator">=</span> <span class="token number">10</span> <span class="token operator">*</span> <span class="token number">1024</span> <span class="token operator">*</span> <span class="token number">1024L</span> <span class="token comment">// 10MB</span>
    
    <span class="token keyword">fun</span> <span class="token function">provideCache</span><span class="token punctuation">(</span>context<span class="token operator">:</span> Context<span class="token punctuation">)</span><span class="token operator">:</span> Cache <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> <span class="token function">Cache</span><span class="token punctuation">(</span>context<span class="token punctuation">.</span>cacheDir<span class="token punctuation">,</span> CACHE_SIZE<span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span>
    
    <span class="token keyword">fun</span> <span class="token function">provideCacheInterceptor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> Interceptor <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> Interceptor <span class="token punctuation">&#123;</span> chain <span class="token operator">-></span>
            <span class="token keyword">val</span> response <span class="token operator">=</span> chain<span class="token punctuation">.</span><span class="token function">proceed</span><span class="token punctuation">(</span>chain<span class="token punctuation">.</span><span class="token function">request</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            
            <span class="token keyword">val</span> cacheControl <span class="token operator">=</span> CacheControl<span class="token punctuation">.</span><span class="token function">Builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">maxAge</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> TimeUnit<span class="token punctuation">.</span>HOURS<span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            
            response<span class="token punctuation">.</span><span class="token function">newBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">header</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"Cache-Control"</span></span><span class="token punctuation">,</span> cacheControl<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h2 id="六、测试与调试"><a href="#六、测试与调试" class="headerlink" title="六、测试与调试"></a>六、测试与调试</h2><h3 id="（一）单元测试"><a href="#（一）单元测试" class="headerlink" title="（一）单元测试"></a>（一）单元测试</h3><h4 id="1-1-ViewModel测试"><a href="#1-1-ViewModel测试" class="headerlink" title="1.1 ViewModel测试"></a>1.1 ViewModel测试</h4><figure><div class="code-wrapper"><pre class="line-numbers language-kotlin" data-language="kotlin"><code class="language-kotlin"><span class="token annotation builtin">@RunWith</span><span class="token punctuation">(</span>MockitoJUnitRunner<span class="token operator">::</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token keyword">class</span> UserViewModelTest <span class="token punctuation">&#123;</span>
    
    <span class="token annotation builtin">@Mock</span>
    <span class="token keyword">private</span> <span class="token keyword">lateinit</span> <span class="token keyword">var</span> userRepository<span class="token operator">:</span> UserRepository
    
    <span class="token keyword">private</span> <span class="token keyword">lateinit</span> <span class="token keyword">var</span> viewModel<span class="token operator">:</span> UserViewModel
    
    <span class="token annotation builtin">@Before</span>
    <span class="token keyword">fun</span> <span class="token function">setup</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        viewModel <span class="token operator">=</span> <span class="token function">UserViewModel</span><span class="token punctuation">(</span>userRepository<span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span>
    
    <span class="token annotation builtin">@Test</span>
    <span class="token keyword">fun</span> <span class="token function">`getUser should update UI state with user data`</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> runTest <span class="token punctuation">&#123;</span>
        <span class="token comment">// Given</span>
        <span class="token keyword">val</span> userId <span class="token operator">=</span> <span class="token string-literal singleline"><span class="token string">"123"</span></span>
        <span class="token keyword">val</span> user <span class="token operator">=</span> <span class="token function">User</span><span class="token punctuation">(</span>userId<span class="token punctuation">,</span> <span class="token string-literal singleline"><span class="token string">"Test User"</span></span><span class="token punctuation">,</span> <span class="token string-literal singleline"><span class="token string">"test@example.com"</span></span><span class="token punctuation">)</span>
        <span class="token function">whenever</span><span class="token punctuation">(</span>userRepository<span class="token punctuation">.</span><span class="token function">getUser</span><span class="token punctuation">(</span>userId<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">thenReturn</span><span class="token punctuation">(</span>Result<span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">)</span>
        
        <span class="token comment">// When</span>
        viewModel<span class="token punctuation">.</span><span class="token function">loadUser</span><span class="token punctuation">(</span>userId<span class="token punctuation">)</span>
        
        <span class="token comment">// Then</span>
        viewModel<span class="token punctuation">.</span>uiState<span class="token punctuation">.</span><span class="token function">test</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">val</span> state <span class="token operator">=</span> <span class="token function">awaitItem</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token function">assertEquals</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">,</span> state<span class="token punctuation">.</span>isLoading<span class="token punctuation">)</span>
            <span class="token function">assertEquals</span><span class="token punctuation">(</span>user<span class="token punctuation">,</span> state<span class="token punctuation">.</span>user<span class="token punctuation">)</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h3 id="（二）UI测试"><a href="#（二）UI测试" class="headerlink" title="（二）UI测试"></a>（二）UI测试</h3><h4 id="2-1-Compose-UI测试"><a href="#2-1-Compose-UI测试" class="headerlink" title="2.1 Compose UI测试"></a>2.1 Compose UI测试</h4><figure><div class="code-wrapper"><pre class="line-numbers language-kotlin" data-language="kotlin"><code class="language-kotlin"><span class="token keyword">class</span> UserScreenTest <span class="token punctuation">&#123;</span>
    
    <span class="token annotation builtin">@get:Rule</span>
    <span class="token keyword">val</span> composeTestRule <span class="token operator">=</span> <span class="token function">createComposeRule</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    
    <span class="token annotation builtin">@Test</span>
    <span class="token keyword">fun</span> <span class="token function">userList_displaysCorrectly</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">val</span> users <span class="token operator">=</span> <span class="token function">listOf</span><span class="token punctuation">(</span>
            <span class="token function">User</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"1"</span></span><span class="token punctuation">,</span> <span class="token string-literal singleline"><span class="token string">"Alice"</span></span><span class="token punctuation">,</span> <span class="token string-literal singleline"><span class="token string">"alice@example.com"</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token function">User</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"2"</span></span><span class="token punctuation">,</span> <span class="token string-literal singleline"><span class="token string">"Bob"</span></span><span class="token punctuation">,</span> <span class="token string-literal singleline"><span class="token string">"bob@example.com"</span></span><span class="token punctuation">)</span>
        <span class="token punctuation">)</span>
        
        composeTestRule<span class="token punctuation">.</span><span class="token function">setContent</span> <span class="token punctuation">&#123;</span>
            <span class="token function">UserList</span><span class="token punctuation">(</span>users <span class="token operator">=</span> users<span class="token punctuation">)</span>
        <span class="token punctuation">&#125;</span>
        
        composeTestRule<span class="token punctuation">.</span><span class="token function">onNodeWithText</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"Alice"</span></span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">assertIsDisplayed</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        composeTestRule<span class="token punctuation">.</span><span class="token function">onNodeWithText</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"Bob"</span></span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">assertIsDisplayed</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span>
    
    <span class="token annotation builtin">@Test</span>
    <span class="token keyword">fun</span> <span class="token function">userCard_clickAction</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">var</span> clickedUser<span class="token operator">:</span> User<span class="token operator">?</span> <span class="token operator">=</span> <span class="token keyword">null</span>
        <span class="token keyword">val</span> user <span class="token operator">=</span> <span class="token function">User</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"1"</span></span><span class="token punctuation">,</span> <span class="token string-literal singleline"><span class="token string">"Alice"</span></span><span class="token punctuation">,</span> <span class="token string-literal singleline"><span class="token string">"alice@example.com"</span></span><span class="token punctuation">)</span>
        
        composeTestRule<span class="token punctuation">.</span><span class="token function">setContent</span> <span class="token punctuation">&#123;</span>
            <span class="token function">UserCard</span><span class="token punctuation">(</span>
                user <span class="token operator">=</span> user<span class="token punctuation">,</span>
                onUserClick <span class="token operator">=</span> <span class="token punctuation">&#123;</span> clickedUser <span class="token operator">=</span> it <span class="token punctuation">&#125;</span>
            <span class="token punctuation">)</span>
        <span class="token punctuation">&#125;</span>
        
        composeTestRule<span class="token punctuation">.</span><span class="token function">onNodeWithText</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"Alice"</span></span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">performClick</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token function">assertEquals</span><span class="token punctuation">(</span>user<span class="token punctuation">,</span> clickedUser<span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h2 id="七、高级架构与组件化"><a href="#七、高级架构与组件化" class="headerlink" title="七、高级架构与组件化"></a>七、高级架构与组件化</h2><h3 id="（一）模块化架构"><a href="#（一）模块化架构" class="headerlink" title="（一）模块化架构"></a>（一）模块化架构</h3><h4 id="1-1-模块划分"><a href="#1-1-模块划分" class="headerlink" title="1.1 模块划分"></a>1.1 模块划分</h4><figure><div class="code-wrapper"><pre class="line-numbers language-none"><code class="language-none">app&#x2F;
├── app&#x2F;
│   ├── src&#x2F;main&#x2F;java&#x2F;com&#x2F;example&#x2F;app&#x2F;
│   │   ├── MainActivity.kt
│   │   └── MyApplication.kt
├── core&#x2F;
│   ├── data&#x2F;
│   ├── domain&#x2F;
│   └── ui&#x2F;
├── features&#x2F;
│   ├── home&#x2F;
│   ├── profile&#x2F;
│   └── settings&#x2F;
└── libraries&#x2F;
    ├── network&#x2F;
    ├── database&#x2F;
    └── common&#x2F;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h4 id="1-2-动态功能模块"><a href="#1-2-动态功能模块" class="headerlink" title="1.2 动态功能模块"></a>1.2 动态功能模块</h4><figure><div class="code-wrapper"><pre class="line-numbers language-gradle" data-language="gradle"><code class="language-gradle"><span class="token comment">// build.gradle (Dynamic Feature)</span>
<span class="token keyword">plugins</span> <span class="token punctuation">&#123;</span>
    id <span class="token string">'com.android.dynamic-feature'</span>
    id <span class="token string">'kotlin-android'</span>
<span class="token punctuation">&#125;</span>

android <span class="token punctuation">&#123;</span>
    compileSdk <span class="token number">34</span>
    
    defaultConfig <span class="token punctuation">&#123;</span>
        minSdk <span class="token number">21</span>
        testInstrumentationRunner <span class="token interpolation-string"><span class="token string">"androidx.test.runner.AndroidJUnitRunner"</span></span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">dependencies</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">implementation</span> <span class="token keyword">project</span><span class="token punctuation">(</span><span class="token string">':app'</span><span class="token punctuation">)</span>
    <span class="token keyword">implementation</span> <span class="token interpolation-string"><span class="token string">"androidx.compose.ui:ui:</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$</span><span class="token expression">compose_version</span></span><span class="token string">"</span></span>
    <span class="token keyword">implementation</span> <span class="token interpolation-string"><span class="token string">"androidx.compose.material3:material3:</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$</span><span class="token expression">compose_version</span></span><span class="token string">"</span></span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h3 id="（二）依赖注入"><a href="#（二）依赖注入" class="headerlink" title="（二）依赖注入"></a>（二）依赖注入</h3><h4 id="2-1-Hilt集成"><a href="#2-1-Hilt集成" class="headerlink" title="2.1 Hilt集成"></a>2.1 Hilt集成</h4><figure><div class="code-wrapper"><pre class="line-numbers language-kotlin" data-language="kotlin"><code class="language-kotlin"><span class="token comment">// Application类</span>
<span class="token annotation builtin">@HiltAndroidApp</span>
<span class="token keyword">class</span> MyApplication <span class="token operator">:</span> <span class="token function">Application</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// 模块配置</span>
<span class="token annotation builtin">@Module</span>
<span class="token annotation builtin">@InstallIn</span><span class="token punctuation">(</span>SingletonComponent<span class="token operator">::</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token keyword">object</span> AppModule <span class="token punctuation">&#123;</span>
    
    <span class="token annotation builtin">@Provides</span>
    <span class="token annotation builtin">@Singleton</span>
    <span class="token keyword">fun</span> <span class="token function">provideDatabase</span><span class="token punctuation">(</span><span class="token annotation builtin">@ApplicationContext</span> context<span class="token operator">:</span> Context<span class="token punctuation">)</span><span class="token operator">:</span> AppDatabase <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> Room<span class="token punctuation">.</span><span class="token function">databaseBuilder</span><span class="token punctuation">(</span>
            context<span class="token punctuation">,</span>
            AppDatabase<span class="token operator">::</span><span class="token keyword">class</span><span class="token punctuation">.</span>java<span class="token punctuation">,</span>
            <span class="token string-literal singleline"><span class="token string">"app_database"</span></span>
        <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span>
    
    <span class="token annotation builtin">@Provides</span>
    <span class="token annotation builtin">@Singleton</span>
    <span class="token keyword">fun</span> <span class="token function">provideUserRepository</span><span class="token punctuation">(</span>
        userDao<span class="token operator">:</span> UserDao<span class="token punctuation">,</span>
        userApiService<span class="token operator">:</span> UserApiService
    <span class="token punctuation">)</span><span class="token operator">:</span> UserRepository <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> <span class="token function">UserRepositoryImpl</span><span class="token punctuation">(</span>userDao<span class="token punctuation">,</span> userApiService<span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// ViewModel注入</span>
<span class="token annotation builtin">@HiltViewModel</span>
<span class="token keyword">class</span> UserViewModel <span class="token annotation builtin">@Inject</span> <span class="token keyword">constructor</span><span class="token punctuation">(</span>
    <span class="token keyword">private</span> <span class="token keyword">val</span> getUserUseCase<span class="token operator">:</span> GetUserUseCase<span class="token punctuation">,</span>
    <span class="token keyword">private</span> <span class="token keyword">val</span> savedStateHandle<span class="token operator">:</span> SavedStateHandle
<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">ViewModel</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token comment">// ViewModel实现</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h2 id="八、现代Android开发"><a href="#八、现代Android开发" class="headerlink" title="八、现代Android开发"></a>八、现代Android开发</h2><h3 id="（一）Jetpack-Compose高级特性"><a href="#（一）Jetpack-Compose高级特性" class="headerlink" title="（一）Jetpack Compose高级特性"></a>（一）Jetpack Compose高级特性</h3><h4 id="1-1-动画系统"><a href="#1-1-动画系统" class="headerlink" title="1.1 动画系统"></a>1.1 动画系统</h4><figure><div class="code-wrapper"><pre class="line-numbers language-kotlin" data-language="kotlin"><code class="language-kotlin"><span class="token comment">// 复杂动画</span>
<span class="token annotation builtin">@Composable</span>
<span class="token keyword">fun</span> <span class="token function">AnimatedCard</span><span class="token punctuation">(</span>
    isExpanded<span class="token operator">:</span> Boolean<span class="token punctuation">,</span>
    onToggle<span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-></span> Unit
<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">val</span> transition <span class="token operator">=</span> <span class="token function">updateTransition</span><span class="token punctuation">(</span>
        targetState <span class="token operator">=</span> isExpanded<span class="token punctuation">,</span>
        label <span class="token operator">=</span> <span class="token string-literal singleline"><span class="token string">"card_transition"</span></span>
    <span class="token punctuation">)</span>
    
    <span class="token keyword">val</span> cardElevation <span class="token keyword">by</span> transition<span class="token punctuation">.</span><span class="token function">animateDp</span><span class="token punctuation">(</span>
        label <span class="token operator">=</span> <span class="token string-literal singleline"><span class="token string">"elevation"</span></span>
    <span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> expanded <span class="token operator">-></span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>expanded<span class="token punctuation">)</span> <span class="token number">8</span><span class="token punctuation">.</span>dp <span class="token keyword">else</span> <span class="token number">2</span><span class="token punctuation">.</span>dp
    <span class="token punctuation">&#125;</span>
    
    <span class="token keyword">val</span> cardCornerRadius <span class="token keyword">by</span> transition<span class="token punctuation">.</span><span class="token function">animateDp</span><span class="token punctuation">(</span>
        label <span class="token operator">=</span> <span class="token string-literal singleline"><span class="token string">"corner_radius"</span></span>
    <span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> expanded <span class="token operator">-></span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>expanded<span class="token punctuation">)</span> <span class="token number">16</span><span class="token punctuation">.</span>dp <span class="token keyword">else</span> <span class="token number">8</span><span class="token punctuation">.</span>dp
    <span class="token punctuation">&#125;</span>
    
    <span class="token function">Card</span><span class="token punctuation">(</span>
        elevation <span class="token operator">=</span> CardDefaults<span class="token punctuation">.</span><span class="token function">cardElevation</span><span class="token punctuation">(</span>defaultElevation <span class="token operator">=</span> cardElevation<span class="token punctuation">)</span><span class="token punctuation">,</span>
        shape <span class="token operator">=</span> <span class="token function">RoundedCornerShape</span><span class="token punctuation">(</span>cardCornerRadius<span class="token punctuation">)</span><span class="token punctuation">,</span>
        modifier <span class="token operator">=</span> Modifier
            <span class="token punctuation">.</span><span class="token function">fillMaxWidth</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">clickable</span> <span class="token punctuation">&#123;</span> <span class="token function">onToggle</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#125;</span>
    <span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token comment">// Card content</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// 共享元素动画</span>
<span class="token annotation builtin">@Composable</span>
<span class="token keyword">fun</span> <span class="token function">SharedElementTransition</span><span class="token punctuation">(</span>
    isVisible<span class="token operator">:</span> Boolean<span class="token punctuation">,</span>
    sharedTransitionScope<span class="token operator">:</span> SharedTransitionScope<span class="token punctuation">,</span>
    animatedVisibilityScope<span class="token operator">:</span> AnimatedVisibilityScope
<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token function">with</span><span class="token punctuation">(</span>sharedTransitionScope<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token function">Card</span><span class="token punctuation">(</span>
            modifier <span class="token operator">=</span> Modifier
                <span class="token punctuation">.</span><span class="token function">sharedBounds</span><span class="token punctuation">(</span>
                    <span class="token function">rememberSharedContentState</span><span class="token punctuation">(</span>key <span class="token operator">=</span> <span class="token string-literal singleline"><span class="token string">"card"</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                    animatedVisibilityScope
                <span class="token punctuation">)</span>
        <span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token comment">// Content</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h3 id="（二）现代架构组件"><a href="#（二）现代架构组件" class="headerlink" title="（二）现代架构组件"></a>（二）现代架构组件</h3><h4 id="2-1-Navigation-Compose"><a href="#2-1-Navigation-Compose" class="headerlink" title="2.1 Navigation Compose"></a>2.1 Navigation Compose</h4><figure><div class="code-wrapper"><pre class="line-numbers language-kotlin" data-language="kotlin"><code class="language-kotlin"><span class="token comment">// 导航配置</span>
<span class="token annotation builtin">@Composable</span>
<span class="token keyword">fun</span> <span class="token function">AppNavigation</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">val</span> navController <span class="token operator">=</span> <span class="token function">rememberNavController</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    
    <span class="token function">NavHost</span><span class="token punctuation">(</span>
        navController <span class="token operator">=</span> navController<span class="token punctuation">,</span>
        startDestination <span class="token operator">=</span> <span class="token string-literal singleline"><span class="token string">"home"</span></span>
    <span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token function">composable</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"home"</span></span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token function">HomeScreen</span><span class="token punctuation">(</span>
                onUserClick <span class="token operator">=</span> <span class="token punctuation">&#123;</span> userId <span class="token operator">-></span>
                    navController<span class="token punctuation">.</span><span class="token function">navigate</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"user/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$</span><span class="token expression">userId</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
                <span class="token punctuation">&#125;</span>
            <span class="token punctuation">)</span>
        <span class="token punctuation">&#125;</span>
        
        <span class="token function">composable</span><span class="token punctuation">(</span>
            <span class="token string-literal singleline"><span class="token string">"user/&#123;userId&#125;"</span></span><span class="token punctuation">,</span>
            arguments <span class="token operator">=</span> <span class="token function">listOf</span><span class="token punctuation">(</span><span class="token function">navArgument</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"userId"</span></span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> type <span class="token operator">=</span> NavType<span class="token punctuation">.</span>StringType <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
        <span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> backStackEntry <span class="token operator">-></span>
            <span class="token keyword">val</span> userId <span class="token operator">=</span> backStackEntry<span class="token punctuation">.</span>arguments<span class="token operator">?</span><span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"userId"</span></span><span class="token punctuation">)</span>
            <span class="token function">UserDetailScreen</span><span class="token punctuation">(</span>
                userId <span class="token operator">=</span> userId<span class="token punctuation">,</span>
                onBackClick <span class="token operator">=</span> <span class="token punctuation">&#123;</span> navController<span class="token punctuation">.</span><span class="token function">popBackStack</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#125;</span>
            <span class="token punctuation">)</span>
        <span class="token punctuation">&#125;</span>
        
        <span class="token comment">// 深度链接</span>
        <span class="token function">composable</span><span class="token punctuation">(</span>
            <span class="token string-literal singleline"><span class="token string">"user/&#123;userId&#125;"</span></span><span class="token punctuation">,</span>
            deepLinks <span class="token operator">=</span> <span class="token function">listOf</span><span class="token punctuation">(</span>
                navDeepLink <span class="token punctuation">&#123;</span> uriPattern <span class="token operator">=</span> <span class="token string-literal singleline"><span class="token string">"https://example.com/user/&#123;userId&#125;"</span></span> <span class="token punctuation">&#125;</span>
            <span class="token punctuation">)</span>
        <span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> backStackEntry <span class="token operator">-></span>
            <span class="token comment">// Handle deep link</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h2 id="九、性能监控与优化"><a href="#九、性能监控与优化" class="headerlink" title="九、性能监控与优化"></a>九、性能监控与优化</h2><h3 id="（一）性能分析工具"><a href="#（一）性能分析工具" class="headerlink" title="（一）性能分析工具"></a>（一）性能分析工具</h3><h4 id="1-1-Android-Profiler使用"><a href="#1-1-Android-Profiler使用" class="headerlink" title="1.1 Android Profiler使用"></a>1.1 Android Profiler使用</h4><figure><div class="code-wrapper"><pre class="line-numbers language-kotlin" data-language="kotlin"><code class="language-kotlin"><span class="token comment">// 性能监控</span>
<span class="token keyword">class</span> PerformanceMonitor <span class="token punctuation">&#123;</span>
    <span class="token keyword">companion</span> <span class="token keyword">object</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">fun</span> <span class="token function">startMethodTracing</span><span class="token punctuation">(</span>traceName<span class="token operator">:</span> String<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            Debug<span class="token punctuation">.</span><span class="token function">startMethodTracing</span><span class="token punctuation">(</span>traceName<span class="token punctuation">)</span>
        <span class="token punctuation">&#125;</span>
        
        <span class="token keyword">fun</span> <span class="token function">stopMethodTracing</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            Debug<span class="token punctuation">.</span><span class="token function">stopMethodTracing</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">&#125;</span>
        
        <span class="token keyword">fun</span> <span class="token function">measureTime</span><span class="token punctuation">(</span>block<span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-></span> Unit<span class="token punctuation">)</span><span class="token operator">:</span> Long <span class="token punctuation">&#123;</span>
            <span class="token keyword">val</span> startTime <span class="token operator">=</span> System<span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token function">block</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span> System<span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> startTime
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h3 id="（二）崩溃分析"><a href="#（二）崩溃分析" class="headerlink" title="（二）崩溃分析"></a>（二）崩溃分析</h3><h4 id="2-1-Firebase-Crashlytics"><a href="#2-1-Firebase-Crashlytics" class="headerlink" title="2.1 Firebase Crashlytics"></a>2.1 Firebase Crashlytics</h4><figure><div class="code-wrapper"><pre class="line-numbers language-kotlin" data-language="kotlin"><code class="language-kotlin"><span class="token comment">// 崩溃报告</span>
<span class="token keyword">class</span> CrashReportingTree <span class="token operator">:</span> Timber<span class="token punctuation">.</span><span class="token function">Tree</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">override</span> <span class="token keyword">fun</span> <span class="token function">log</span><span class="token punctuation">(</span>priority<span class="token operator">:</span> Int<span class="token punctuation">,</span> tag<span class="token operator">:</span> String<span class="token operator">?</span><span class="token punctuation">,</span> message<span class="token operator">:</span> String<span class="token punctuation">,</span> t<span class="token operator">:</span> Throwable<span class="token operator">?</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>priority <span class="token operator">==</span> Log<span class="token punctuation">.</span>ERROR <span class="token operator">||</span> priority <span class="token operator">==</span> Log<span class="token punctuation">.</span>WARN<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            FirebaseCrashlytics<span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span>
            t<span class="token operator">?</span><span class="token punctuation">.</span><span class="token function">let</span> <span class="token punctuation">&#123;</span> FirebaseCrashlytics<span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">recordException</span><span class="token punctuation">(</span>it<span class="token punctuation">)</span> <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// 自定义异常处理</span>
<span class="token keyword">class</span> CustomExceptionHandler <span class="token operator">:</span> Thread<span class="token punctuation">.</span><span class="token function">UncaughtExceptionHandler</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">private</span> <span class="token keyword">val</span> defaultHandler <span class="token operator">=</span> Thread<span class="token punctuation">.</span><span class="token function">getDefaultUncaughtExceptionHandler</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    
    <span class="token keyword">override</span> <span class="token keyword">fun</span> <span class="token function">uncaughtException</span><span class="token punctuation">(</span>thread<span class="token operator">:</span> Thread<span class="token punctuation">,</span> throwable<span class="token operator">:</span> Throwable<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token comment">// 记录崩溃信息</span>
        <span class="token function">saveCrashInfo</span><span class="token punctuation">(</span>throwable<span class="token punctuation">)</span>
        
        <span class="token comment">// 上传到服务器</span>
        <span class="token function">uploadCrashReport</span><span class="token punctuation">(</span>throwable<span class="token punctuation">)</span>
        
        <span class="token comment">// 调用默认处理</span>
        defaultHandler<span class="token operator">?</span><span class="token punctuation">.</span><span class="token function">uncaughtException</span><span class="token punctuation">(</span>thread<span class="token punctuation">,</span> throwable<span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h2 id="十、发布与持续集成"><a href="#十、发布与持续集成" class="headerlink" title="十、发布与持续集成"></a>十、发布与持续集成</h2><h3 id="（一）CI-CD配置"><a href="#（一）CI-CD配置" class="headerlink" title="（一）CI&#x2F;CD配置"></a>（一）CI&#x2F;CD配置</h3><h4 id="1-1-GitHub-Actions"><a href="#1-1-GitHub-Actions" class="headerlink" title="1.1 GitHub Actions"></a>1.1 GitHub Actions</h4><figure><div class="code-wrapper"><pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token comment"># .github/workflows/android.yml</span>
<span class="token key atrule">name</span><span class="token punctuation">:</span> Android CI

<span class="token key atrule">on</span><span class="token punctuation">:</span>
  <span class="token key atrule">push</span><span class="token punctuation">:</span>
    <span class="token key atrule">branches</span><span class="token punctuation">:</span> <span class="token punctuation">[</span> main<span class="token punctuation">,</span> develop <span class="token punctuation">]</span>
  <span class="token key atrule">pull_request</span><span class="token punctuation">:</span>
    <span class="token key atrule">branches</span><span class="token punctuation">:</span> <span class="token punctuation">[</span> main <span class="token punctuation">]</span>

<span class="token key atrule">jobs</span><span class="token punctuation">:</span>
  <span class="token key atrule">test</span><span class="token punctuation">:</span>
    <span class="token key atrule">runs-on</span><span class="token punctuation">:</span> ubuntu<span class="token punctuation">-</span>latest
    
    <span class="token key atrule">steps</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">uses</span><span class="token punctuation">:</span> actions/checkout@v3
    
    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Set up JDK 17
      <span class="token key atrule">uses</span><span class="token punctuation">:</span> actions/setup<span class="token punctuation">-</span>java@v3
      <span class="token key atrule">with</span><span class="token punctuation">:</span>
        <span class="token key atrule">java-version</span><span class="token punctuation">:</span> <span class="token string">'17'</span>
        <span class="token key atrule">distribution</span><span class="token punctuation">:</span> <span class="token string">'temurin'</span>
    
    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Cache Gradle packages
      <span class="token key atrule">uses</span><span class="token punctuation">:</span> actions/cache@v3
      <span class="token key atrule">with</span><span class="token punctuation">:</span>
        <span class="token key atrule">path</span><span class="token punctuation">:</span> <span class="token punctuation">|</span><span class="token scalar string">
          ~/.gradle/caches
          ~/.gradle/wrapper</span>
        <span class="token key atrule">key</span><span class="token punctuation">:</span> $<span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span> runner.os <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">-</span>gradle<span class="token punctuation">-</span>$<span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span> hashFiles('<span class="token important">**/*.gradle*'</span><span class="token punctuation">,</span> '<span class="token important">**/gradle-wrapper.properties')</span> <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>
    
    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Run tests
      <span class="token key atrule">run</span><span class="token punctuation">:</span> ./gradlew test
    
    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Build APK
      <span class="token key atrule">run</span><span class="token punctuation">:</span> ./gradlew assembleDebug
    
    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Upload APK
      <span class="token key atrule">uses</span><span class="token punctuation">:</span> actions/upload<span class="token punctuation">-</span>artifact@v3
      <span class="token key atrule">with</span><span class="token punctuation">:</span>
        <span class="token key atrule">name</span><span class="token punctuation">:</span> app<span class="token punctuation">-</span>debug
        <span class="token key atrule">path</span><span class="token punctuation">:</span> app/build/outputs/apk/debug/app<span class="token punctuation">-</span>debug.apk<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h3 id="（二）应用签名与发布"><a href="#（二）应用签名与发布" class="headerlink" title="（二）应用签名与发布"></a>（二）应用签名与发布</h3><h4 id="2-1-签名配置"><a href="#2-1-签名配置" class="headerlink" title="2.1 签名配置"></a>2.1 签名配置</h4><figure><div class="code-wrapper"><pre class="line-numbers language-gradle" data-language="gradle"><code class="language-gradle"><span class="token comment">// app/build.gradle</span>
android <span class="token punctuation">&#123;</span>
    signingConfigs <span class="token punctuation">&#123;</span>
        release <span class="token punctuation">&#123;</span>
            storeFile <span class="token function">file</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">"keystore/release.keystore"</span></span><span class="token punctuation">)</span>
            storePassword System<span class="token punctuation">.</span><span class="token function">getenv</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">"KEYSTORE_PASSWORD"</span></span><span class="token punctuation">)</span>
            keyAlias System<span class="token punctuation">.</span><span class="token function">getenv</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">"KEY_ALIAS"</span></span><span class="token punctuation">)</span>
            keyPassword System<span class="token punctuation">.</span><span class="token function">getenv</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">"KEY_PASSWORD"</span></span><span class="token punctuation">)</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
    
    buildTypes <span class="token punctuation">&#123;</span>
        release <span class="token punctuation">&#123;</span>
            signingConfig signingConfigs<span class="token punctuation">.</span>release
            minifyEnabled <span class="token boolean">true</span>
            proguardFiles <span class="token function">getDefaultProguardFile</span><span class="token punctuation">(</span><span class="token string">'proguard-android-optimize.txt'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'proguard-rules.pro'</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h2 id="十一、学习资源与路线图"><a href="#十一、学习资源与路线图" class="headerlink" title="十一、学习资源与路线图"></a>十一、学习资源与路线图</h2><h3 id="（一）官方资源"><a href="#（一）官方资源" class="headerlink" title="（一）官方资源"></a>（一）官方资源</h3><ul>
<li><strong>Android开发者官网</strong>: <a target="_blank" rel="noopener" href="https://developer.android.com/">https://developer.android.com/</a></li>
<li><strong>Kotlin官方文档</strong>: <a target="_blank" rel="noopener" href="https://kotlinlang.org/docs/">https://kotlinlang.org/docs/</a></li>
<li><strong>Jetpack Compose</strong>: <a target="_blank" rel="noopener" href="https://developer.android.com/jetpack/compose">https://developer.android.com/jetpack/compose</a></li>
</ul>
<h3 id="（二）推荐书籍"><a href="#（二）推荐书籍" class="headerlink" title="（二）推荐书籍"></a>（二）推荐书籍</h3><ul>
<li>《Android编程权威指南》</li>
<li>《Kotlin实战》</li>
<li>《Clean Architecture》</li>
<li>《Android高级编程》</li>
</ul>
<h3 id="（三）在线课程"><a href="#（三）在线课程" class="headerlink" title="（三）在线课程"></a>（三）在线课程</h3><ul>
<li><strong>Google Codelabs</strong>: <a target="_blank" rel="noopener" href="https://codelabs.developers.google.com/">https://codelabs.developers.google.com/</a></li>
<li><strong>Udacity Android课程</strong>: <a target="_blank" rel="noopener" href="https://www.udacity.com/course/android-kotlin-developer-nanodegree--nd940">https://www.udacity.com/course/android-kotlin-developer-nanodegree--nd940</a></li>
<li><strong>Coursera Android专项课程</strong>: <a target="_blank" rel="noopener" href="https://www.coursera.org/specializations/android-app-development">https://www.coursera.org/specializations/android-app-development</a></li>
</ul>
<h3 id="（四）实践项目建议"><a href="#（四）实践项目建议" class="headerlink" title="（四）实践项目建议"></a>（四）实践项目建议</h3><h4 id="阶段1：基础项目（1-2个月）"><a href="#阶段1：基础项目（1-2个月）" class="headerlink" title="阶段1：基础项目（1-2个月）"></a>阶段1：基础项目（1-2个月）</h4><ul>
<li>天气应用：使用OpenWeatherMap API</li>
<li>待办事项应用：Room数据库 + Compose</li>
<li>新闻阅读器：Retrofit + RecyclerView</li>
</ul>
<h4 id="阶段2：进阶项目（2-3个月）"><a href="#阶段2：进阶项目（2-3个月）" class="headerlink" title="阶段2：进阶项目（2-3个月）"></a>阶段2：进阶项目（2-3个月）</h4><ul>
<li>社交媒体客户端：完整用户系统</li>
<li>电商应用：购物车 + 支付集成</li>
<li>音乐播放器：媒体播放 + 通知</li>
</ul>
<h4 id="阶段3：高级项目（3-4个月）"><a href="#阶段3：高级项目（3-4个月）" class="headerlink" title="阶段3：高级项目（3-4个月）"></a>阶段3：高级项目（3-4个月）</h4><ul>
<li>即时通讯应用：WebSocket + 推送通知</li>
<li>地图导航应用：Google Maps + 定位</li>
<li>视频流媒体应用：ExoPlayer + 缓存</li>
</ul>
<h2 id="十二、2025年Android开发趋势"><a href="#十二、2025年Android开发趋势" class="headerlink" title="十二、2025年Android开发趋势"></a>十二、2025年Android开发趋势</h2><h3 id="（一）新技术方向"><a href="#（一）新技术方向" class="headerlink" title="（一）新技术方向"></a>（一）新技术方向</h3><ol>
<li><strong>AI集成</strong>: 机器学习模型在移动端的部署</li>
<li><strong>跨平台</strong>: Kotlin Multiplatform Mobile (KMM)</li>
<li><strong>可穿戴设备</strong>: Wear OS 4.0开发</li>
<li><strong>大屏适配</strong>: 折叠屏和平板优化</li>
<li><strong>性能优化</strong>: 启动速度和应用体积优化</li>
</ol>
<h3 id="（二）架构演进"><a href="#（二）架构演进" class="headerlink" title="（二）架构演进"></a>（二）架构演进</h3><ol>
<li><strong>响应式架构</strong>: 基于Flow的响应式编程</li>
<li><strong>微前端</strong>: 模块化架构的进一步发展</li>
<li><strong>Server-Driven UI</strong>: 服务端驱动UI更新</li>
<li><strong>边缘计算</strong>: 本地AI处理能力增强</li>
</ol>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>Android开发在2025年已经进入了全新的时代，从传统的Java + XML开发模式，演进到了Kotlin + Compose的现代化开发。本学习路线涵盖了从基础到高级的完整知识体系，包括最新的架构模式、性能优化、测试策略和发布流程。</p>
<p>掌握这些技能将使你能够开发出高质量、高性能的Android应用，并为成为高级Android架构师打下坚实基础。记住，持续学习和实践是成为优秀Android开发者的关键。</p>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/%E5%AD%A6%E4%B9%A0%E8%B7%AF%E7%BA%BF/" class="category-chain-item">学习路线</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/%E7%A7%BB%E5%8A%A8%E5%BC%80%E5%8F%91/" class="print-no-link">#移动开发</a>
      
        <a href="/tags/Android/" class="print-no-link">#Android</a>
      
        <a href="/tags/%E5%AD%A6%E4%B9%A0%E8%B7%AF%E7%BA%BF/" class="print-no-link">#学习路线</a>
      
        <a href="/tags/Kotlin/" class="print-no-link">#Kotlin</a>
      
        <a href="/tags/Jetpack-Compose/" class="print-no-link">#Jetpack Compose</a>
      
        <a href="/tags/%E6%9E%B6%E6%9E%84%E5%B8%88/" class="print-no-link">#架构师</a>
      
    </div>
  
</div>


              

              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2025/07/17/%E3%80%90AI%E3%80%91Claude%20Code%E8%AF%A6%E8%A7%A3%EF%BC%9AAI%E9%A9%B1%E5%8A%A8%E7%9A%84%E4%BB%A3%E7%A0%81%E7%BC%96%E8%BE%91%E5%99%A8%E9%9D%A9%E5%91%BD/" title="【AI】Claude Code详解：AI驱动的代码编辑器革命">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">【AI】Claude Code详解：AI驱动的代码编辑器革命</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2025/07/16/%E3%80%90MySQL%E3%80%91MySQL%E7%B4%A2%E5%BC%95%E8%AF%A6%E8%A7%A3%EF%BC%9A%E5%8E%9F%E7%90%86%E3%80%81%E7%B1%BB%E5%9E%8B%E4%B8%8E%E4%BC%98%E5%8C%96%E7%AD%96%E7%95%A5/" title="【MySQL】MySQL索引详解：原理、类型与优化策略">
                        <span class="hidden-mobile">【MySQL】MySQL索引详解：原理、类型与优化策略</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>目录</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
    <div class="statistics">
  
  

  
    
      <span id="busuanzi_container_site_pv" style="display: none">
        总访问量 
        <span id="busuanzi_value_site_pv"></span>
         次
      </span>
    
    
      <span id="busuanzi_container_site_uv" style="display: none">
        总访客数 
        <span id="busuanzi_value_site_uv"></span>
         人
      </span>
    
    

  

</div>

  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script  src="https://lib.baomitu.com/prism/1.29.0/plugins/line-numbers/prism-line-numbers.min.js" ></script>

  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/5.0.0/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>

  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>




  
<script src="/js/custom.js"></script>
<script src="/js/ai-assistant.js"></script>
<script src="https://cdn.jsdelivr.net/npm/mermaid@9.4.0/dist/mermaid.min.js"></script>



<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
</body>
</html>
